!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("vega-util"),require("vega-canvas"),require("vega-loader"),require("vega-scale")):"function"==typeof define&&define.amd?define(["exports","vega-util","vega-canvas","vega-loader","vega-scale"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).vega={},t.vega,t.vega,t.vega,t.vega)}(this,(function(t,e,n,i,s){"use strict";let r=0;const o="p_";function a(t){return t&&t.gradient}function h(t,e,n){const i=t.gradient;let s=t.id,a="radial"===i?o:"";return s||(s=t.id="gradient_"+r++,"radial"===i?(t.x1=l(t.x1,.5),t.y1=l(t.y1,.5),t.r1=l(t.r1,0),t.x2=l(t.x2,.5),t.y2=l(t.y2,.5),t.r2=l(t.r2,.5),a=o):(t.x1=l(t.x1,0),t.y1=l(t.y1,0),t.x2=l(t.x2,1),t.y2=l(t.y2,0))),e[s]=t,"url("+(n||"")+"#"+a+s+")"}function l(t,e){return null!=t?t:e}function c(t){return function(){return t}}const u=Math.abs,_=Math.atan2,f=Math.cos,d=Math.max,p=Math.min,y=Math.sin,x=Math.sqrt,g=1e-12,v=Math.PI,m=v/2,b=2*v;function k(t){return t>=1?m:t<=-1?-m:Math.asin(t)}const w=Math.PI,T=2*w,M=1e-6,z=T-M;function R(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}class A{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==t?R:function(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return R;const n=10**e;return function(t){this._+=t[0];for(let e=1,i=t.length;e<i;++e)this._+=Math.round(arguments[e]*n)/n+t[e]}}(t)}moveTo(t,e){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,e){this._append`L${this._x1=+t},${this._y1=+e}`}quadraticCurveTo(t,e,n,i){this._append`Q${+t},${+e},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(t,e,n,i,s,r){this._append`C${+t},${+e},${+n},${+i},${this._x1=+s},${this._y1=+r}`}arcTo(t,e,n,i,s){if(t=+t,e=+e,n=+n,i=+i,(s=+s)<0)throw new Error(`negative radius: ${s}`);let r=this._x1,o=this._y1,a=n-t,h=i-e,l=r-t,c=o-e,u=l*l+c*c;if(null===this._x1)this._append`M${this._x1=t},${this._y1=e}`;else if(u>M)if(Math.abs(c*a-h*l)>M&&s){let _=n-r,f=i-o,d=a*a+h*h,p=_*_+f*f,y=Math.sqrt(d),x=Math.sqrt(u),g=s*Math.tan((w-Math.acos((d+u-p)/(2*y*x)))/2),v=g/x,m=g/y;Math.abs(v-1)>M&&this._append`L${t+v*l},${e+v*c}`,this._append`A${s},${s},0,0,${+(c*_>l*f)},${this._x1=t+m*a},${this._y1=e+m*h}`}else this._append`L${this._x1=t},${this._y1=e}`;else;}arc(t,e,n,i,s,r){if(t=+t,e=+e,r=!!r,(n=+n)<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(i),a=n*Math.sin(i),h=t+o,l=e+a,c=1^r,u=r?i-s:s-i;null===this._x1?this._append`M${h},${l}`:(Math.abs(this._x1-h)>M||Math.abs(this._y1-l)>M)&&this._append`L${h},${l}`,n&&(u<0&&(u=u%T+T),u>z?this._append`A${n},${n},0,1,${c},${t-o},${e-a}A${n},${n},0,1,${c},${this._x1=h},${this._y1=l}`:u>M&&this._append`A${n},${n},0,${+(u>=w)},${c},${this._x1=t+n*Math.cos(s)},${this._y1=e+n*Math.sin(s)}`)}rect(t,e,n,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}}function S(){return new A}function N(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(null==n)e=null;else{const t=Math.floor(n);if(!(t>=0))throw new RangeError(`invalid digits: ${n}`);e=t}return t},()=>new A(e)}function C(t){return t.innerRadius}function E(t){return t.outerRadius}function $(t){return t.startAngle}function P(t){return t.endAngle}function L(t){return t&&t.padAngle}function O(t,e,n,i,s,r,o){var a=t-n,h=e-i,l=(o?r:-r)/x(a*a+h*h),c=l*h,u=-l*a,_=t+c,f=e+u,p=n+c,y=i+u,g=(_+p)/2,v=(f+y)/2,m=p-_,b=y-f,k=m*m+b*b,w=s-r,T=_*y-p*f,M=(b<0?-1:1)*x(d(0,w*w*k-T*T)),z=(T*b-m*M)/k,R=(-T*m-b*M)/k,A=(T*b+m*M)/k,S=(-T*m+b*M)/k,N=z-g,C=R-v,E=A-g,$=S-v;return N*N+C*C>E*E+$*$&&(z=A,R=S),{cx:z,cy:R,x01:-c,y01:-u,x11:z*(s/w-1),y11:R*(s/w-1)}}function q(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function I(t){this._context=t}function D(t){return new I(t)}function V(t){return t[0]}function H(t){return t[1]}function j(t,e){var n=c(!0),i=null,s=D,r=null,o=N(a);function a(a){var h,l,c,u=(a=q(a)).length,_=!1;for(null==i&&(r=s(c=o())),h=0;h<=u;++h)!(h<u&&n(l=a[h],h,a))===_&&((_=!_)?r.lineStart():r.lineEnd()),_&&r.point(+t(l,h,a),+e(l,h,a));if(c)return r=null,c+""||null}return t="function"==typeof t?t:void 0===t?V:c(t),e="function"==typeof e?e:void 0===e?H:c(e),a.x=function(e){return arguments.length?(t="function"==typeof e?e:c(+e),a):t},a.y=function(t){return arguments.length?(e="function"==typeof t?t:c(+t),a):e},a.defined=function(t){return arguments.length?(n="function"==typeof t?t:c(!!t),a):n},a.curve=function(t){return arguments.length?(s=t,null!=i&&(r=s(i)),a):s},a.context=function(t){return arguments.length?(null==t?i=r=null:r=s(i=t),a):i},a}function B(t,e,n){var i=null,s=c(!0),r=null,o=D,a=null,h=N(l);function l(l){var c,u,_,f,d,p=(l=q(l)).length,y=!1,x=new Array(p),g=new Array(p);for(null==r&&(a=o(d=h())),c=0;c<=p;++c){if(!(c<p&&s(f=l[c],c,l))===y)if(y=!y)u=c,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),_=c-1;_>=u;--_)a.point(x[_],g[_]);a.lineEnd(),a.areaEnd()}y&&(x[c]=+t(f,c,l),g[c]=+e(f,c,l),a.point(i?+i(f,c,l):x[c],n?+n(f,c,l):g[c]))}if(d)return a=null,d+""||null}function u(){return j().defined(s).curve(o).context(r)}return t="function"==typeof t?t:void 0===t?V:c(+t),e="function"==typeof e?e:c(void 0===e?0:+e),n="function"==typeof n?n:void 0===n?H:c(+n),l.x=function(e){return arguments.length?(t="function"==typeof e?e:c(+e),i=null,l):t},l.x0=function(e){return arguments.length?(t="function"==typeof e?e:c(+e),l):t},l.x1=function(t){return arguments.length?(i=null==t?null:"function"==typeof t?t:c(+t),l):i},l.y=function(t){return arguments.length?(e="function"==typeof t?t:c(+t),n=null,l):e},l.y0=function(t){return arguments.length?(e="function"==typeof t?t:c(+t),l):e},l.y1=function(t){return arguments.length?(n=null==t?null:"function"==typeof t?t:c(+t),l):n},l.lineX0=l.lineY0=function(){return u().x(t).y(e)},l.lineY1=function(){return u().x(t).y(n)},l.lineX1=function(){return u().x(i).y(e)},l.defined=function(t){return arguments.length?(s="function"==typeof t?t:c(!!t),l):s},l.curve=function(t){return arguments.length?(o=t,null!=r&&(a=o(r)),l):o},l.context=function(t){return arguments.length?(null==t?r=a=null:a=o(r=t),l):r},l}S.prototype=A.prototype,I.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var G={draw(t,e){const n=x(e/v);t.moveTo(n,0),t.arc(0,0,n,0,b)}};function W(){}function X(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function U(t){this._context=t}function F(t){this._context=t}function Y(t){this._context=t}function J(t,e){this._basis=new U(t),this._beta=e}U.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:X(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:X(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},F.prototype={areaStart:W,areaEnd:W,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:X(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},Y.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,i=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:X(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},J.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var i,s=t[0],r=e[0],o=t[n]-s,a=e[n]-r,h=-1;++h<=n;)i=h/n,this._basis.point(this._beta*t[h]+(1-this._beta)*(s+i*o),this._beta*e[h]+(1-this._beta)*(r+i*a));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var Z=function t(e){function n(t){return 1===e?new U(t):new J(t,e)}return n.beta=function(e){return t(+e)},n}(.85);function Q(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function K(t,e){this._context=t,this._k=(1-e)/6}K.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Q(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:Q(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var tt=function t(e){function n(t){return new K(t,e)}return n.tension=function(e){return t(+e)},n}(0);function et(t,e){this._context=t,this._k=(1-e)/6}et.prototype={areaStart:W,areaEnd:W,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:Q(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var nt=function t(e){function n(t){return new et(t,e)}return n.tension=function(e){return t(+e)},n}(0);function it(t,e){this._context=t,this._k=(1-e)/6}it.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Q(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var st=function t(e){function n(t){return new it(t,e)}return n.tension=function(e){return t(+e)},n}(0);function rt(t,e,n){var i=t._x1,s=t._y1,r=t._x2,o=t._y2;if(t._l01_a>g){var a=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,h=3*t._l01_a*(t._l01_a+t._l12_a);i=(i*a-t._x0*t._l12_2a+t._x2*t._l01_2a)/h,s=(s*a-t._y0*t._l12_2a+t._y2*t._l01_2a)/h}if(t._l23_a>g){var l=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,c=3*t._l23_a*(t._l23_a+t._l12_a);r=(r*l+t._x1*t._l23_2a-e*t._l12_2a)/c,o=(o*l+t._y1*t._l23_2a-n*t._l12_2a)/c}t._context.bezierCurveTo(i,s,r,o,t._x2,t._y2)}function ot(t,e){this._context=t,this._alpha=e}ot.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:rt(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var at=function t(e){function n(t){return e?new ot(t,e):new K(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function ht(t,e){this._context=t,this._alpha=e}ht.prototype={areaStart:W,areaEnd:W,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:rt(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var lt=function t(e){function n(t){return e?new ht(t,e):new et(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function ct(t,e){this._context=t,this._alpha=e}ct.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:rt(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var ut=function t(e){function n(t){return e?new ct(t,e):new it(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function _t(t){this._context=t}function ft(t){return t<0?-1:1}function dt(t,e,n){var i=t._x1-t._x0,s=e-t._x1,r=(t._y1-t._y0)/(i||s<0&&-0),o=(n-t._y1)/(s||i<0&&-0),a=(r*s+o*i)/(i+s);return(ft(r)+ft(o))*Math.min(Math.abs(r),Math.abs(o),.5*Math.abs(a))||0}function pt(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function yt(t,e,n){var i=t._x0,s=t._y0,r=t._x1,o=t._y1,a=(r-i)/3;t._context.bezierCurveTo(i+a,s+a*e,r-a,o-a*n,r,o)}function xt(t){this._context=t}function gt(t){this._context=new vt(t)}function vt(t){this._context=t}function mt(t){this._context=t}function bt(t){var e,n,i=t.length-1,s=new Array(i),r=new Array(i),o=new Array(i);for(s[0]=0,r[0]=2,o[0]=t[0]+2*t[1],e=1;e<i-1;++e)s[e]=1,r[e]=4,o[e]=4*t[e]+2*t[e+1];for(s[i-1]=2,r[i-1]=7,o[i-1]=8*t[i-1]+t[i],e=1;e<i;++e)n=s[e]/r[e-1],r[e]-=n,o[e]-=n*o[e-1];for(s[i-1]=o[i-1]/r[i-1],e=i-2;e>=0;--e)s[e]=(o[e]-s[e+1])/r[e];for(r[i-1]=(t[i]+s[i-1])/2,e=0;e<i-1;++e)r[e]=2*t[e+1]-s[e+1];return[s,r]}function kt(t,e){this._context=t,this._t=e}_t.prototype={areaStart:W,areaEnd:W,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}},xt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:yt(this,this._t0,pt(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,yt(this,pt(this,n=dt(this,t,e)),n);break;default:yt(this,this._t0,n=dt(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(gt.prototype=Object.create(xt.prototype)).point=function(t,e){xt.prototype.point.call(this,e,t)},vt.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,i,s,r){this._context.bezierCurveTo(e,t,i,n,r,s)}},mt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var i=bt(t),s=bt(e),r=0,o=1;o<n;++r,++o)this._context.bezierCurveTo(i[0][r],s[0][r],i[1][r],s[1][r],t[o],e[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}},kt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};const wt={basis:{curve:function(t){return new U(t)}},"basis-closed":{curve:function(t){return new F(t)}},"basis-open":{curve:function(t){return new Y(t)}},bundle:{curve:Z,tension:"beta",value:.85},cardinal:{curve:tt,tension:"tension",value:0},"cardinal-open":{curve:st,tension:"tension",value:0},"cardinal-closed":{curve:nt,tension:"tension",value:0},"catmull-rom":{curve:at,tension:"alpha",value:.5},"catmull-rom-closed":{curve:lt,tension:"alpha",value:.5},"catmull-rom-open":{curve:ut,tension:"alpha",value:.5},linear:{curve:D},"linear-closed":{curve:function(t){return new _t(t)}},monotone:{horizontal:function(t){return new gt(t)},vertical:function(t){return new xt(t)}},natural:{curve:function(t){return new mt(t)}},step:{curve:function(t){return new kt(t,.5)}},"step-after":{curve:function(t){return new kt(t,1)}},"step-before":{curve:function(t){return new kt(t,0)}}};function Tt(t,n,i){var s=e.hasOwnProperty(wt,t)&&wt[t],r=null;return s&&(r=s.curve||s[n||"vertical"],s.tension&&null!=i&&(r=r[s.tension](i))),r}const Mt={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},zt=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,Rt=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,At=/^((\s+,?\s*)|(,\s*))/,St=/^[01]/;function Nt(t){const e=[];return(t.match(zt)||[]).forEach((t=>{let n=t[0];const i=n.toLowerCase(),s=Mt[i],r=function(t,e,n){const i=[];for(let s=0;e&&s<n.length;)for(let r=0;r<e;++r){const e="a"!==t||3!==r&&4!==r?Rt:St,o=n.slice(s).match(e);if(null===o)throw Error("Invalid SVG path, incorrect parameter type");s+=o[0].length,i.push(+o[0]);const a=n.slice(s).match(At);null!==a&&(s+=a[0].length)}return i}(i,s,t.slice(1).trim()),o=r.length;if(o<s||o&&o%s!=0)throw Error("Invalid SVG path, incorrect parameter count");if(e.push([n,...r.slice(0,s)]),o!==s){"m"===i&&(n="M"===n?"L":"l");for(let t=s;t<o;t+=s)e.push([n,...r.slice(t,t+s)])}})),e}const Ct=Math.PI/180,Et=Math.PI/2,$t=2*Math.PI,Pt=Math.sqrt(3)/2;var Lt={},Ot={},qt=[].join;function It(t){const e=qt.call(t);if(Ot[e])return Ot[e];var n=t[0],i=t[1],s=t[2],r=t[3],o=t[4],a=t[5],h=t[6],l=t[7];const c=l*o,u=-h*a,_=h*o,f=l*a,d=Math.cos(s),p=Math.sin(s),y=Math.cos(r),x=Math.sin(r),g=.5*(r-s),v=Math.sin(.5*g),m=8/3*v*v/Math.sin(g),b=n+d-m*p,k=i+p+m*d,w=n+y,T=i+x,M=w+m*x,z=T-m*y;return Ot[e]=[c*b+u*k,_*b+f*k,c*M+u*z,_*M+f*z,c*w+u*T,_*w+f*T]}const Dt=["l",0,0,0,0,0,0,0];function Vt(t,e,n){const i=Dt[0]=t[0];if("a"===i||"A"===i)Dt[1]=e*t[1],Dt[2]=n*t[2],Dt[3]=t[3],Dt[4]=t[4],Dt[5]=t[5],Dt[6]=e*t[6],Dt[7]=n*t[7];else if("h"===i||"H"===i)Dt[1]=e*t[1];else if("v"===i||"V"===i)Dt[1]=n*t[1];else for(var s=1,r=t.length;s<r;++s)Dt[s]=(s%2==1?e:n)*t[s];return Dt}function Ht(t,e,n,i,s,r){var o,a,h,l,c,u=null,_=0,f=0,d=0,p=0,y=0,x=0;null==n&&(n=0),null==i&&(i=0),null==s&&(s=1),null==r&&(r=s),t.beginPath&&t.beginPath();for(var g=0,v=e.length;g<v;++g){switch(o=e[g],1===s&&1===r||(o=Vt(o,s,r)),o[0]){case"l":_+=o[1],f+=o[2],t.lineTo(_+n,f+i);break;case"L":_=o[1],f=o[2],t.lineTo(_+n,f+i);break;case"h":_+=o[1],t.lineTo(_+n,f+i);break;case"H":_=o[1],t.lineTo(_+n,f+i);break;case"v":f+=o[1],t.lineTo(_+n,f+i);break;case"V":f=o[1],t.lineTo(_+n,f+i);break;case"m":y=_+=o[1],x=f+=o[2],t.moveTo(_+n,f+i);break;case"M":y=_=o[1],x=f=o[2],t.moveTo(_+n,f+i);break;case"c":a=_+o[5],h=f+o[6],d=_+o[3],p=f+o[4],t.bezierCurveTo(_+o[1]+n,f+o[2]+i,d+n,p+i,a+n,h+i),_=a,f=h;break;case"C":_=o[5],f=o[6],d=o[3],p=o[4],t.bezierCurveTo(o[1]+n,o[2]+i,d+n,p+i,_+n,f+i);break;case"s":a=_+o[3],h=f+o[4],d=2*_-d,p=2*f-p,t.bezierCurveTo(d+n,p+i,_+o[1]+n,f+o[2]+i,a+n,h+i),d=_+o[1],p=f+o[2],_=a,f=h;break;case"S":a=o[3],h=o[4],d=2*_-d,p=2*f-p,t.bezierCurveTo(d+n,p+i,o[1]+n,o[2]+i,a+n,h+i),_=a,f=h,d=o[1],p=o[2];break;case"q":a=_+o[3],h=f+o[4],d=_+o[1],p=f+o[2],t.quadraticCurveTo(d+n,p+i,a+n,h+i),_=a,f=h;break;case"Q":a=o[3],h=o[4],t.quadraticCurveTo(o[1]+n,o[2]+i,a+n,h+i),_=a,f=h,d=o[1],p=o[2];break;case"t":a=_+o[1],h=f+o[2],null===u[0].match(/[QqTt]/)?(d=_,p=f):"t"===u[0]?(d=2*_-l,p=2*f-c):"q"===u[0]&&(d=2*_-d,p=2*f-p),l=d,c=p,t.quadraticCurveTo(d+n,p+i,a+n,h+i),f=h,d=(_=a)+o[1],p=f+o[2];break;case"T":a=o[1],h=o[2],d=2*_-d,p=2*f-p,t.quadraticCurveTo(d+n,p+i,a+n,h+i),_=a,f=h;break;case"a":jt(t,_+n,f+i,[o[1],o[2],o[3],o[4],o[5],o[6]+_+n,o[7]+f+i]),_+=o[6],f+=o[7];break;case"A":jt(t,_+n,f+i,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+i]),_=o[6],f=o[7];break;case"z":case"Z":_=y,f=x,t.closePath()}u=o}}function jt(t,e,n,i){const s=function(t,e,n,i,s,r,o,a,h){const l=qt.call(arguments);if(Lt[l])return Lt[l];const c=o*Ct,u=Math.sin(c),_=Math.cos(c),f=_*(a-t)*.5+u*(h-e)*.5,d=_*(h-e)*.5-u*(a-t)*.5;let p=f*f/((n=Math.abs(n))*n)+d*d/((i=Math.abs(i))*i);p>1&&(p=Math.sqrt(p),n*=p,i*=p);const y=_/n,x=u/n,g=-u/i,v=_/i,m=y*a+x*h,b=g*a+v*h,k=y*t+x*e,w=g*t+v*e;let T=1/((k-m)*(k-m)+(w-b)*(w-b))-.25;T<0&&(T=0);let M=Math.sqrt(T);r==s&&(M=-M);const z=.5*(m+k)-M*(w-b),R=.5*(b+w)+M*(k-m),A=Math.atan2(b-R,m-z);let S=Math.atan2(w-R,k-z)-A;S<0&&1===r?S+=$t:S>0&&0===r&&(S-=$t);const N=Math.ceil(Math.abs(S/(Et+.001))),C=[];for(let t=0;t<N;++t){const e=A+t*S/N,s=A+(t+1)*S/N;C[t]=[z,R,e,s,n,i,u,_]}return Lt[l]=C}(i[5],i[6],i[0],i[1],i[3],i[4],i[2],e,n);for(let e=0;e<s.length;++e){const n=It(s[e]);t.bezierCurveTo(n[0],n[1],n[2],n[3],n[4],n[5])}}const Bt=.5773502691896257,Gt={circle:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(n,0),t.arc(0,0,n,0,$t)}},cross:{draw:function(t,e){var n=Math.sqrt(e)/2,i=n/2.5;t.moveTo(-n,-i),t.lineTo(-n,i),t.lineTo(-i,i),t.lineTo(-i,n),t.lineTo(i,n),t.lineTo(i,i),t.lineTo(n,i),t.lineTo(n,-i),t.lineTo(i,-i),t.lineTo(i,-n),t.lineTo(-i,-n),t.lineTo(-i,-i),t.closePath()}},diamond:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.closePath()}},square:{draw:function(t,e){var n=Math.sqrt(e),i=-n/2;t.rect(i,i,n,n)}},arrow:{draw:function(t,e){var n=Math.sqrt(e)/2,i=n/7,s=n/2.5,r=n/8;t.moveTo(-i,n),t.lineTo(i,n),t.lineTo(i,-r),t.lineTo(s,-r),t.lineTo(0,-n),t.lineTo(-s,-r),t.lineTo(-i,-r),t.closePath()}},wedge:{draw:function(t,e){var n=Math.sqrt(e)/2,i=Pt*n,s=i-n*Bt,r=n/4;t.moveTo(0,-i-s),t.lineTo(-r,i-s),t.lineTo(r,i-s),t.closePath()}},triangle:{draw:function(t,e){var n=Math.sqrt(e)/2,i=Pt*n,s=i-n*Bt;t.moveTo(0,-i-s),t.lineTo(-n,i-s),t.lineTo(n,i-s),t.closePath()}},"triangle-up":{draw:function(t,e){var n=Math.sqrt(e)/2,i=Pt*n;t.moveTo(0,-i),t.lineTo(-n,i),t.lineTo(n,i),t.closePath()}},"triangle-down":{draw:function(t,e){var n=Math.sqrt(e)/2,i=Pt*n;t.moveTo(0,i),t.lineTo(-n,-i),t.lineTo(n,-i),t.closePath()}},"triangle-right":{draw:function(t,e){var n=Math.sqrt(e)/2,i=Pt*n;t.moveTo(i,0),t.lineTo(-i,-n),t.lineTo(-i,n),t.closePath()}},"triangle-left":{draw:function(t,e){var n=Math.sqrt(e)/2,i=Pt*n;t.moveTo(-i,0),t.lineTo(i,-n),t.lineTo(i,n),t.closePath()}},stroke:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(n,0)}}};function Wt(t){return e.hasOwnProperty(Gt,t)?Gt[t]:function(t){if(!e.hasOwnProperty(Xt,t)){const e=Nt(t);Xt[t]={draw:function(t,n){Ht(t,e,0,0,Math.sqrt(n)/2)}}}return Xt[t]}(t)}var Xt={};const Ut=.448084975506;function Ft(t){return t.x}function Yt(t){return t.y}function Jt(t){return t.width}function Zt(t){return t.height}function Qt(t){return"function"==typeof t?t:()=>+t}function Kt(t,e,n){return Math.max(e,Math.min(t,n))}function te(){var t=Ft,e=Yt,n=Jt,i=Zt,s=Qt(0),r=s,o=s,a=s,h=null;function l(l,c,u){var _,f=null!=c?c:+t.call(this,l),d=null!=u?u:+e.call(this,l),p=+n.call(this,l),y=+i.call(this,l),x=Math.min(p,y)/2,g=Kt(+s.call(this,l),0,x),v=Kt(+r.call(this,l),0,x),m=Kt(+o.call(this,l),0,x),b=Kt(+a.call(this,l),0,x);if(h||(h=_=S()),g<=0&&v<=0&&m<=0&&b<=0)h.rect(f,d,p,y);else{var k=f+p,w=d+y;h.moveTo(f+g,d),h.lineTo(k-v,d),h.bezierCurveTo(k-Ut*v,d,k,d+Ut*v,k,d+v),h.lineTo(k,w-b),h.bezierCurveTo(k,w-Ut*b,k-Ut*b,w,k-b,w),h.lineTo(f+m,w),h.bezierCurveTo(f+Ut*m,w,f,w-Ut*m,f,w-m),h.lineTo(f,d+g),h.bezierCurveTo(f,d+Ut*g,f+Ut*g,d,f+g,d),h.closePath()}if(_)return h=null,_+""||null}return l.x=function(e){return arguments.length?(t=Qt(e),l):t},l.y=function(t){return arguments.length?(e=Qt(t),l):e},l.width=function(t){return arguments.length?(n=Qt(t),l):n},l.height=function(t){return arguments.length?(i=Qt(t),l):i},l.cornerRadius=function(t,e,n,i){return arguments.length?(s=Qt(t),r=null!=e?Qt(e):s,a=null!=n?Qt(n):s,o=null!=i?Qt(i):r,l):s},l.context=function(t){return arguments.length?(h=null==t?null:t,l):h},l}function ee(){var t,e,n,i,s,r,o,a,h=null;function l(t,e,n){const i=n/2;if(s){var l=o-e,c=t-r;if(l||c){var u=Math.hypot(l,c),_=(l/=u)*a,f=(c/=u)*a,d=Math.atan2(c,l);h.moveTo(r-_,o-f),h.lineTo(t-l*i,e-c*i),h.arc(t,e,i,d-Math.PI,d),h.lineTo(r+_,o+f),h.arc(r,o,a,d,d+Math.PI)}else h.arc(t,e,i,0,$t);h.closePath()}else s=1;r=t,o=e,a=i}function c(r){var o,a,c,u=r.length,_=!1;for(null==h&&(h=c=S()),o=0;o<=u;++o)!(o<u&&i(a=r[o],o,r))===_&&(_=!_)&&(s=0),_&&l(+t(a,o,r),+e(a,o,r),+n(a,o,r));if(c)return h=null,c+""||null}return c.x=function(e){return arguments.length?(t=e,c):t},c.y=function(t){return arguments.length?(e=t,c):e},c.size=function(t){return arguments.length?(n=t,c):n},c.defined=function(t){return arguments.length?(i=t,c):i},c.context=function(t){return arguments.length?(h=null==t?null:t,c):h},c}function ne(t,e){return null!=t?t:e}const ie=t=>t.x||0,se=t=>t.y||0,re=t=>!(!1===t.defined),oe=function(){var t=C,e=E,n=c(0),i=null,s=$,r=P,o=L,a=null,h=N(l);function l(){var l,c,d=+t.apply(this,arguments),w=+e.apply(this,arguments),T=s.apply(this,arguments)-m,M=r.apply(this,arguments)-m,z=u(M-T),R=M>T;if(a||(a=l=h()),w<d&&(c=w,w=d,d=c),w>g)if(z>b-g)a.moveTo(w*f(T),w*y(T)),a.arc(0,0,w,T,M,!R),d>g&&(a.moveTo(d*f(M),d*y(M)),a.arc(0,0,d,M,T,R));else{var A,S,N=T,C=M,E=T,$=M,P=z,L=z,q=o.apply(this,arguments)/2,I=q>g&&(i?+i.apply(this,arguments):x(d*d+w*w)),D=p(u(w-d)/2,+n.apply(this,arguments)),V=D,H=D;if(I>g){var j=k(I/d*y(q)),B=k(I/w*y(q));(P-=2*j)>g?(E+=j*=R?1:-1,$-=j):(P=0,E=$=(T+M)/2),(L-=2*B)>g?(N+=B*=R?1:-1,C-=B):(L=0,N=C=(T+M)/2)}var G=w*f(N),W=w*y(N),X=d*f($),U=d*y($);if(D>g){var F,Y=w*f(C),J=w*y(C),Z=d*f(E),Q=d*y(E);if(z<v)if(F=function(t,e,n,i,s,r,o,a){var h=n-t,l=i-e,c=o-s,u=a-r,_=u*h-c*l;if(!(_*_<g))return[t+(_=(c*(e-r)-u*(t-s))/_)*h,e+_*l]}(G,W,Z,Q,Y,J,X,U)){var K=G-F[0],tt=W-F[1],et=Y-F[0],nt=J-F[1],it=1/y(function(t){return t>1?0:t<-1?v:Math.acos(t)}((K*et+tt*nt)/(x(K*K+tt*tt)*x(et*et+nt*nt)))/2),st=x(F[0]*F[0]+F[1]*F[1]);V=p(D,(d-st)/(it-1)),H=p(D,(w-st)/(it+1))}else V=H=0}L>g?H>g?(A=O(Z,Q,G,W,w,H,R),S=O(Y,J,X,U,w,H,R),a.moveTo(A.cx+A.x01,A.cy+A.y01),H<D?a.arc(A.cx,A.cy,H,_(A.y01,A.x01),_(S.y01,S.x01),!R):(a.arc(A.cx,A.cy,H,_(A.y01,A.x01),_(A.y11,A.x11),!R),a.arc(0,0,w,_(A.cy+A.y11,A.cx+A.x11),_(S.cy+S.y11,S.cx+S.x11),!R),a.arc(S.cx,S.cy,H,_(S.y11,S.x11),_(S.y01,S.x01),!R))):(a.moveTo(G,W),a.arc(0,0,w,N,C,!R)):a.moveTo(G,W),d>g&&P>g?V>g?(A=O(X,U,Y,J,d,-V,R),S=O(G,W,Z,Q,d,-V,R),a.lineTo(A.cx+A.x01,A.cy+A.y01),V<D?a.arc(A.cx,A.cy,V,_(A.y01,A.x01),_(S.y01,S.x01),!R):(a.arc(A.cx,A.cy,V,_(A.y01,A.x01),_(A.y11,A.x11),!R),a.arc(0,0,d,_(A.cy+A.y11,A.cx+A.x11),_(S.cy+S.y11,S.cx+S.x11),R),a.arc(S.cx,S.cy,V,_(S.y11,S.x11),_(S.y01,S.x01),!R))):a.arc(0,0,d,$,E,R):a.lineTo(X,U)}else a.moveTo(0,0);if(a.closePath(),l)return a=null,l+""||null}return l.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,i=(+s.apply(this,arguments)+ +r.apply(this,arguments))/2-v/2;return[f(i)*n,y(i)*n]},l.innerRadius=function(e){return arguments.length?(t="function"==typeof e?e:c(+e),l):t},l.outerRadius=function(t){return arguments.length?(e="function"==typeof t?t:c(+t),l):e},l.cornerRadius=function(t){return arguments.length?(n="function"==typeof t?t:c(+t),l):n},l.padRadius=function(t){return arguments.length?(i=null==t?null:"function"==typeof t?t:c(+t),l):i},l.startAngle=function(t){return arguments.length?(s="function"==typeof t?t:c(+t),l):s},l.endAngle=function(t){return arguments.length?(r="function"==typeof t?t:c(+t),l):r},l.padAngle=function(t){return arguments.length?(o="function"==typeof t?t:c(+t),l):o},l.context=function(t){return arguments.length?(a=null==t?null:t,l):a},l}().startAngle((t=>t.startAngle||0)).endAngle((t=>t.endAngle||0)).padAngle((t=>t.padAngle||0)).innerRadius((t=>t.innerRadius||0)).outerRadius((t=>t.outerRadius||0)).cornerRadius((t=>t.cornerRadius||0)),ae=B().x(ie).y1(se).y0((t=>(t.y||0)+(t.height||0))).defined(re),he=B().y(se).x1(ie).x0((t=>(t.x||0)+(t.width||0))).defined(re),le=j().x(ie).y(se).defined(re),ce=te().x(ie).y(se).width((t=>t.width||0)).height((t=>t.height||0)).cornerRadius((t=>ne(t.cornerRadiusTopLeft,t.cornerRadius)||0),(t=>ne(t.cornerRadiusTopRight,t.cornerRadius)||0),(t=>ne(t.cornerRadiusBottomRight,t.cornerRadius)||0),(t=>ne(t.cornerRadiusBottomLeft,t.cornerRadius)||0)),ue=function(t,e){let n=null,i=N(s);function s(){let s;if(n||(n=s=i()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),s)return n=null,s+""||null}return t="function"==typeof t?t:c(t||G),e="function"==typeof e?e:c(void 0===e?64:+e),s.type=function(e){return arguments.length?(t="function"==typeof e?e:c(e),s):t},s.size=function(t){return arguments.length?(e="function"==typeof t?t:c(+t),s):e},s.context=function(t){return arguments.length?(n=null==t?null:t,s):n},s}().type((t=>Wt(t.shape||"circle"))).size((t=>ne(t.size,64))),_e=ee().x(ie).y(se).defined(re).size((t=>t.size||1));function fe(t){return t.cornerRadius||t.cornerRadiusTopLeft||t.cornerRadiusTopRight||t.cornerRadiusBottomRight||t.cornerRadiusBottomLeft}function de(t,e,n,i){return ce.context(t)(e,n,i)}var pe=1;function ye(){pe=1}function xe(t,n,i){var s=n.clip,r=t._defs,o=n.clip_id||(n.clip_id="clip"+pe++),a=r.clipping[o]||(r.clipping[o]={id:o});return e.isFunction(s)?a.path=s(null):fe(i)?a.path=de(null,i,0,0):(a.width=i.width||0,a.height=i.height||0),"url(#"+o+")"}function ge(t){this.clear(),t&&this.union(t)}function ve(t){this.mark=t,this.bounds=this.bounds||new ge}function me(t){ve.call(this,t),this.items=this.items||[]}ge.prototype={clone(){return new ge(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2},set(t,e,n,i){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),i<e?(this.y2=e,this.y1=i):(this.y1=e,this.y2=i),this},add(t,e){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this},expand(t){return this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(t){return this.x1*=t,this.y1*=t,this.x2*=t,this.y2*=t,this},translate(t,e){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this},rotate(t,e,n){const i=this.rotatedPoints(t,e,n);return this.clear().add(i[0],i[1]).add(i[2],i[3]).add(i[4],i[5]).add(i[6],i[7])},rotatedPoints(t,e,n){var{x1:i,y1:s,x2:r,y2:o}=this,a=Math.cos(t),h=Math.sin(t),l=e-e*a+n*h,c=n-e*h-n*a;return[a*i-h*s+l,h*i+a*s+c,a*i-h*o+l,h*i+a*o+c,a*r-h*s+l,h*r+a*s+c,a*r-h*o+l,h*r+a*o+c]},union(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this},intersect(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this},encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2},alignsWith(t){return t&&(this.x1==t.x1||this.x2==t.x2||this.y1==t.y1||this.y2==t.y2)},intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)},contains(t,e){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}},e.inherits(me,ve);class be{constructor(t){this._pending=0,this._loader=t||i.loader()}pending(){return this._pending}sanitizeURL(t){const e=this;return ke(e),e._loader.sanitize(t,{context:"href"}).then((t=>(we(e),t))).catch((()=>(we(e),null)))}loadImage(t){const i=this,s=n.image();return ke(i),i._loader.sanitize(t,{context:"image"}).then((t=>{const n=t.href;if(!n||!s)throw{url:n};const r=new s,o=e.hasOwnProperty(t,"crossOrigin")?t.crossOrigin:"anonymous";return null!=o&&(r.crossOrigin=o),r.onload=()=>we(i),r.onerror=()=>we(i),r.src=n,r})).catch((t=>(we(i),{complete:!1,width:0,height:0,src:t&&t.url||""})))}ready(){const t=this;return new Promise((e=>{!function n(i){t.pending()?setTimeout((()=>{n(!0)}),10):e(i)}(!1)}))}}function ke(t){t._pending+=1}function we(t){t._pending-=1}function Te(t,e,n){if(e.stroke&&0!==e.opacity&&0!==e.strokeOpacity){const i=null!=e.strokeWidth?+e.strokeWidth:1;t.expand(i+(n?function(t,e){return t.strokeJoin&&"miter"!==t.strokeJoin?0:e}(e,i):0))}return t}const Me=$t-1e-8;let ze,Re,Ae,Se,Ne,Ce,Ee,$e;const Pe=(t,e)=>ze.add(t,e),Le=(t,e)=>Pe(Re=t,Ae=e),Oe=t=>Pe(t,ze.y1),qe=t=>Pe(ze.x1,t),Ie=(t,e)=>Ne*t+Ee*e,De=(t,e)=>Ce*t+$e*e,Ve=(t,e)=>Pe(Ie(t,e),De(t,e)),He=(t,e)=>Le(Ie(t,e),De(t,e));function je(t,e){return ze=t,e?(Se=e*Ct,Ne=$e=Math.cos(Se),Ce=Math.sin(Se),Ee=-Ce):(Ne=$e=1,Se=Ce=Ee=0),Be}const Be={beginPath(){},closePath(){},moveTo:He,lineTo:He,rect(t,e,n,i){Se?(Ve(t+n,e),Ve(t+n,e+i),Ve(t,e+i),He(t,e)):(Pe(t+n,e+i),Le(t,e))},quadraticCurveTo(t,e,n,i){const s=Ie(t,e),r=De(t,e),o=Ie(n,i),a=De(n,i);Ge(Re,s,o,Oe),Ge(Ae,r,a,qe),Le(o,a)},bezierCurveTo(t,e,n,i,s,r){const o=Ie(t,e),a=De(t,e),h=Ie(n,i),l=De(n,i),c=Ie(s,r),u=De(s,r);We(Re,o,h,c,Oe),We(Ae,a,l,u,qe),Le(c,u)},arc(t,e,n,i,s,r){if(i+=Se,s+=Se,Re=n*Math.cos(s)+t,Ae=n*Math.sin(s)+e,Math.abs(s-i)>Me)Pe(t-n,e-n),Pe(t+n,e+n);else{const o=i=>Pe(n*Math.cos(i)+t,n*Math.sin(i)+e);let a,h;if(o(i),o(s),s!==i)if((i%=$t)<0&&(i+=$t),(s%=$t)<0&&(s+=$t),s<i&&(r=!r,a=i,i=s,s=a),r)for(s-=$t,a=i-i%Et,h=0;h<4&&a>s;++h,a-=Et)o(a);else for(a=i-i%Et+Et,h=0;h<4&&a<s;++h,a+=Et)o(a)}}};function Ge(t,e,n,i){const s=(t-e)/(t+n-2*e);0<s&&s<1&&i(t+(e-t)*s)}function We(t,e,n,i,s){const r=i-t+3*e-3*n,o=t+n-2*e,a=t-e;let h,l=0,c=0;Math.abs(r)>1e-14?(h=o*o+a*r,h>=0&&(h=Math.sqrt(h),l=(-o+h)/r,c=(-o-h)/r)):l=.5*a/o,0<l&&l<1&&s(Xe(l,t,e,n,i)),0<c&&c<1&&s(Xe(c,t,e,n,i))}function Xe(t,e,n,i,s){const r=1-t,o=r*r,a=t*t;return o*r*e+3*o*t*n+3*r*a*i+a*t*s}var Ue=(Ue=n.canvas(1,1))?Ue.getContext("2d"):null;const Fe=new ge;function Ye(t){return function(e,n){if(!Ue)return!0;t(Ue,e),Fe.clear().union(e.bounds).intersect(n).round();const{x1:i,y1:s,x2:r,y2:o}=Fe;for(let t=s;t<=o;++t)for(let e=i;e<=r;++e)if(Ue.isPointInPath(e,t))return!0;return!1}}function Je(t,e){return e.contains(t.x||0,t.y||0)}function Ze(t,e){const n=t.x||0,i=t.y||0,s=t.width||0,r=t.height||0;return e.intersects(Fe.set(n,i,n+s,i+r))}function Qe(t,e){const n=t.x||0,i=t.y||0;return Ke(e,n,i,null!=t.x2?t.x2:n,null!=t.y2?t.y2:i)}function Ke(t,e,n,i,s){const{x1:r,y1:o,x2:a,y2:h}=t,l=i-e,c=s-n;let u,_,f,d,p=0,y=1;for(d=0;d<4;++d){if(0===d&&(u=-l,_=-(r-e)),1===d&&(u=l,_=a-e),2===d&&(u=-c,_=-(o-n)),3===d&&(u=c,_=h-n),Math.abs(u)<1e-10&&_<0)return!1;if(f=_/u,u<0){if(f>y)return!1;f>p&&(p=f)}else if(u>0){if(f<p)return!1;f<y&&(y=f)}}return!0}function tn(t,e){t.globalCompositeOperation=e.blend||"source-over"}function en(t,e){return null==t?e:t}function nn(t,e){const n=e.length;for(let i=0;i<n;++i)t.addColorStop(e[i].offset,e[i].color);return t}function sn(t,e,i){const s=i.width(),r=i.height();let o;if("radial"===e.gradient)o=t.createRadialGradient(i.x1+en(e.x1,.5)*s,i.y1+en(e.y1,.5)*r,Math.max(s,r)*en(e.r1,0),i.x1+en(e.x2,.5)*s,i.y1+en(e.y2,.5)*r,Math.max(s,r)*en(e.r2,.5));else{const a=en(e.x1,0),h=en(e.y1,0),l=en(e.x2,1),c=en(e.y2,0);if(a!==l&&h!==c&&s!==r){const i=n.canvas(Math.ceil(s),Math.ceil(r)),o=i.getContext("2d");return o.scale(s,r),o.fillStyle=nn(o.createLinearGradient(a,h,l,c),e.stops),o.fillRect(0,0,s,r),t.createPattern(i,"no-repeat")}o=t.createLinearGradient(i.x1+a*s,i.y1+h*r,i.x1+l*s,i.y1+c*r)}return nn(o,e.stops)}function rn(t,e,n){return a(n)?sn(t,n,e.bounds):n}function on(t,e,n){return(n*=null==e.fillOpacity?1:e.fillOpacity)>0&&(t.globalAlpha=n,t.fillStyle=rn(t,e,e.fill),!0)}var an=[];function hn(t,e,n){var i=null!=(i=e.strokeWidth)?i:1;return!(i<=0)&&((n*=null==e.strokeOpacity?1:e.strokeOpacity)>0&&(t.globalAlpha=n,t.strokeStyle=rn(t,e,e.stroke),t.lineWidth=i,t.lineCap=e.strokeCap||"butt",t.lineJoin=e.strokeJoin||"miter",t.miterLimit=e.strokeMiterLimit||10,t.setLineDash&&(t.setLineDash(e.strokeDash||an),t.lineDashOffset=e.strokeDashOffset||0),!0))}function ln(t,e){return t.zindex-e.zindex||t.index-e.index}function cn(t){if(!t.zdirty)return t.zitems;var e,n,i,s=t.items,r=[];for(n=0,i=s.length;n<i;++n)(e=s[n]).index=n,e.zindex&&r.push(e);return t.zdirty=!1,t.zitems=r.sort(ln)}function un(t,e){var n,i,s=t.items;if(!s||!s.length)return;const r=cn(t);if(r&&r.length){for(n=0,i=s.length;n<i;++n)s[n].zindex||e(s[n]);s=r}for(n=0,i=s.length;n<i;++n)e(s[n])}function _n(t,e){var n,i,s=t.items;if(!s||!s.length)return null;const r=cn(t);for(r&&r.length&&(s=r),i=s.length;--i>=0;)if(n=e(s[i]))return n;if(s===r)for(i=(s=t.items).length;--i>=0;)if(!s[i].zindex&&(n=e(s[i])))return n;return null}function fn(t){return function(e,n,i){un(n,(n=>{i&&!i.intersects(n.bounds)||pn(t,e,n,n)}))}}function dn(t){return function(e,n,i){!n.items.length||i&&!i.intersects(n.bounds)||pn(t,e,n.items[0],n.items)}}function pn(t,e,n,i){var s=null==n.opacity?1:n.opacity;0!==s&&(t(e,i)||(tn(e,n),n.fill&&on(e,n,s)&&e.fill(),n.stroke&&hn(e,n,s)&&e.stroke()))}function yn(t){return t=t||e.truthy,function(e,n,i,s,r,o){return _n(n,(n=>{const a=n.bounds;if((!a||a.contains(r,o))&&a)return t(e,n,i,s,r,o)?n:void 0}))}}function xn(t,e){return function(n,i,s,r){var o,a,h=Array.isArray(i)?i[0]:i,l=null==e?h.fill:e,c=h.stroke&&n.isPointInStroke;c&&(o=h.strokeWidth,a=h.strokeCap,n.lineWidth=null!=o?o:1,n.lineCap=null!=a?a:"butt");const u=n.origin,_=n.scale,f=(s+u[0])*_,d=(r+u[1])*_;t(n,i);return l&&n.isPointInPath(f,d)||c&&n.isPointInStroke(f,d)}}function gn(t){return yn(xn(t))}function vn(t,e){return"translate("+t+","+e+")"}function mn(t){return"rotate("+t+")"}function bn(t){return vn(t.x||0,t.y||0)}function kn(t,e,n){function i(t,n){var i=n.x||0,s=n.y||0,r=n.angle||0;t.translate(i,s),r&&t.rotate(r*=Ct),t.beginPath(),e(t,n),r&&t.rotate(-r),t.translate(-i,-s)}return{type:t,tag:"path",nested:!1,attr:function(t,n){t("transform",function(t){return vn(t.x||0,t.y||0)+(t.angle?" "+mn(t.angle):"")}(n)),t("d",e(null,n))},bound:function(t,n){return e(je(t,n.angle),n),Te(t,n).translate(n.x||0,n.y||0)},draw:fn(i),pick:gn(i),isect:n||Ye(i)}}var wn=kn("arc",(function(t,e){return oe.context(t)(e)}));function Tn(t,e,n){function i(t,n){t.beginPath(),e(t,n)}const s=xn(i);return{type:t,tag:"path",nested:!0,attr:function(t,n){var i=n.mark.items;i.length&&t("d",e(null,i))},bound:function(t,n){var i=n.items;return 0===i.length?t:(e(je(t),i),Te(t,i[0]))},draw:dn(i),pick:function(t,e,n,i,r,o){var a=e.items,h=e.bounds;return!a||!a.length||h&&!h.contains(r,o)?(console.log(111),null):s(t,a,n,i)?a[0]:null},isect:Je,tip:n}}var Mn=Tn("area",(function(t,e){const n=e[0],i=n.interpolate||"linear";return("horizontal"===n.orient?he:ae).curve(Tt(i,n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,i,s="horizontal"===t[0].orient?e[1]:e[0],r="horizontal"===t[0].orient?"y":"x",o=t.length,a=1/0;--o>=0;)!1!==t[o].defined&&(i=Math.abs(t[o][r]-s))<a&&(a=i,n=t[o]);return n}));function zn(t,e){t.beginPath(),fe(e)?de(t,e,0,0):t.rect(0,0,e.width||0,e.height||0),t.clip()}function Rn(t){const e=en(t.strokeWidth,1);return null!=t.strokeOffset?t.strokeOffset:t.stroke&&e>.5&&e<1.5?.5-Math.abs(e-1):0}function An(t,e){const n=Rn(e);t("d",de(null,e,n,n))}function Sn(t,e,n,i){const s=Rn(e);t.beginPath(),de(t,e,(n||0)+s,(i||0)+s)}const Nn=xn(Sn),Cn=xn(Sn,!1),En=xn(Sn,!0);var $n={type:"group",tag:"g",nested:!1,attr:function(t,e){t("transform",bn(e))},bound:function(t,e){if(!e.clip&&e.items){const n=e.items,i=n.length;for(let e=0;e<i;++e)t.union(n[e].bounds)}return(e.clip||e.width||e.height)&&!e.noBound&&t.add(0,0).add(e.width||0,e.height||0),Te(t,e),t.translate(e.x||0,e.y||0)},draw:function(t,e,n,i){un(e,(e=>{const s=e.x||0,r=e.y||0,o=e.strokeForeground,a=null==e.opacity?1:e.opacity;(e.stroke||e.fill)&&a&&(Sn(t,e,s,r),tn(t,e),e.fill&&on(t,e,a)&&t.fill(),e.stroke&&!o&&hn(t,e,a)&&t.stroke()),t.save(),t.translate(s,r),e.clip&&zn(t,e),n&&n.translate(-s,-r),un(e,(e=>{("group"===e.marktype||null==i||i.includes(e.marktype))&&this.draw(t,e,n,i)})),n&&n.translate(s,r),t.restore(),o&&e.stroke&&a&&(Sn(t,e,s,r),tn(t,e),hn(t,e,a)&&t.stroke())}))},pick:function(t,e,n,i,s,r){if(e.bounds&&!e.bounds.contains(s,r)||!e.items)return null;const o=n*t.scale,a=i*t.scale;return _n(e,(h=>{let l,c,u;const _=h.bounds;if(_&&!_.contains(s,r))return;c=h.x||0,u=h.y||0;const f=c+(h.width||0),d=u+(h.height||0),p=h.clip;if(p&&(s<c||s>f||r<u||r>d))return;if(t.save(),t.translate(c,u),c=s-c,u=r-u,p&&fe(h)&&!En(t,h,o,a))return t.restore(),null;const y=h.strokeForeground,x=!1!==e.interactive;return x&&y&&h.stroke&&Cn(t,h,o,a)?(t.restore(),h):(l=_n(h,(t=>function(t,e,n){return(!1!==t.interactive||"group"===t.marktype)&&t.bounds&&t.bounds.contains(e,n)}(t,c,u)?this.pick(t,n,i,c,u):null)),!l&&x&&(h.fill||!y&&h.stroke)&&Nn(t,h,o,a)&&(l=h),t.restore(),l||null)}))},isect:Ze,content:function(t,e,n){t("clip-path",e.clip?xe(n,e,e):null)},background:function(t,e){t("class","background"),t("aria-hidden",!0),An(t,e)},foreground:function(t,e){t("class","foreground"),t("aria-hidden",!0),e.strokeForeground?An(t,e):t("d","")}},Pn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function Ln(t,e){var n=t.image;return(!n||t.url&&t.url!==n.url)&&(n={complete:!1,width:0,height:0},e.loadImage(t.url).then((e=>{t.image=e,t.image.url=t.url}))),n}function On(t,e){return null!=t.width?t.width:e&&e.width?!1!==t.aspect&&t.height?t.height*e.width/e.height:e.width:0}function qn(t,e){return null!=t.height?t.height:e&&e.height?!1!==t.aspect&&t.width?t.width*e.height/e.width:e.height:0}function In(t,e){return"center"===t?e/2:"right"===t?e:0}function Dn(t,e){return"middle"===t?e/2:"bottom"===t?e:0}var Vn={type:"image",tag:"image",nested:!1,attr:function(t,e,n){const i=Ln(e,n),s=On(e,i),r=qn(e,i),o=(e.x||0)-In(e.align,s),a=(e.y||0)-Dn(e.baseline,r);t("href",!i.src&&i.toDataURL?i.toDataURL():i.src||"",Pn["xmlns:xlink"],"xlink:href"),t("transform",vn(o,a)),t("width",s),t("height",r),t("preserveAspectRatio",!1===e.aspect?"none":"xMidYMid")},bound:function(t,e){const n=e.image,i=On(e,n),s=qn(e,n),r=(e.x||0)-In(e.align,i),o=(e.y||0)-Dn(e.baseline,s);return t.set(r,o,r+i,o+s)},draw:function(t,e,n){un(e,(e=>{if(n&&!n.intersects(e.bounds))return;const i=Ln(e,this);let s=On(e,i),r=qn(e,i);if(0===s||0===r)return;let o,a,h,l,c=(e.x||0)-In(e.align,s),u=(e.y||0)-Dn(e.baseline,r);!1!==e.aspect&&(a=i.width/i.height,h=e.width/e.height,a==a&&h==h&&a!==h&&(h<a?(l=s/a,u+=(r-l)/2,r=l):(l=r*a,c+=(s-l)/2,s=l))),(i.complete||i.toDataURL)&&(tn(t,e),t.globalAlpha=null!=(o=e.opacity)?o:1,t.imageSmoothingEnabled=!1!==e.smooth,t.drawImage(i,c,u,s,r))}))},pick:yn(),isect:e.truthy,get:Ln,xOffset:In,yOffset:Dn},Hn=Tn("line",(function(t,e){const n=e[0],i=n.interpolate||"linear";return le.curve(Tt(i,n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,i,s=Math.pow(t[0].strokeWidth||1,2),r=t.length;--r>=0;)if(!1!==t[r].defined&&(n=t[r].x-e[0])*n+(i=t[r].y-e[1])*i<s)return t[r];return null}));function jn(t,e){var n=e.path;if(null==n)return!0;var i=e.x||0,s=e.y||0,r=e.scaleX||1,o=e.scaleY||1,a=(e.angle||0)*Ct,h=e.pathCache;h&&h.path===n||((e.pathCache=h=Nt(n)).path=n),a&&t.rotate&&t.translate?(t.translate(i,s),t.rotate(a),Ht(t,h,0,0,r,o),t.rotate(-a),t.translate(-i,-s)):Ht(t,h,i,s,r,o)}var Bn={type:"path",tag:"path",nested:!1,attr:function(t,e){var n=e.scaleX||1,i=e.scaleY||1;1===n&&1===i||t("vector-effect","non-scaling-stroke"),t("transform",function(t){return vn(t.x||0,t.y||0)+(t.angle?" "+mn(t.angle):"")+(t.scaleX||t.scaleY?" "+(e=t.scaleX||1,n=t.scaleY||1,"scale("+e+","+n+")"):"");var e,n}(e)),t("d",e.path)},bound:function(t,e){return jn(je(t,e.angle),e)?t.set(0,0,0,0):Te(t,e,!0)},draw:fn(jn),pick:gn(jn),isect:Ye(jn)};function Gn(t,e){t.beginPath(),de(t,e)}var Wn={type:"rect",tag:"path",nested:!1,attr:function(t,e){t("d",de(null,e))},bound:function(t,e){var n,i;return Te(t.set(n=e.x||0,i=e.y||0,n+e.width||0,i+e.height||0),e)},draw:fn(Gn),pick:gn(Gn),isect:Ze};function Xn(t,e,n){var i,s,r,o;return!(!e.stroke||!hn(t,e,n))&&(i=e.x||0,s=e.y||0,r=null!=e.x2?e.x2:i,o=null!=e.y2?e.y2:s,t.beginPath(),t.moveTo(i,s),t.lineTo(r,o),!0)}var Un={type:"rule",tag:"line",nested:!1,attr:function(t,e){t("transform",bn(e)),t("x2",null!=e.x2?e.x2-(e.x||0):0),t("y2",null!=e.y2?e.y2-(e.y||0):0)},bound:function(t,e){var n,i;return Te(t.set(n=e.x||0,i=e.y||0,null!=e.x2?e.x2:n,null!=e.y2?e.y2:i),e)},draw:function(t,e,n){un(e,(e=>{if(!n||n.intersects(e.bounds)){var i=null==e.opacity?1:e.opacity;i&&Xn(t,e,i)&&(tn(t,e),t.stroke())}}))},pick:yn((function(t,e,n,i){return!!t.isPointInStroke&&(Xn(t,e,1)&&t.isPointInStroke(n,i))})),isect:Qe},Fn=kn("shape",(function(t,e){return(e.mark.shape||e.shape).context(t)(e)})),Yn=kn("symbol",(function(t,e){return ue.context(t)(e)}),Je);const Jn=e.lruCache();var Zn={height:ii,measureWidth:ei,estimateWidth:Kn,width:Kn,canvas:Qn};function Qn(t){Zn.width=t&&Ue?ei:Kn}function Kn(t,e){return ti(oi(t,e),ii(t))}function ti(t,e){return~~(.8*t.length*e)}function ei(t,e){return ii(t)<=0||!(e=oi(t,e))?0:ni(e,hi(t))}function ni(t,e){const n=`(${e}) ${t}`;let i=Jn.get(n);return void 0===i&&(Ue.font=e,i=Ue.measureText(t).width,Jn.set(n,i)),i}function ii(t){return null!=t.fontSize?+t.fontSize||0:11}function si(t){return null!=t.lineHeight?t.lineHeight:ii(t)+2}function ri(t){return n=t.lineBreak&&t.text&&!e.isArray(t.text)?t.text.split(t.lineBreak):t.text,e.isArray(n)?n.length>1?n:n[0]:n;var n}function oi(t,e){const n=null==e?"":(e+"").trim();return t.limit>0&&n.length?function(t,e){var n=+t.limit,i=function(t){if(Zn.width===ei){const e=hi(t);return t=>ni(t,e)}if(Zn.width===Kn){const e=ii(t);return t=>ti(t,e)}return e=>Zn.width(t,e)}(t);if(i(e)<n)return e;var s,r=t.ellipsis||"…",o="rtl"===t.dir,a=0,h=e.length;if(n-=i(r),o){for(;a<h;)s=a+h>>>1,i(e.slice(s))>n?a=s+1:h=s;return r+e.slice(a)}for(;a<h;)s=1+(a+h>>>1),i(e.slice(0,s))<n?a=s:h=s-1;return e.slice(0,a)+r}(t,n):n}function ai(t,e){var n=t.font;return(e&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function hi(t,e){return(t.fontStyle?t.fontStyle+" ":"")+(t.fontVariant?t.fontVariant+" ":"")+(t.fontWeight?t.fontWeight+" ":"")+ii(t)+"px "+ai(t,e)}function li(t){var e=t.baseline,n=ii(t);return Math.round("top"===e?.79*n:"middle"===e?.3*n:"bottom"===e?-.21*n:"line-top"===e?.29*n+.5*si(t):"line-bottom"===e?.29*n-.5*si(t):0)}Qn(!0);const ci={left:"start",center:"middle",right:"end"},ui=new ge;function _i(t){var e,n=t.x||0,i=t.y||0,s=t.radius||0;return s&&(e=(t.theta||0)-Et,n+=s*Math.cos(e),i+=s*Math.sin(e)),ui.x1=n,ui.y1=i,ui}function fi(t,n,i){var s,r=Zn.height(n),o=n.align,a=_i(n),h=a.x1,l=a.y1,c=n.dx||0,u=(n.dy||0)+li(n)-Math.round(.8*r),_=ri(n);if(e.isArray(_)?(r+=si(n)*(_.length-1),s=_.reduce(((t,e)=>Math.max(t,Zn.width(n,e))),0)):s=Zn.width(n,_),"center"===o?c-=s/2:"right"===o&&(c-=s),t.set(c+=h,u+=l,c+s,u+r),n.angle&&!i)t.rotate(n.angle*Ct,h,l);else if(2===i)return t.rotatedPoints(n.angle*Ct,h,l);return t}var di={type:"text",tag:"text",nested:!1,attr:function(t,e){var n,i=e.dx||0,s=(e.dy||0)+li(e),r=_i(e),o=r.x1,a=r.y1,h=e.angle||0;t("text-anchor",ci[e.align]||"start"),h?(n=vn(o,a)+" "+mn(h),(i||s)&&(n+=" "+vn(i,s))):n=vn(o+i,a+s),t("transform",n)},bound:fi,draw:function(t,n,i){un(n,(n=>{var s,r,o,a,h,l,c,u=null==n.opacity?1:n.opacity;if(!(i&&!i.intersects(n.bounds)||0===u||n.fontSize<=0||null==n.text||0===n.text.length)){if(t.font=hi(n),t.textAlign=n.align||"left",r=(s=_i(n)).x1,o=s.y1,n.angle&&(t.save(),t.translate(r,o),t.rotate(n.angle*Ct),r=o=0),r+=n.dx||0,o+=(n.dy||0)+li(n),l=ri(n),tn(t,n),e.isArray(l))for(h=si(n),a=0;a<l.length;++a)c=oi(n,l[a]),n.fill&&on(t,n,u)&&t.fillText(c,r,o),n.stroke&&hn(t,n,u)&&t.strokeText(c,r,o),o+=h;else c=oi(n,l),n.fill&&on(t,n,u)&&t.fillText(c,r,o),n.stroke&&hn(t,n,u)&&t.strokeText(c,r,o);n.angle&&t.restore()}}))},pick:yn((function(t,e,n,i,s,r){if(e.fontSize<=0)return!1;if(!e.angle)return!0;var o=_i(e),a=o.x1,h=o.y1,l=fi(ui,e,1),c=-e.angle*Ct,u=Math.cos(c),_=Math.sin(c),f=u*s-_*r+(a-u*a+_*h),d=_*s+u*r+(h-_*a-u*h);return l.contains(f,d)})),isect:function(t,e){const n=fi(ui,t,2);return Ke(e,n[0],n[1],n[2],n[3])||Ke(e,n[0],n[1],n[4],n[5])||Ke(e,n[4],n[5],n[6],n[7])||Ke(e,n[2],n[3],n[6],n[7])}},pi=Tn("trail",(function(t,e){return _e.context(t)(e)}),(function(t,e){for(var n,i,s=t.length;--s>=0;)if(!1!==t[s].defined&&(n=t[s].x-e[0])*n+(i=t[s].y-e[1])*i<(n=t[s].size||1)*n)return t[s];return null})),yi={arc:wn,area:Mn,group:$n,image:Vn,line:Hn,path:Bn,rect:Wn,rule:Un,shape:Fn,symbol:Yn,text:di,trail:pi};function xi(t,e,n){var i=yi[t.mark.marktype],s=e||i.bound;return i.nested&&(t=t.mark),s(t.bounds||(t.bounds=new ge),t,n)}var gi={mark:null};function vi(t,e,n){var i,s,r,o,a=yi[t.marktype],h=a.bound,l=t.items,c=l&&l.length;if(a.nested)return c?r=l[0]:(gi.mark=t,r=gi),o=xi(r,h,n),e=e&&e.union(o)||o;if(e=e||t.bounds&&t.bounds.clear()||new ge,c)for(i=0,s=l.length;i<s;++i)e.union(xi(l[i],h,n));return t.bounds=e}const mi=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function bi(t,e){return JSON.stringify(t,mi,e)}function ki(t){return wi("string"==typeof t?JSON.parse(t):t)}function wi(t){var e,n,i,s=t.marktype,r=t.items;if(r)for(n=0,i=r.length;n<i;++n)e=s?"mark":"group",r[n][e]=t,r[n].zindex&&(r[n][e].zdirty=!0),"group"===(s||e)&&wi(r[n]);return s&&vi(t),t}function Ti(t,e){const n={bounds:new ge,clip:!!t.clip,group:e,interactive:!1!==t.interactive,items:[],marktype:t.marktype,name:t.name||void 0,role:t.role||void 0,zindex:t.zindex||0};return null!=t.aria&&(n.aria=t.aria),t.description&&(n.description=t.description),n}function Mi(t,e,n){return!t&&"undefined"!=typeof document&&document.createElement&&(t=document),t?n?t.createElementNS(n,e):t.createElement(e):null}function zi(t,e){e=e.toLowerCase();for(var n=t.childNodes,i=0,s=n.length;i<s;++i)if(n[i].tagName.toLowerCase()===e)return n[i]}function Ri(t,e,n,i){var s,r=t.childNodes[e];return r&&r.tagName.toLowerCase()===n.toLowerCase()||(s=r||null,r=Mi(t.ownerDocument,n,i),t.insertBefore(r,s)),r}function Ai(t,e){for(var n=t.childNodes,i=n.length;i>e;)t.removeChild(n[--i]);return t}function Si(t){return"mark-"+t.marktype+(t.role?" role-"+t.role:"")+(t.name?" "+t.name:"")}function Ni(t,e){const n=e.getBoundingClientRect();return[t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0)]}class Ci{constructor(t,e){this._active=null,this._handlers={},this._loader=t||i.loader(),this._tooltip=e||Ei}initialize(t,e,n){return this._el=t,this._obj=n||null,this.origin(e)}element(){return this._el}canvas(){return this._el&&this._el.firstChild}origin(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()}scene(t){return arguments.length?(this._scene=t,this):this._scene}on(){}off(){}_handlerIndex(t,e,n){for(let i=t?t.length:0;--i>=0;)if(t[i].type===e&&(!n||t[i].handler===n))return i;return-1}handlers(t){const e=this._handlers,n=[];if(t)n.push(...e[this.eventName(t)]);else for(const t in e)n.push(...e[t]);return n}eventName(t){const e=t.indexOf(".");return e<0?t:t.slice(0,e)}handleHref(t,e,n){this._loader.sanitize(n,{context:"href"}).then((e=>{const n=new MouseEvent(t.type,t),i=Mi(null,"a");for(const t in e)i.setAttribute(t,e[t]);i.dispatchEvent(n)})).catch((()=>{}))}handleTooltip(t,e,n){if(e&&null!=e.tooltip){e=function(t,e,n,i){var s,r,o=t&&t.mark;if(o&&(s=yi[o.marktype]).tip){for((r=Ni(e,n))[0]-=i[0],r[1]-=i[1];t=t.mark.group;)r[0]-=t.x||0,r[1]-=t.y||0;t=s.tip(o.items,r)}return t}(e,t,this.canvas(),this._origin);const i=n&&e&&e.tooltip||null;this._tooltip.call(this._obj,this,t,e,i)}}getItemBoundingClientRect(t){const e=this.canvas();if(!e)return;const n=e.getBoundingClientRect(),i=this._origin,s=t.bounds,r=s.width(),o=s.height();let a=s.x1+i[0]+n.left,h=s.y1+i[1]+n.top;for(;t.mark&&(t=t.mark.group);)a+=t.x||0,h+=t.y||0;return{x:a,y:h,width:r,height:o,left:a,top:h,right:a+r,bottom:h+o}}}function Ei(t,e,n,i){t.element().setAttribute("title",i||"")}class $i{constructor(t){this._el=null,this._bgcolor=null,this._loader=new be(t)}initialize(t,e,n,i,s){return this._el=t,this.resize(e,n,i,s)}element(){return this._el}canvas(){return this._el&&this._el.firstChild}background(t){return 0===arguments.length?this._bgcolor:(this._bgcolor=t,this)}resize(t,e,n,i){return this._width=t,this._height=e,this._origin=n||[0,0],this._scale=i||1,this}dirty(){}render(t,e){const n=this;return n._call=function(){n._render(t,e)},n._call(),n._call=null,n}_render(){}renderAsync(t,e){const n=this.render(t,e);return this._ready?this._ready.then((()=>n)):Promise.resolve(n)}_load(t,e){var n=this,i=n._loader[t](e);if(!n._ready){const t=n._call;n._ready=n._loader.ready().then((e=>{e&&t(),n._ready=null}))}return i}sanitizeURL(t){return this._load("sanitizeURL",t)}loadImage(t){return this._load("loadImage",t)}}const Pi="dragenter",Li="dragleave",Oi="dragover",qi="pointerdown",Ii="pointermove",Di="pointerout",Vi="pointerover",Hi="mousedown",ji="mousemove",Bi="mouseout",Gi="mouseover",Wi="click",Xi="mousewheel",Ui="touchstart",Fi="touchmove",Yi="touchend",Ji=["keydown","keypress","keyup",Pi,Li,Oi,qi,"pointerup",Ii,Di,Vi,Hi,"mouseup",ji,Bi,Gi,Wi,"dblclick","wheel",Xi,Ui,Fi,Yi],Zi=Ii,Qi=Di,Ki=Wi;class ts extends Ci{constructor(t,e){super(t,e),this._down=null,this._touch=null,this._first=!0,this._events={},this.events=Ji,this.pointermove=ss([Ii,ji],[Vi,Gi],[Di,Bi]),this.dragover=ss([Oi],[Pi],[Li]),this.pointerout=rs([Di,Bi]),this.dragleave=rs([Li])}initialize(t,e,n){return this._canvas=t&&zi(t,"canvas"),[Wi,Hi,qi,Ii,Di,Li].forEach((t=>ns(this,t))),super.initialize(t,e,n)}canvas(){return this._canvas}context(){return this._canvas.getContext("2d")}DOMMouseScroll(t){this.fire(Xi,t)}pointerdown(t){this._down=this._active,this.fire(qi,t)}mousedown(t){this._down=this._active,this.fire(Hi,t)}click(t){this._down===this._active&&(this.fire(Wi,t),this._down=null)}touchstart(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(Ui,t,!0)}touchmove(t){this.fire(Fi,t,!0)}touchend(t){this.fire(Yi,t,!0),this._touch=null}fire(t,e,n){const i=n?this._touch:this._active,s=this._handlers[t];if(e.vegaType=t,t===Ki&&i&&i.href?this.handleHref(e,i,i.href):t!==Zi&&t!==Qi||this.handleTooltip(e,i,t!==Qi),s)for(let t=0,n=s.length;t<n;++t)s[t].handler.call(this._obj,e,i)}on(t,e){const n=this.eventName(t),i=this._handlers;return this._handlerIndex(i[n],t,e)<0&&(ns(this,t),(i[n]||(i[n]=[])).push({type:t,handler:e})),this}off(t,e){const n=this.eventName(t),i=this._handlers[n],s=this._handlerIndex(i,t,e);return s>=0&&i.splice(s,1),this}pickEvent(t){const e=Ni(t,this._canvas),n=this._origin,i=this.context(),s=i.getTransform(),r=s.a,o=s.e/i.pixelRatio,a=s.f/i.pixelRatio;return e[0]=(e[0]-o)*i.pixelRatio/r,e[1]=(e[1]-a)*i.pixelRatio/r,this.pick(this._scene,e[0],e[1],e[0]-n[0],e[1]-n[1])}pick(t,e,n,i,s){const r=this.context();return yi[t.marktype].pick.call(this,r,t,e,n,i,s)}}const es=t=>t===Ui||t===Fi||t===Yi?[Ui,Fi,Yi]:[t];function ns(t,e){es(e).forEach((e=>function(t,e){const n=t.canvas();n&&!t._events[e]&&(t._events[e]=1,n.addEventListener(e,t[e]?n=>t[e](n):n=>t.fire(e,n)))}(t,e)))}function is(t,e,n){e.forEach((e=>t.fire(e,n)))}function ss(t,e,n){return function(i){const s=this._active,r=this.pickEvent(i);r===s||(s&&s.exit||is(this,n,i),this._active=r,is(this,e,i)),is(this,t,i)}}function rs(t){return function(e){is(this,t,e),this._active=null}}class os extends $i{constructor(t){super(t),this._options={},this._redraw=!1,this._dirty=new ge,this._tempb=new ge}initialize(t,e,i,s,r,o){return this._options=o||{},this._canvas=this._options.externalContext?null:n.canvas(1,1,this._options.type),t&&this._canvas&&(Ai(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),super.initialize(t,e,i,s,r)}resize(t,n,i,s){if(super.resize(t,n,i,s),this._canvas)!function(t,e,n,i,s,r){const o="undefined"!=typeof HTMLElement&&t instanceof HTMLElement&&null!=t.parentNode,a=t.getContext("2d");t.width=2*e,t.height=2*n;for(const t in r)a[t]=r[t];o&&(t.style.width=e+"px",t.style.height=n+"px"),a.pixelRatio=2,s*=2,a.origin=i,a.scale=s,a.setTransform(s,0,0,s,s*i[0],s*i[1])}(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const t=this._options.externalContext;t||e.error("CanvasRenderer is missing a valid canvas or context"),t.scale(this._scale,this._scale),t.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this}canvas(){return this._canvas}context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)}dirty(t){const e=this._tempb.clear().union(t.bounds);let n=t.mark.group;for(;n;)e.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(e)}_render(t,e){const n=this.context(),i=this._origin,s=this._scale,r=this._width,o=this._height,a=this._dirty,h=as(i,r,o,s);n.save();const l=this._redraw||a.empty()?(this._redraw=!1,h.expand(1)):function(t,e,n,i){e.expand(1).round(),t.pixelRatio%1&&e.scale(t.pixelRatio).round().scale(1/t.pixelRatio);return e.scale(1/i),e.translate(-n[0]%1,-n[1]%1),t.beginPath(),t.rect(e.x1,e.y1,e.width(),e.height()),t.clip(),e}(n,h.intersect(a),i,s);return this.clear(-i[0],-i[1],r,o),this.draw(n,t,l,e),n.restore(),a.clear(),this}draw(t,n,i,s){if("group"!==n.marktype&&null!=s&&!s.includes(n.marktype))return;const r=yi[n.marktype];n.clip&&function(t,n){var i=n.clip;t.save(),e.isFunction(i)?(t.beginPath(),i(t),t.clip()):zn(t,n.group)}(t,n),r.draw.call(this,t,n,i,s),n.clip&&t.restore()}clear(t,e,n,i){const s=this._options,r=this.context();"pdf"===s.type||s.externalContext||r.clearRect(t,e,n,i),null!=this._bgcolor&&(r.fillStyle=this._bgcolor,r.fillRect(t,e,n,i))}}const as=(t,e,n,i)=>(new ge).set(0,0,e,n).scale(1/i).translate(-t[0],-t[1]);class hs extends Ci{constructor(t,e){super(t,e);const n=this;n._hrefHandler=ls(n,((t,e)=>{e&&e.href&&n.handleHref(t,e,e.href)})),n._tooltipHandler=ls(n,((t,e)=>{n.handleTooltip(t,e,t.type!==Qi)}))}initialize(t,e,n){let i=this._svg;return i&&(i.removeEventListener(Ki,this._hrefHandler),i.removeEventListener(Zi,this._tooltipHandler),i.removeEventListener(Qi,this._tooltipHandler)),this._svg=i=t&&zi(t,"svg"),i&&(i.addEventListener(Ki,this._hrefHandler),i.addEventListener(Zi,this._tooltipHandler),i.addEventListener(Qi,this._tooltipHandler)),super.initialize(t,e,n)}canvas(){return this._svg}on(t,e){const n=this.eventName(t),i=this._handlers;if(this._handlerIndex(i[n],t,e)<0){const s={type:t,handler:e,listener:ls(this,e)};(i[n]||(i[n]=[])).push(s),this._svg&&this._svg.addEventListener(n,s.listener)}return this}off(t,e){const n=this.eventName(t),i=this._handlers[n],s=this._handlerIndex(i,t,e);return s>=0&&(this._svg&&this._svg.removeEventListener(n,i[s].listener),i.splice(s,1)),this}}const ls=(t,e)=>n=>{let i=n.target.__data__;i=Array.isArray(i)?i[0]:i,n.vegaType=n.type,e.call(t._obj,n,i)},cs="aria-hidden",us="aria-label",_s="role",fs="aria-roledescription",ds="graphics-object",ps="graphics-symbol",ys=(t,e,n)=>({[_s]:t,[fs]:e,[us]:n||void 0}),xs=e.toSet(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),gs={axis:{desc:"axis",caption:function(t){const e=t.datum,n=t.orient,i=e.title?ws(t):null,r=t.context,o=r.scales[e.scale].value,a=r.dataflow.locale(),h=o.type;return("left"===n||"right"===n?"Y":"X")+"-axis"+(i?` titled '${i}'`:"")+` for a ${s.isDiscrete(h)?"discrete":h} scale`+` with ${s.domainCaption(a,o,t)}`}},legend:{desc:"legend",caption:function(t){const n=t.datum,i=n.title?ws(t):null,r=`${n.type||""} legend`.trim(),o=n.scales,a=Object.keys(o),h=t.context,l=h.scales[o[a[0]]].value,c=h.dataflow.locale();return u=r,(u.length?u[0].toUpperCase()+u.slice(1):u)+(i?` titled '${i}'`:"")+` for ${function(t){return t=t.map((t=>t+("fill"===t||"stroke"===t?" color":""))),t.length<2?t[0]:t.slice(0,-1).join(", ")+" and "+e.peek(t)}(a)}`+` with ${s.domainCaption(c,l,t)}`;var u}},"title-text":{desc:"title",caption:t=>`Title text '${ks(t)}'`},"title-subtitle":{desc:"subtitle",caption:t=>`Subtitle text '${ks(t)}'`}},vs={ariaRole:_s,ariaRoleDescription:fs,description:us};function ms(t,e){const n=!1===e.aria;if(t(cs,n||void 0),n||null==e.description)for(const e in vs)t(vs[e],void 0);else{const n=e.mark.marktype;t(us,e.description),t(_s,e.ariaRole||("group"===n?ds:ps)),t(fs,e.ariaRoleDescription||`${n} mark`)}}function bs(t){return!1===t.aria?{[cs]:!0}:xs[t.role]?null:gs[t.role]?function(t,e){try{const n=t.items[0],i=e.caption||(()=>"");return ys(e.role||ps,e.desc,n.description||i(n))}catch(t){return null}}(t,gs[t.role]):function(t){const e=t.marktype,n="group"===e||"text"===e||t.items.some((t=>null!=t.description&&!1!==t.aria));return ys(n?ds:ps,`${e} mark container`,t.description)}(t)}function ks(t){return e.array(t.text).join(" ")}function ws(t){try{return e.array(e.peek(t.items).items[0].text).join(" ")}catch(t){return null}}const Ts=t=>(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");function Ms(){let t="",e="",n="";const i=[],s=()=>e=n="",r=(t,n)=>{var i;return null!=n&&(e+=` ${t}="${i=n,Ts(i).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;")}"`),o},o={open(a){(r=>{e&&(t+=`${e}>${n}`,s()),i.push(r)})(a),e="<"+a;for(var h=arguments.length,l=new Array(h>1?h-1:0),c=1;c<h;c++)l[c-1]=arguments[c];for(const t of l)for(const e in t)r(e,t[e]);return o},close(){const r=i.pop();return t+=e?e+(n?`>${n}</${r}>`:"/>"):`</${r}>`,s(),o},attr:r,text:t=>(n+=Ts(t),o),toString:()=>t};return o}const zs=t=>Rs(Ms(),t)+"";function Rs(t,e){if(t.open(e.tagName),e.hasAttributes()){const n=e.attributes,i=n.length;for(let e=0;e<i;++e)t.attr(n[e].name,n[e].value)}if(e.hasChildNodes()){const n=e.childNodes;for(const e of n)3===e.nodeType?t.text(e.nodeValue):Rs(t,e)}return t.close()}const As={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},Ss={blend:"mix-blend-mode"},Ns={fill:"none","stroke-miterlimit":10},Cs="http://www.w3.org/2000/xmlns/",Es=Pn.xmlns;class $s extends $i{constructor(t){super(t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}initialize(t,e,n,i,s){return this._defs={},this._clearDefs(),t&&(this._svg=Ri(t,0,"svg",Es),this._svg.setAttributeNS(Cs,"xmlns",Es),this._svg.setAttributeNS(Cs,"xmlns:xlink",Pn["xmlns:xlink"]),this._svg.setAttribute("version",Pn.version),this._svg.setAttribute("class","marks"),Ai(t,1),this._root=Ri(this._svg,0,"g",Es),Bs(this._root,Ns),Ai(this._svg,1)),this.background(this._bgcolor),super.initialize(t,e,n,i,s)}background(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),super.background(...arguments)}resize(t,e,n,i){return super.resize(t,e,n,i),this._svg&&(Bs(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this}canvas(){return this._svg}svg(){const t=this._svg,e=this._bgcolor;if(!t)return null;let n;e&&(t.removeAttribute("style"),n=Ri(t,0,"rect",Es),Bs(n,{width:this._width,height:this._height,fill:e}));const i=zs(t);return e&&(t.removeChild(n),this._svg.style.setProperty("background-color",e)),i}_render(t,e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,t,void 0,e),Ai(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this}dirty(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))}isDirty(t){return this._dirtyAll||!t._svg||!t._svg.ownerSVGElement||t.dirty===this._dirtyID}_dirtyCheck(){this._dirtyAll=!0;const t=this._dirty;if(!t.length||!this._dirtyID)return!0;const e=++this._dirtyID;let n,i,s,r,o,a,h;for(o=0,a=t.length;o<a;++o)n=t[o],i=n.mark,i.marktype!==s&&(s=i.marktype,r=yi[s]),i.zdirty&&i.dirty!==e&&(this._dirtyAll=!1,Ps(n,e),i.items.forEach((t=>{t.dirty=e}))),i.zdirty||(n.exit?(r.nested&&i.items.length?(h=i.items[0],h._svg&&this._update(r,h._svg,h)):n._svg&&(h=n._svg.parentNode,h&&h.removeChild(n._svg)),n._svg=null):(n=r.nested?i.items[0]:n,n._update!==e&&(n._svg&&n._svg.ownerSVGElement?this._update(r,n._svg,n):(this._dirtyAll=!1,Ps(n,e)),n._update=e)));return!this._dirtyAll}mark(t,e,n,i){if(!this.isDirty(e))return e._svg;const s=this._svg,r=e.marktype,o=yi[r],a=!1===e.interactive?"none":null,h="g"===o.tag,l=qs(e,t,n,"g",s);if("group"!==r&&null!=i&&!i.includes(r))return Ai(l,0),e._svg;l.setAttribute("class",Si(e));const c=bs(e);for(const t in c)Gs(l,t,c[t]);h||Gs(l,"pointer-events",a),Gs(l,"clip-path",e.clip?xe(this,e,e.group):null);let u=null,_=0;const f=t=>{const e=this.isDirty(t),n=qs(t,l,u,o.tag,s);e&&(this._update(o,n,t),h&&function(t,e,n,i){e=e.lastChild.previousSibling;let s,r=0;un(n,(n=>{s=t.mark(e,n,s,i),++r})),Ai(e,r)}(this,n,t,i)),u=n,++_};return o.nested?e.items.length&&f(e.items[0]):un(e,f),Ai(l,_),l}_update(t,e,n){Is=e,Ds=e.__values__,ms(Hs,n),t.attr(Hs,n,this);const i=Vs[t.type];i&&i.call(this,t,e,n),Is&&this.style(Is,n)}style(t,e){if(null!=e){for(const n in As){let i="font"===n?ai(e):e[n];if(i===Ds[n])continue;const s=As[n];null==i?t.removeAttribute(s):(a(i)&&(i=h(i,this._defs.gradient,Ws())),t.setAttribute(s,i+"")),Ds[n]=i}for(const n in Ss)js(t,Ss[n],e[n])}}defs(){const t=this._svg,e=this._defs;let n=e.el,i=0;for(const s in e.gradient)n||(e.el=n=Ri(t,1,"defs",Es)),i=Ls(n,e.gradient[s],i);for(const s in e.clipping)n||(e.el=n=Ri(t,1,"defs",Es)),i=Os(n,e.clipping[s],i);n&&(0===i?(t.removeChild(n),e.el=null):Ai(n,i))}_clearDefs(){const t=this._defs;t.gradient={},t.clipping={}}}function Ps(t,e){for(;t&&t.dirty!==e;t=t.mark.group){if(t.dirty=e,!t.mark||t.mark.dirty===e)return;t.mark.dirty=e}}function Ls(t,e,n){let i,s,r;if("radial"===e.gradient){let i=Ri(t,n++,"pattern",Es);Bs(i,{id:o+e.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),i=Ri(i,0,"rect",Es),Bs(i,{width:1,height:1,fill:`url(${Ws()}#${e.id})`}),Bs(t=Ri(t,n++,"radialGradient",Es),{id:e.id,fx:e.x1,fy:e.y1,fr:e.r1,cx:e.x2,cy:e.y2,r:e.r2})}else Bs(t=Ri(t,n++,"linearGradient",Es),{id:e.id,x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2});for(i=0,s=e.stops.length;i<s;++i)r=Ri(t,i,"stop",Es),r.setAttribute("offset",e.stops[i].offset),r.setAttribute("stop-color",e.stops[i].color);return Ai(t,i),n}function Os(t,e,n){let i;return(t=Ri(t,n,"clipPath",Es)).setAttribute("id",e.id),e.path?(i=Ri(t,0,"path",Es),i.setAttribute("d",e.path)):(i=Ri(t,0,"rect",Es),Bs(i,{x:0,y:0,width:e.width,height:e.height})),Ai(t,1),n+1}function qs(t,e,n,i,s){let r,o=t._svg;if(!o&&(r=e.ownerDocument,o=Mi(r,i,Es),t._svg=o,t.mark&&(o.__data__=t,o.__values__={fill:"default"},"g"===i))){const e=Mi(r,"path",Es);o.appendChild(e),e.__data__=t;const n=Mi(r,"g",Es);o.appendChild(n),n.__data__=t;const i=Mi(r,"path",Es);o.appendChild(i),i.__data__=t,i.__values__={fill:"default"}}return(o.ownerSVGElement!==s||function(t,e){return t.parentNode&&t.parentNode.childNodes.length>1&&t.previousSibling!=e}(o,n))&&e.insertBefore(o,n?n.nextSibling:e.firstChild),o}let Is=null,Ds=null;const Vs={group(t,e,n){const i=Is=e.childNodes[2];Ds=i.__values__,t.foreground(Hs,n,this),Ds=e.__values__,Is=e.childNodes[1],t.content(Hs,n,this);const s=Is=e.childNodes[0];t.background(Hs,n,this);const r=!1===n.mark.interactive?"none":null;if(r!==Ds.events&&(Gs(i,"pointer-events",r),Gs(s,"pointer-events",r),Ds.events=r),n.strokeForeground&&n.stroke){const t=n.fill;Gs(i,"display",null),this.style(s,n),Gs(s,"stroke",null),t&&(n.fill=null),Ds=i.__values__,this.style(i,n),t&&(n.fill=t),Is=null}else Gs(i,"display","none")},image(t,e,n){!1===n.smooth?(js(e,"image-rendering","optimizeSpeed"),js(e,"image-rendering","pixelated")):js(e,"image-rendering",null)},text(t,n,i){const s=ri(i);let r,o,a,h;e.isArray(s)?(o=s.map((t=>oi(i,t))),r=o.join("\n"),r!==Ds.text&&(Ai(n,0),a=n.ownerDocument,h=si(i),o.forEach(((t,e)=>{const s=Mi(a,"tspan",Es);s.__data__=i,s.textContent=t,e&&(s.setAttribute("x",0),s.setAttribute("dy",h)),n.appendChild(s)})),Ds.text=r)):(o=oi(i,s),o!==Ds.text&&(n.textContent=o,Ds.text=o)),Gs(n,"font-family",ai(i)),Gs(n,"font-size",ii(i)+"px"),Gs(n,"font-style",i.fontStyle),Gs(n,"font-variant",i.fontVariant),Gs(n,"font-weight",i.fontWeight)}};function Hs(t,e,n){e!==Ds[t]&&(n?function(t,e,n,i){null!=n?t.setAttributeNS(i,e,n):t.removeAttributeNS(i,e)}(Is,t,e,n):Gs(Is,t,e),Ds[t]=e)}function js(t,e,n){n!==Ds[e]&&(null==n?t.style.removeProperty(e):t.style.setProperty(e,n+""),Ds[e]=n)}function Bs(t,e){for(const n in e)Gs(t,n,e[n])}function Gs(t,e,n){null!=n?t.setAttribute(e,n):t.removeAttribute(e)}function Ws(){let t;return"undefined"==typeof window?"":(t=window.location).hash?t.href.slice(0,-t.hash.length):t.href}class Xs extends $i{constructor(t){super(t),this._text=null,this._defs={gradient:{},clipping:{}}}svg(){return this._text}_render(t){const n=Ms();n.open("svg",e.extend({},Pn,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const i=this._bgcolor;return i&&"transparent"!==i&&"none"!==i&&n.open("rect",{width:this._width,height:this._height,fill:i}).close(),n.open("g",Ns,{transform:"translate("+this._origin+")"}),this.mark(n,t),n.close(),this.defs(n),this._text=n.close()+"",this}mark(t,n){const i=yi[n.marktype],s=i.tag,r=[ms,i.attr];t.open("g",{class:Si(n),"clip-path":n.clip?xe(this,n,n.group):null},bs(n),{"pointer-events":"g"!==s&&!1===n.interactive?"none":null});const o=o=>{const a=this.href(o);if(a&&t.open("a",a),t.open(s,this.attr(n,o,r,"g"!==s?s:null)),"text"===s){const n=ri(o);if(e.isArray(n)){const e={x:0,dy:si(o)};for(let i=0;i<n.length;++i)t.open("tspan",i?e:null).text(oi(o,n[i])).close()}else t.text(oi(o,n))}else if("g"===s){const e=o.strokeForeground,s=o.fill,r=o.stroke;e&&r&&(o.stroke=null),t.open("path",this.attr(n,o,i.background,"bgrect")).close(),t.open("g",this.attr(n,o,i.content)),un(o,(e=>this.mark(t,e))),t.close(),e&&r?(s&&(o.fill=null),o.stroke=r,t.open("path",this.attr(n,o,i.foreground,"bgrect")).close(),s&&(o.fill=s)):t.open("path",this.attr(n,o,i.foreground,"bgfore")).close()}t.close(),a&&t.close()};return i.nested?n.items&&n.items.length&&o(n.items[0]):un(n,o),t.close()}href(t){const e=t.href;let n;if(e){if(n=this._hrefs&&this._hrefs[e])return n;this.sanitizeURL(e).then((t=>{t["xlink:href"]=t.href,t.href=null,(this._hrefs||(this._hrefs={}))[e]=t}))}return null}attr(t,e,n,i){const s={},r=(t,e,n,i)=>{s[i||t]=e};return Array.isArray(n)?n.forEach((t=>t(r,e,this))):n(r,e,this),i&&function(t,e,n,i,s){let r;if(null==e)return t;"bgrect"===i&&!1===n.interactive&&(t["pointer-events"]="none");if("bgfore"===i&&(!1===n.interactive&&(t["pointer-events"]="none"),t.display="none",null!==e.fill))return t;"image"===i&&!1===e.smooth&&(r=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]);"text"===i&&(t["font-family"]=ai(e),t["font-size"]=ii(e)+"px",t["font-style"]=e.fontStyle,t["font-variant"]=e.fontVariant,t["font-weight"]=e.fontWeight);for(const n in As){let i=e[n];const r=As[n];("transparent"!==i||"fill"!==r&&"stroke"!==r)&&null!=i&&(a(i)&&(i=h(i,s.gradient,"")),t[r]=i)}for(const t in Ss){const n=e[t];null!=n&&(r=r||[],r.push(`${Ss[t]}: ${n};`))}r&&(t.style=r.join(" "))}(s,e,t,i,this._defs),s}defs(t){const e=this._defs.gradient,n=this._defs.clipping;if(0!==Object.keys(e).length+Object.keys(n).length){t.open("defs");for(const n in e){const i=e[n],s=i.stops;"radial"===i.gradient?(t.open("pattern",{id:o+n,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),t.open("rect",{width:"1",height:"1",fill:"url(#"+n+")"}).close(),t.close(),t.open("radialGradient",{id:n,fx:i.x1,fy:i.y1,fr:i.r1,cx:i.x2,cy:i.y2,r:i.r2})):t.open("linearGradient",{id:n,x1:i.x1,x2:i.x2,y1:i.y1,y2:i.y2});for(let e=0;e<s.length;++e)t.open("stop",{offset:s[e].offset,"stop-color":s[e].color}).close();t.close()}for(const e in n){const i=n[e];t.open("clipPath",{id:e}),i.path?t.open("path",{d:i.path}).close():t.open("rect",{x:0,y:0,width:i.width,height:i.height}).close(),t.close()}t.close()}}}const Us={svgMarkTypes:["text"],svgOnTop:!0,debug:!1};class Fs extends $i{constructor(t){super(t),this._svgRenderer=new $s(t),this._canvasRenderer=new os(t)}initialize(t,e,n,i,s){this._root_el=Ri(t,0,"div");const r=Ri(this._root_el,0,"div"),o=Ri(this._root_el,1,"div");return this._root_el.style.position="relative",Us.debug||(r.style.height="100%",o.style.position="absolute",o.style.top="0",o.style.left="0",o.style.height="100%",o.style.width="100%"),this._svgEl=Us.svgOnTop?o:r,this._canvasEl=Us.svgOnTop?r:o,this._svgEl.style.pointerEvents="none",this._canvasRenderer.initialize(this._canvasEl,e,n,i,s),this._svgRenderer.initialize(this._svgEl,e,n,i,s),super.initialize(t,e,n,i,s)}dirty(t){return Us.svgMarkTypes.includes(t.mark.marktype)?this._svgRenderer.dirty(t):this._canvasRenderer.dirty(t),this}_render(t,e){const n=(e??["arc","area","image","line","path","rect","rule","shape","symbol","text","trail"]).filter((t=>!Us.svgMarkTypes.includes(t)));this._svgRenderer.render(t,Us.svgMarkTypes),this._canvasRenderer.render(t,n)}resize(t,e,n,i){return super.resize(t,e,n,i),this._svgRenderer.resize(t,e,n,i),this._canvasRenderer.resize(t,e,n,i),this}background(t){return Us.svgOnTop?this._canvasRenderer.background(t):this._svgRenderer.background(t),this}}class Ys extends ts{constructor(t,e){super(t,e)}initialize(t,e,n){const i=Ri(Ri(t,0,"div"),Us.svgOnTop?0:1,"div");return super.initialize(i,e,n)}}const Js="canvas",Zs="hybrid",Qs="none",Ks={Canvas:Js,PNG:"png",SVG:"svg",Hybrid:Zs,None:Qs},tr={};function er(t,e,n,i){if(function(t,e,n){return t.bounds&&e.intersects(t.bounds)&&("group"===t.marktype||!1!==t.interactive&&(!n||n(t)))}(t,e,n)){const s=t.items,r=t.marktype,o=s.length;let a=0;if("group"===r)for(;a<o;++a)nr(s[a],e,n,i);else for(const t=yi[r].isect;a<o;++a){const n=s[a];ir(n,e,t)&&i.push(n)}}return i}function nr(t,e,n,i){n&&n(t.mark)&&ir(t,e,yi.group.isect)&&i.push(t);const s=t.items,r=s&&s.length;if(r){const o=t.x||0,a=t.y||0;e.translate(-o,-a);for(let t=0;t<r;++t)er(s[t],e,n,i);e.translate(o,a)}return i}function ir(t,e,n){const i=t.bounds;return e.encloses(i)||e.intersects(i)&&n(t,e)}tr[Js]=tr.png={renderer:os,headless:os,handler:ts},tr.svg={renderer:$s,headless:Xs,handler:hs},tr[Zs]={renderer:Fs,headless:Fs,handler:Ys},tr[Qs]={};const sr=new ge;const rr=1e-9;function or(t,n,i){return t===n||("path"===i?ar(t,n):t instanceof Date&&n instanceof Date?+t==+n:e.isNumber(t)&&e.isNumber(n)?Math.abs(t-n)<=rr:t&&n&&(e.isObject(t)||e.isObject(n))?function(t,e){var n,i,s=Object.keys(t),r=Object.keys(e);if(s.length!==r.length)return!1;for(s.sort(),r.sort(),i=s.length-1;i>=0;i--)if(s[i]!=r[i])return!1;for(i=s.length-1;i>=0;i--)if(!or(t[n=s[i]],e[n],n))return!1;return typeof t==typeof e}(t,n):t==n)}function ar(t,e){return or(Nt(t),Nt(e))}t.Bounds=ge,t.CanvasHandler=ts,t.CanvasRenderer=os,t.Gradient=function(t,e){var n,i=[];return n={gradient:"linear",x1:t?t[0]:0,y1:t?t[1]:0,x2:e?e[0]:1,y2:e?e[1]:0,stops:i,stop:function(t,e){return i.push({offset:t,color:e}),n}}},t.GroupItem=me,t.Handler=Ci,t.HybridHandler=Ys,t.HybridRenderer=Fs,t.Item=ve,t.Marks=yi,t.RenderType=Ks,t.Renderer=$i,t.ResourceLoader=be,t.SVGHandler=hs,t.SVGRenderer=$s,t.SVGStringRenderer=Xs,t.Scenegraph=class{constructor(t){arguments.length?this.root=ki(t):(this.root=Ti({marktype:"group",name:"root",role:"frame"}),this.root.items=[new me(this.root)])}toJSON(t){return bi(this.root,t||0)}mark(t,e,n){const i=Ti(t,e=e||this.root.items[0]);return e.items[n]=i,i.zindex&&(i.group.zdirty=!0),i}},t.boundClip=function(t){const n=t.clip;if(e.isFunction(n))n(je(sr.clear()));else{if(!n)return;sr.set(0,0,t.group.width,t.group.height)}t.bounds.intersect(sr)},t.boundContext=je,t.boundItem=xi,t.boundMark=vi,t.boundStroke=Te,t.domChild=Ri,t.domClear=Ai,t.domCreate=Mi,t.domFind=zi,t.font=hi,t.fontFamily=ai,t.fontSize=ii,t.intersect=function(t,n,i){const s=[],r=(new ge).union(n),o=t.marktype;return o?er(t,r,i,s):"group"===o?nr(t,r,i,s):e.error("Intersect scene must be mark node or group item.")},t.intersectBoxLine=Ke,t.intersectPath=Ye,t.intersectPoint=Je,t.intersectRule=Qe,t.lineHeight=si,t.markup=Ms,t.multiLineOffset=function(t){const n=ri(t);return(e.isArray(n)?n.length-1:0)*si(t)},t.path=S,t.pathCurves=Tt,t.pathEqual=ar,t.pathParse=Nt,t.pathRectangle=te,t.pathRender=Ht,t.pathSymbols=Wt,t.pathTrail=ee,t.point=Ni,t.renderModule=function(t,e){return t=String(t||"").toLowerCase(),arguments.length>1?(tr[t]=e,this):tr[t]},t.resetSVGClipId=ye,t.resetSVGDefIds=function(){ye(),r=0},t.sceneEqual=or,t.sceneFromJSON=ki,t.scenePickVisit=_n,t.sceneToJSON=bi,t.sceneVisit=un,t.sceneZOrder=cn,t.serializeXML=zs,t.setHybridRendererOptions=function(t){Us.svgMarkTypes=t.svgMarkTypes??["text"],Us.svgOnTop=t.svgOnTop??!0,Us.debug=t.debug??!1},t.textMetrics=Zn}));
//# sourceMappingURL=vega-scenegraph.min.js.map
