{"version":3,"file":"vega-scenegraph.min.js","sources":["../src/Gradient.js","../../../node_modules/d3-shape/src/constant.js","../../../node_modules/d3-shape/src/math.js","../../../node_modules/d3-path/src/path.js","../../../node_modules/d3-shape/src/path.js","../../../node_modules/d3-shape/src/arc.js","../../../node_modules/d3-shape/src/array.js","../../../node_modules/d3-shape/src/curve/linear.js","../../../node_modules/d3-shape/src/point.js","../../../node_modules/d3-shape/src/line.js","../../../node_modules/d3-shape/src/area.js","../../../node_modules/d3-shape/src/symbol/circle.js","../../../node_modules/d3-shape/src/noop.js","../../../node_modules/d3-shape/src/curve/basis.js","../../../node_modules/d3-shape/src/curve/basisClosed.js","../../../node_modules/d3-shape/src/curve/basisOpen.js","../../../node_modules/d3-shape/src/curve/bundle.js","../../../node_modules/d3-shape/src/curve/cardinal.js","../../../node_modules/d3-shape/src/curve/cardinalClosed.js","../../../node_modules/d3-shape/src/curve/cardinalOpen.js","../../../node_modules/d3-shape/src/curve/catmullRom.js","../../../node_modules/d3-shape/src/curve/catmullRomClosed.js","../../../node_modules/d3-shape/src/curve/catmullRomOpen.js","../../../node_modules/d3-shape/src/curve/linearClosed.js","../../../node_modules/d3-shape/src/curve/monotone.js","../../../node_modules/d3-shape/src/curve/natural.js","../../../node_modules/d3-shape/src/curve/step.js","../src/path/curves.js","../src/path/parse.js","../src/util/constants.js","../src/path/arc.js","../src/path/render.js","../src/path/symbols.js","../src/path/rectangle.js","../src/path/trail.js","../src/path/shapes.js","../../../node_modules/d3-shape/src/symbol.js","../src/util/svg/clip.js","../src/Bounds.js","../src/Item.js","../src/GroupItem.js","../src/ResourceLoader.js","../src/bound/boundStroke.js","../src/bound/boundContext.js","../src/util/canvas/context.js","../src/util/intersect.js","../src/util/canvas/blend.js","../src/util/value.js","../src/util/canvas/gradient.js","../src/util/canvas/color.js","../src/util/canvas/fill.js","../src/util/canvas/stroke.js","../src/util/visit.js","../src/util/canvas/draw.js","../src/util/canvas/pick.js","../src/util/svg/transform.js","../src/marks/markItemPath.js","../src/marks/arc.js","../src/marks/markMultiItemPath.js","../src/marks/area.js","../src/util/pickPath.js","../src/util/canvas/clip.js","../src/marks/group.js","../src/util/svg/metadata.js","../src/marks/image.js","../src/marks/line.js","../src/marks/path.js","../src/marks/rect.js","../src/marks/rule.js","../src/marks/shape.js","../src/marks/symbol.js","../src/util/text.js","../src/marks/text.js","../src/marks/trail.js","../src/marks/index.js","../src/bound/boundItem.js","../src/bound/boundMark.js","../src/util/serialize.js","../src/Scenegraph.js","../src/util/dom.js","../src/util/point.js","../src/Handler.js","../src/util/resolveItem.js","../src/Renderer.js","../src/util/events.js","../src/CanvasHandler.js","../src/CanvasRenderer.js","../src/util/canvas/resize.js","../src/SVGHandler.js","../src/util/aria.js","../src/util/markup.js","../src/util/svg/styles.js","../src/SVGRenderer.js","../src/SVGStringRenderer.js","../src/HybridRenderer.js","../src/HybridHandler.js","../src/modules.js","../src/intersect.js","../src/bound/boundClip.js","../src/util/equal.js","../index.js"],"sourcesContent":["let gradient_id = 0;\n\nexport function resetSVGGradientId() {\n  gradient_id = 0;\n}\n\nexport const patternPrefix = 'p_';\n\nexport function isGradient(value) {\n  return value && value.gradient;\n}\n\nexport function gradientRef(g, defs, base) {\n  const type = g.gradient;\n\n  let id = g.id,\n      prefix = type === 'radial' ? patternPrefix : '';\n\n  // check id, assign default values as needed\n  if (!id) {\n    id = g.id = 'gradient_' + (gradient_id++);\n    if (type === 'radial') {\n      g.x1 = get(g.x1, 0.5);\n      g.y1 = get(g.y1, 0.5);\n      g.r1 = get(g.r1, 0);\n      g.x2 = get(g.x2, 0.5);\n      g.y2 = get(g.y2, 0.5);\n      g.r2 = get(g.r2, 0.5);\n      prefix = patternPrefix;\n    } else {\n      g.x1 = get(g.x1, 0);\n      g.y1 = get(g.y1, 0);\n      g.x2 = get(g.x2, 1);\n      g.y2 = get(g.y2, 0);\n    }\n  }\n\n  // register definition\n  defs[id] = g;\n\n  // return url reference\n  return 'url(' + (base || '') + '#' + prefix + id + ')';\n}\n\nfunction get(val, def) {\n  return val != null ? val : def;\n}\n\nexport default function(p0, p1) {\n  var stops = [], gradient;\n  return gradient = {\n    gradient: 'linear',\n    x1: p0 ? p0[0] : 0,\n    y1: p0 ? p0[1] : 0,\n    x2: p1 ? p1[0] : 1,\n    y2: p1 ? p1[1] : 0,\n    stops: stops,\n    stop: function(offset, color) {\n      stops.push({offset: offset, color: color});\n      return gradient;\n    }\n  };\n}\n","export default function(x) {\n  return function constant() {\n    return x;\n  };\n}\n","export const abs = Math.abs;\nexport const atan2 = Math.atan2;\nexport const cos = Math.cos;\nexport const max = Math.max;\nexport const min = Math.min;\nexport const sin = Math.sin;\nexport const sqrt = Math.sqrt;\n\nexport const epsilon = 1e-12;\nexport const pi = Math.PI;\nexport const halfPi = pi / 2;\nexport const tau = 2 * pi;\n\nexport function acos(x) {\n  return x > 1 ? 0 : x < -1 ? pi : Math.acos(x);\n}\n\nexport function asin(x) {\n  return x >= 1 ? halfPi : x <= -1 ? -halfPi : Math.asin(x);\n}\n","const pi = Math.PI,\n    tau = 2 * pi,\n    epsilon = 1e-6,\n    tauEpsilon = tau - epsilon;\n\nfunction append(strings) {\n  this._ += strings[0];\n  for (let i = 1, n = strings.length; i < n; ++i) {\n    this._ += arguments[i] + strings[i];\n  }\n}\n\nfunction appendRound(digits) {\n  let d = Math.floor(digits);\n  if (!(d >= 0)) throw new Error(`invalid digits: ${digits}`);\n  if (d > 15) return append;\n  const k = 10 ** d;\n  return function(strings) {\n    this._ += strings[0];\n    for (let i = 1, n = strings.length; i < n; ++i) {\n      this._ += Math.round(arguments[i] * k) / k + strings[i];\n    }\n  };\n}\n\nexport class Path {\n  constructor(digits) {\n    this._x0 = this._y0 = // start of current subpath\n    this._x1 = this._y1 = null; // end of current subpath\n    this._ = \"\";\n    this._append = digits == null ? append : appendRound(digits);\n  }\n  moveTo(x, y) {\n    this._append`M${this._x0 = this._x1 = +x},${this._y0 = this._y1 = +y}`;\n  }\n  closePath() {\n    if (this._x1 !== null) {\n      this._x1 = this._x0, this._y1 = this._y0;\n      this._append`Z`;\n    }\n  }\n  lineTo(x, y) {\n    this._append`L${this._x1 = +x},${this._y1 = +y}`;\n  }\n  quadraticCurveTo(x1, y1, x, y) {\n    this._append`Q${+x1},${+y1},${this._x1 = +x},${this._y1 = +y}`;\n  }\n  bezierCurveTo(x1, y1, x2, y2, x, y) {\n    this._append`C${+x1},${+y1},${+x2},${+y2},${this._x1 = +x},${this._y1 = +y}`;\n  }\n  arcTo(x1, y1, x2, y2, r) {\n    x1 = +x1, y1 = +y1, x2 = +x2, y2 = +y2, r = +r;\n\n    // Is the radius negative? Error.\n    if (r < 0) throw new Error(`negative radius: ${r}`);\n\n    let x0 = this._x1,\n        y0 = this._y1,\n        x21 = x2 - x1,\n        y21 = y2 - y1,\n        x01 = x0 - x1,\n        y01 = y0 - y1,\n        l01_2 = x01 * x01 + y01 * y01;\n\n    // Is this path empty? Move to (x1,y1).\n    if (this._x1 === null) {\n      this._append`M${this._x1 = x1},${this._y1 = y1}`;\n    }\n\n    // Or, is (x1,y1) coincident with (x0,y0)? Do nothing.\n    else if (!(l01_2 > epsilon));\n\n    // Or, are (x0,y0), (x1,y1) and (x2,y2) collinear?\n    // Equivalently, is (x1,y1) coincident with (x2,y2)?\n    // Or, is the radius zero? Line to (x1,y1).\n    else if (!(Math.abs(y01 * x21 - y21 * x01) > epsilon) || !r) {\n      this._append`L${this._x1 = x1},${this._y1 = y1}`;\n    }\n\n    // Otherwise, draw an arc!\n    else {\n      let x20 = x2 - x0,\n          y20 = y2 - y0,\n          l21_2 = x21 * x21 + y21 * y21,\n          l20_2 = x20 * x20 + y20 * y20,\n          l21 = Math.sqrt(l21_2),\n          l01 = Math.sqrt(l01_2),\n          l = r * Math.tan((pi - Math.acos((l21_2 + l01_2 - l20_2) / (2 * l21 * l01))) / 2),\n          t01 = l / l01,\n          t21 = l / l21;\n\n      // If the start tangent is not coincident with (x0,y0), line to.\n      if (Math.abs(t01 - 1) > epsilon) {\n        this._append`L${x1 + t01 * x01},${y1 + t01 * y01}`;\n      }\n\n      this._append`A${r},${r},0,0,${+(y01 * x20 > x01 * y20)},${this._x1 = x1 + t21 * x21},${this._y1 = y1 + t21 * y21}`;\n    }\n  }\n  arc(x, y, r, a0, a1, ccw) {\n    x = +x, y = +y, r = +r, ccw = !!ccw;\n\n    // Is the radius negative? Error.\n    if (r < 0) throw new Error(`negative radius: ${r}`);\n\n    let dx = r * Math.cos(a0),\n        dy = r * Math.sin(a0),\n        x0 = x + dx,\n        y0 = y + dy,\n        cw = 1 ^ ccw,\n        da = ccw ? a0 - a1 : a1 - a0;\n\n    // Is this path empty? Move to (x0,y0).\n    if (this._x1 === null) {\n      this._append`M${x0},${y0}`;\n    }\n\n    // Or, is (x0,y0) not coincident with the previous point? Line to (x0,y0).\n    else if (Math.abs(this._x1 - x0) > epsilon || Math.abs(this._y1 - y0) > epsilon) {\n      this._append`L${x0},${y0}`;\n    }\n\n    // Is this arc empty? Weâ€™re done.\n    if (!r) return;\n\n    // Does the angle go the wrong way? Flip the direction.\n    if (da < 0) da = da % tau + tau;\n\n    // Is this a complete circle? Draw two arcs to complete the circle.\n    if (da > tauEpsilon) {\n      this._append`A${r},${r},0,1,${cw},${x - dx},${y - dy}A${r},${r},0,1,${cw},${this._x1 = x0},${this._y1 = y0}`;\n    }\n\n    // Is this arc non-empty? Draw an arc!\n    else if (da > epsilon) {\n      this._append`A${r},${r},0,${+(da >= pi)},${cw},${this._x1 = x + r * Math.cos(a1)},${this._y1 = y + r * Math.sin(a1)}`;\n    }\n  }\n  rect(x, y, w, h) {\n    this._append`M${this._x0 = this._x1 = +x},${this._y0 = this._y1 = +y}h${w = +w}v${+h}h${-w}Z`;\n  }\n  toString() {\n    return this._;\n  }\n}\n\nexport function path() {\n  return new Path;\n}\n\n// Allow instanceof d3.path\npath.prototype = Path.prototype;\n\nexport function pathRound(digits = 3) {\n  return new Path(+digits);\n}\n","import {Path} from \"d3-path\";\n\nexport function withPath(shape) {\n  let digits = 3;\n\n  shape.digits = function(_) {\n    if (!arguments.length) return digits;\n    if (_ == null) {\n      digits = null;\n    } else {\n      const d = Math.floor(_);\n      if (!(d >= 0)) throw new RangeError(`invalid digits: ${_}`);\n      digits = d;\n    }\n    return shape;\n  };\n\n  return () => new Path(digits);\n}\n","import constant from \"./constant.js\";\nimport {abs, acos, asin, atan2, cos, epsilon, halfPi, max, min, pi, sin, sqrt, tau} from \"./math.js\";\nimport {withPath} from \"./path.js\";\n\nfunction arcInnerRadius(d) {\n  return d.innerRadius;\n}\n\nfunction arcOuterRadius(d) {\n  return d.outerRadius;\n}\n\nfunction arcStartAngle(d) {\n  return d.startAngle;\n}\n\nfunction arcEndAngle(d) {\n  return d.endAngle;\n}\n\nfunction arcPadAngle(d) {\n  return d && d.padAngle; // Note: optional!\n}\n\nfunction intersect(x0, y0, x1, y1, x2, y2, x3, y3) {\n  var x10 = x1 - x0, y10 = y1 - y0,\n      x32 = x3 - x2, y32 = y3 - y2,\n      t = y32 * x10 - x32 * y10;\n  if (t * t < epsilon) return;\n  t = (x32 * (y0 - y2) - y32 * (x0 - x2)) / t;\n  return [x0 + t * x10, y0 + t * y10];\n}\n\n// Compute perpendicular offset line of length rc.\n// http://mathworld.wolfram.com/Circle-LineIntersection.html\nfunction cornerTangents(x0, y0, x1, y1, r1, rc, cw) {\n  var x01 = x0 - x1,\n      y01 = y0 - y1,\n      lo = (cw ? rc : -rc) / sqrt(x01 * x01 + y01 * y01),\n      ox = lo * y01,\n      oy = -lo * x01,\n      x11 = x0 + ox,\n      y11 = y0 + oy,\n      x10 = x1 + ox,\n      y10 = y1 + oy,\n      x00 = (x11 + x10) / 2,\n      y00 = (y11 + y10) / 2,\n      dx = x10 - x11,\n      dy = y10 - y11,\n      d2 = dx * dx + dy * dy,\n      r = r1 - rc,\n      D = x11 * y10 - x10 * y11,\n      d = (dy < 0 ? -1 : 1) * sqrt(max(0, r * r * d2 - D * D)),\n      cx0 = (D * dy - dx * d) / d2,\n      cy0 = (-D * dx - dy * d) / d2,\n      cx1 = (D * dy + dx * d) / d2,\n      cy1 = (-D * dx + dy * d) / d2,\n      dx0 = cx0 - x00,\n      dy0 = cy0 - y00,\n      dx1 = cx1 - x00,\n      dy1 = cy1 - y00;\n\n  // Pick the closer of the two intersection points.\n  // TODO Is there a faster way to determine which intersection to use?\n  if (dx0 * dx0 + dy0 * dy0 > dx1 * dx1 + dy1 * dy1) cx0 = cx1, cy0 = cy1;\n\n  return {\n    cx: cx0,\n    cy: cy0,\n    x01: -ox,\n    y01: -oy,\n    x11: cx0 * (r1 / r - 1),\n    y11: cy0 * (r1 / r - 1)\n  };\n}\n\nexport default function() {\n  var innerRadius = arcInnerRadius,\n      outerRadius = arcOuterRadius,\n      cornerRadius = constant(0),\n      padRadius = null,\n      startAngle = arcStartAngle,\n      endAngle = arcEndAngle,\n      padAngle = arcPadAngle,\n      context = null,\n      path = withPath(arc);\n\n  function arc() {\n    var buffer,\n        r,\n        r0 = +innerRadius.apply(this, arguments),\n        r1 = +outerRadius.apply(this, arguments),\n        a0 = startAngle.apply(this, arguments) - halfPi,\n        a1 = endAngle.apply(this, arguments) - halfPi,\n        da = abs(a1 - a0),\n        cw = a1 > a0;\n\n    if (!context) context = buffer = path();\n\n    // Ensure that the outer radius is always larger than the inner radius.\n    if (r1 < r0) r = r1, r1 = r0, r0 = r;\n\n    // Is it a point?\n    if (!(r1 > epsilon)) context.moveTo(0, 0);\n\n    // Or is it a circle or annulus?\n    else if (da > tau - epsilon) {\n      context.moveTo(r1 * cos(a0), r1 * sin(a0));\n      context.arc(0, 0, r1, a0, a1, !cw);\n      if (r0 > epsilon) {\n        context.moveTo(r0 * cos(a1), r0 * sin(a1));\n        context.arc(0, 0, r0, a1, a0, cw);\n      }\n    }\n\n    // Or is it a circular or annular sector?\n    else {\n      var a01 = a0,\n          a11 = a1,\n          a00 = a0,\n          a10 = a1,\n          da0 = da,\n          da1 = da,\n          ap = padAngle.apply(this, arguments) / 2,\n          rp = (ap > epsilon) && (padRadius ? +padRadius.apply(this, arguments) : sqrt(r0 * r0 + r1 * r1)),\n          rc = min(abs(r1 - r0) / 2, +cornerRadius.apply(this, arguments)),\n          rc0 = rc,\n          rc1 = rc,\n          t0,\n          t1;\n\n      // Apply padding? Note that since r1 â‰¥ r0, da1 â‰¥ da0.\n      if (rp > epsilon) {\n        var p0 = asin(rp / r0 * sin(ap)),\n            p1 = asin(rp / r1 * sin(ap));\n        if ((da0 -= p0 * 2) > epsilon) p0 *= (cw ? 1 : -1), a00 += p0, a10 -= p0;\n        else da0 = 0, a00 = a10 = (a0 + a1) / 2;\n        if ((da1 -= p1 * 2) > epsilon) p1 *= (cw ? 1 : -1), a01 += p1, a11 -= p1;\n        else da1 = 0, a01 = a11 = (a0 + a1) / 2;\n      }\n\n      var x01 = r1 * cos(a01),\n          y01 = r1 * sin(a01),\n          x10 = r0 * cos(a10),\n          y10 = r0 * sin(a10);\n\n      // Apply rounded corners?\n      if (rc > epsilon) {\n        var x11 = r1 * cos(a11),\n            y11 = r1 * sin(a11),\n            x00 = r0 * cos(a00),\n            y00 = r0 * sin(a00),\n            oc;\n\n        // Restrict the corner radius according to the sector angle. If this\n        // intersection fails, itâ€™s probably because the arc is too small, so\n        // disable the corner radius entirely.\n        if (da < pi) {\n          if (oc = intersect(x01, y01, x00, y00, x11, y11, x10, y10)) {\n            var ax = x01 - oc[0],\n                ay = y01 - oc[1],\n                bx = x11 - oc[0],\n                by = y11 - oc[1],\n                kc = 1 / sin(acos((ax * bx + ay * by) / (sqrt(ax * ax + ay * ay) * sqrt(bx * bx + by * by))) / 2),\n                lc = sqrt(oc[0] * oc[0] + oc[1] * oc[1]);\n            rc0 = min(rc, (r0 - lc) / (kc - 1));\n            rc1 = min(rc, (r1 - lc) / (kc + 1));\n          } else {\n            rc0 = rc1 = 0;\n          }\n        }\n      }\n\n      // Is the sector collapsed to a line?\n      if (!(da1 > epsilon)) context.moveTo(x01, y01);\n\n      // Does the sectorâ€™s outer ring have rounded corners?\n      else if (rc1 > epsilon) {\n        t0 = cornerTangents(x00, y00, x01, y01, r1, rc1, cw);\n        t1 = cornerTangents(x11, y11, x10, y10, r1, rc1, cw);\n\n        context.moveTo(t0.cx + t0.x01, t0.cy + t0.y01);\n\n        // Have the corners merged?\n        if (rc1 < rc) context.arc(t0.cx, t0.cy, rc1, atan2(t0.y01, t0.x01), atan2(t1.y01, t1.x01), !cw);\n\n        // Otherwise, draw the two corners and the ring.\n        else {\n          context.arc(t0.cx, t0.cy, rc1, atan2(t0.y01, t0.x01), atan2(t0.y11, t0.x11), !cw);\n          context.arc(0, 0, r1, atan2(t0.cy + t0.y11, t0.cx + t0.x11), atan2(t1.cy + t1.y11, t1.cx + t1.x11), !cw);\n          context.arc(t1.cx, t1.cy, rc1, atan2(t1.y11, t1.x11), atan2(t1.y01, t1.x01), !cw);\n        }\n      }\n\n      // Or is the outer ring just a circular arc?\n      else context.moveTo(x01, y01), context.arc(0, 0, r1, a01, a11, !cw);\n\n      // Is there no inner ring, and itâ€™s a circular sector?\n      // Or perhaps itâ€™s an annular sector collapsed due to padding?\n      if (!(r0 > epsilon) || !(da0 > epsilon)) context.lineTo(x10, y10);\n\n      // Does the sectorâ€™s inner ring (or point) have rounded corners?\n      else if (rc0 > epsilon) {\n        t0 = cornerTangents(x10, y10, x11, y11, r0, -rc0, cw);\n        t1 = cornerTangents(x01, y01, x00, y00, r0, -rc0, cw);\n\n        context.lineTo(t0.cx + t0.x01, t0.cy + t0.y01);\n\n        // Have the corners merged?\n        if (rc0 < rc) context.arc(t0.cx, t0.cy, rc0, atan2(t0.y01, t0.x01), atan2(t1.y01, t1.x01), !cw);\n\n        // Otherwise, draw the two corners and the ring.\n        else {\n          context.arc(t0.cx, t0.cy, rc0, atan2(t0.y01, t0.x01), atan2(t0.y11, t0.x11), !cw);\n          context.arc(0, 0, r0, atan2(t0.cy + t0.y11, t0.cx + t0.x11), atan2(t1.cy + t1.y11, t1.cx + t1.x11), cw);\n          context.arc(t1.cx, t1.cy, rc0, atan2(t1.y11, t1.x11), atan2(t1.y01, t1.x01), !cw);\n        }\n      }\n\n      // Or is the inner ring just a circular arc?\n      else context.arc(0, 0, r0, a10, a00, cw);\n    }\n\n    context.closePath();\n\n    if (buffer) return context = null, buffer + \"\" || null;\n  }\n\n  arc.centroid = function() {\n    var r = (+innerRadius.apply(this, arguments) + +outerRadius.apply(this, arguments)) / 2,\n        a = (+startAngle.apply(this, arguments) + +endAngle.apply(this, arguments)) / 2 - pi / 2;\n    return [cos(a) * r, sin(a) * r];\n  };\n\n  arc.innerRadius = function(_) {\n    return arguments.length ? (innerRadius = typeof _ === \"function\" ? _ : constant(+_), arc) : innerRadius;\n  };\n\n  arc.outerRadius = function(_) {\n    return arguments.length ? (outerRadius = typeof _ === \"function\" ? _ : constant(+_), arc) : outerRadius;\n  };\n\n  arc.cornerRadius = function(_) {\n    return arguments.length ? (cornerRadius = typeof _ === \"function\" ? _ : constant(+_), arc) : cornerRadius;\n  };\n\n  arc.padRadius = function(_) {\n    return arguments.length ? (padRadius = _ == null ? null : typeof _ === \"function\" ? _ : constant(+_), arc) : padRadius;\n  };\n\n  arc.startAngle = function(_) {\n    return arguments.length ? (startAngle = typeof _ === \"function\" ? _ : constant(+_), arc) : startAngle;\n  };\n\n  arc.endAngle = function(_) {\n    return arguments.length ? (endAngle = typeof _ === \"function\" ? _ : constant(+_), arc) : endAngle;\n  };\n\n  arc.padAngle = function(_) {\n    return arguments.length ? (padAngle = typeof _ === \"function\" ? _ : constant(+_), arc) : padAngle;\n  };\n\n  arc.context = function(_) {\n    return arguments.length ? ((context = _ == null ? null : _), arc) : context;\n  };\n\n  return arc;\n}\n","export var slice = Array.prototype.slice;\n\nexport default function(x) {\n  return typeof x === \"object\" && \"length\" in x\n    ? x // Array, TypedArray, NodeList, array-like\n    : Array.from(x); // Map, Set, iterable, string, or anything else\n}\n","function Linear(context) {\n  this._context = context;\n}\n\nLinear.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._point = 0;\n  },\n  lineEnd: function() {\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; // falls through\n      default: this._context.lineTo(x, y); break;\n    }\n  }\n};\n\nexport default function(context) {\n  return new Linear(context);\n}\n","export function x(p) {\n  return p[0];\n}\n\nexport function y(p) {\n  return p[1];\n}\n","import array from \"./array.js\";\nimport constant from \"./constant.js\";\nimport curveLinear from \"./curve/linear.js\";\nimport {withPath} from \"./path.js\";\nimport {x as pointX, y as pointY} from \"./point.js\";\n\nexport default function(x, y) {\n  var defined = constant(true),\n      context = null,\n      curve = curveLinear,\n      output = null,\n      path = withPath(line);\n\n  x = typeof x === \"function\" ? x : (x === undefined) ? pointX : constant(x);\n  y = typeof y === \"function\" ? y : (y === undefined) ? pointY : constant(y);\n\n  function line(data) {\n    var i,\n        n = (data = array(data)).length,\n        d,\n        defined0 = false,\n        buffer;\n\n    if (context == null) output = curve(buffer = path());\n\n    for (i = 0; i <= n; ++i) {\n      if (!(i < n && defined(d = data[i], i, data)) === defined0) {\n        if (defined0 = !defined0) output.lineStart();\n        else output.lineEnd();\n      }\n      if (defined0) output.point(+x(d, i, data), +y(d, i, data));\n    }\n\n    if (buffer) return output = null, buffer + \"\" || null;\n  }\n\n  line.x = function(_) {\n    return arguments.length ? (x = typeof _ === \"function\" ? _ : constant(+_), line) : x;\n  };\n\n  line.y = function(_) {\n    return arguments.length ? (y = typeof _ === \"function\" ? _ : constant(+_), line) : y;\n  };\n\n  line.defined = function(_) {\n    return arguments.length ? (defined = typeof _ === \"function\" ? _ : constant(!!_), line) : defined;\n  };\n\n  line.curve = function(_) {\n    return arguments.length ? (curve = _, context != null && (output = curve(context)), line) : curve;\n  };\n\n  line.context = function(_) {\n    return arguments.length ? (_ == null ? context = output = null : output = curve(context = _), line) : context;\n  };\n\n  return line;\n}\n","import array from \"./array.js\";\nimport constant from \"./constant.js\";\nimport curveLinear from \"./curve/linear.js\";\nimport line from \"./line.js\";\nimport {withPath} from \"./path.js\";\nimport {x as pointX, y as pointY} from \"./point.js\";\n\nexport default function(x0, y0, y1) {\n  var x1 = null,\n      defined = constant(true),\n      context = null,\n      curve = curveLinear,\n      output = null,\n      path = withPath(area);\n\n  x0 = typeof x0 === \"function\" ? x0 : (x0 === undefined) ? pointX : constant(+x0);\n  y0 = typeof y0 === \"function\" ? y0 : (y0 === undefined) ? constant(0) : constant(+y0);\n  y1 = typeof y1 === \"function\" ? y1 : (y1 === undefined) ? pointY : constant(+y1);\n\n  function area(data) {\n    var i,\n        j,\n        k,\n        n = (data = array(data)).length,\n        d,\n        defined0 = false,\n        buffer,\n        x0z = new Array(n),\n        y0z = new Array(n);\n\n    if (context == null) output = curve(buffer = path());\n\n    for (i = 0; i <= n; ++i) {\n      if (!(i < n && defined(d = data[i], i, data)) === defined0) {\n        if (defined0 = !defined0) {\n          j = i;\n          output.areaStart();\n          output.lineStart();\n        } else {\n          output.lineEnd();\n          output.lineStart();\n          for (k = i - 1; k >= j; --k) {\n            output.point(x0z[k], y0z[k]);\n          }\n          output.lineEnd();\n          output.areaEnd();\n        }\n      }\n      if (defined0) {\n        x0z[i] = +x0(d, i, data), y0z[i] = +y0(d, i, data);\n        output.point(x1 ? +x1(d, i, data) : x0z[i], y1 ? +y1(d, i, data) : y0z[i]);\n      }\n    }\n\n    if (buffer) return output = null, buffer + \"\" || null;\n  }\n\n  function arealine() {\n    return line().defined(defined).curve(curve).context(context);\n  }\n\n  area.x = function(_) {\n    return arguments.length ? (x0 = typeof _ === \"function\" ? _ : constant(+_), x1 = null, area) : x0;\n  };\n\n  area.x0 = function(_) {\n    return arguments.length ? (x0 = typeof _ === \"function\" ? _ : constant(+_), area) : x0;\n  };\n\n  area.x1 = function(_) {\n    return arguments.length ? (x1 = _ == null ? null : typeof _ === \"function\" ? _ : constant(+_), area) : x1;\n  };\n\n  area.y = function(_) {\n    return arguments.length ? (y0 = typeof _ === \"function\" ? _ : constant(+_), y1 = null, area) : y0;\n  };\n\n  area.y0 = function(_) {\n    return arguments.length ? (y0 = typeof _ === \"function\" ? _ : constant(+_), area) : y0;\n  };\n\n  area.y1 = function(_) {\n    return arguments.length ? (y1 = _ == null ? null : typeof _ === \"function\" ? _ : constant(+_), area) : y1;\n  };\n\n  area.lineX0 =\n  area.lineY0 = function() {\n    return arealine().x(x0).y(y0);\n  };\n\n  area.lineY1 = function() {\n    return arealine().x(x0).y(y1);\n  };\n\n  area.lineX1 = function() {\n    return arealine().x(x1).y(y0);\n  };\n\n  area.defined = function(_) {\n    return arguments.length ? (defined = typeof _ === \"function\" ? _ : constant(!!_), area) : defined;\n  };\n\n  area.curve = function(_) {\n    return arguments.length ? (curve = _, context != null && (output = curve(context)), area) : curve;\n  };\n\n  area.context = function(_) {\n    return arguments.length ? (_ == null ? context = output = null : output = curve(context = _), area) : context;\n  };\n\n  return area;\n}\n","import {pi, sqrt, tau} from \"../math.js\";\n\nexport default {\n  draw(context, size) {\n    const r = sqrt(size / pi);\n    context.moveTo(r, 0);\n    context.arc(0, 0, r, 0, tau);\n  }\n};\n","export default function() {}\n","export function point(that, x, y) {\n  that._context.bezierCurveTo(\n    (2 * that._x0 + that._x1) / 3,\n    (2 * that._y0 + that._y1) / 3,\n    (that._x0 + 2 * that._x1) / 3,\n    (that._y0 + 2 * that._y1) / 3,\n    (that._x0 + 4 * that._x1 + x) / 6,\n    (that._y0 + 4 * that._y1 + y) / 6\n  );\n}\n\nexport function Basis(context) {\n  this._context = context;\n}\n\nBasis.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x0 = this._x1 =\n    this._y0 = this._y1 = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    switch (this._point) {\n      case 3: point(this, this._x1, this._y1); // falls through\n      case 2: this._context.lineTo(this._x1, this._y1); break;\n    }\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; break;\n      case 2: this._point = 3; this._context.lineTo((5 * this._x0 + this._x1) / 6, (5 * this._y0 + this._y1) / 6); // falls through\n      default: point(this, x, y); break;\n    }\n    this._x0 = this._x1, this._x1 = x;\n    this._y0 = this._y1, this._y1 = y;\n  }\n};\n\nexport default function(context) {\n  return new Basis(context);\n}\n","import noop from \"../noop.js\";\nimport {point} from \"./basis.js\";\n\nfunction BasisClosed(context) {\n  this._context = context;\n}\n\nBasisClosed.prototype = {\n  areaStart: noop,\n  areaEnd: noop,\n  lineStart: function() {\n    this._x0 = this._x1 = this._x2 = this._x3 = this._x4 =\n    this._y0 = this._y1 = this._y2 = this._y3 = this._y4 = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    switch (this._point) {\n      case 1: {\n        this._context.moveTo(this._x2, this._y2);\n        this._context.closePath();\n        break;\n      }\n      case 2: {\n        this._context.moveTo((this._x2 + 2 * this._x3) / 3, (this._y2 + 2 * this._y3) / 3);\n        this._context.lineTo((this._x3 + 2 * this._x2) / 3, (this._y3 + 2 * this._y2) / 3);\n        this._context.closePath();\n        break;\n      }\n      case 3: {\n        this.point(this._x2, this._y2);\n        this.point(this._x3, this._y3);\n        this.point(this._x4, this._y4);\n        break;\n      }\n    }\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; this._x2 = x, this._y2 = y; break;\n      case 1: this._point = 2; this._x3 = x, this._y3 = y; break;\n      case 2: this._point = 3; this._x4 = x, this._y4 = y; this._context.moveTo((this._x0 + 4 * this._x1 + x) / 6, (this._y0 + 4 * this._y1 + y) / 6); break;\n      default: point(this, x, y); break;\n    }\n    this._x0 = this._x1, this._x1 = x;\n    this._y0 = this._y1, this._y1 = y;\n  }\n};\n\nexport default function(context) {\n  return new BasisClosed(context);\n}\n","import {point} from \"./basis.js\";\n\nfunction BasisOpen(context) {\n  this._context = context;\n}\n\nBasisOpen.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x0 = this._x1 =\n    this._y0 = this._y1 = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    if (this._line || (this._line !== 0 && this._point === 3)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; break;\n      case 1: this._point = 2; break;\n      case 2: this._point = 3; var x0 = (this._x0 + 4 * this._x1 + x) / 6, y0 = (this._y0 + 4 * this._y1 + y) / 6; this._line ? this._context.lineTo(x0, y0) : this._context.moveTo(x0, y0); break;\n      case 3: this._point = 4; // falls through\n      default: point(this, x, y); break;\n    }\n    this._x0 = this._x1, this._x1 = x;\n    this._y0 = this._y1, this._y1 = y;\n  }\n};\n\nexport default function(context) {\n  return new BasisOpen(context);\n}\n","import {Basis} from \"./basis.js\";\n\nfunction Bundle(context, beta) {\n  this._basis = new Basis(context);\n  this._beta = beta;\n}\n\nBundle.prototype = {\n  lineStart: function() {\n    this._x = [];\n    this._y = [];\n    this._basis.lineStart();\n  },\n  lineEnd: function() {\n    var x = this._x,\n        y = this._y,\n        j = x.length - 1;\n\n    if (j > 0) {\n      var x0 = x[0],\n          y0 = y[0],\n          dx = x[j] - x0,\n          dy = y[j] - y0,\n          i = -1,\n          t;\n\n      while (++i <= j) {\n        t = i / j;\n        this._basis.point(\n          this._beta * x[i] + (1 - this._beta) * (x0 + t * dx),\n          this._beta * y[i] + (1 - this._beta) * (y0 + t * dy)\n        );\n      }\n    }\n\n    this._x = this._y = null;\n    this._basis.lineEnd();\n  },\n  point: function(x, y) {\n    this._x.push(+x);\n    this._y.push(+y);\n  }\n};\n\nexport default (function custom(beta) {\n\n  function bundle(context) {\n    return beta === 1 ? new Basis(context) : new Bundle(context, beta);\n  }\n\n  bundle.beta = function(beta) {\n    return custom(+beta);\n  };\n\n  return bundle;\n})(0.85);\n","export function point(that, x, y) {\n  that._context.bezierCurveTo(\n    that._x1 + that._k * (that._x2 - that._x0),\n    that._y1 + that._k * (that._y2 - that._y0),\n    that._x2 + that._k * (that._x1 - x),\n    that._y2 + that._k * (that._y1 - y),\n    that._x2,\n    that._y2\n  );\n}\n\nexport function Cardinal(context, tension) {\n  this._context = context;\n  this._k = (1 - tension) / 6;\n}\n\nCardinal.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x0 = this._x1 = this._x2 =\n    this._y0 = this._y1 = this._y2 = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    switch (this._point) {\n      case 2: this._context.lineTo(this._x2, this._y2); break;\n      case 3: point(this, this._x1, this._y1); break;\n    }\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; this._x1 = x, this._y1 = y; break;\n      case 2: this._point = 3; // falls through\n      default: point(this, x, y); break;\n    }\n    this._x0 = this._x1, this._x1 = this._x2, this._x2 = x;\n    this._y0 = this._y1, this._y1 = this._y2, this._y2 = y;\n  }\n};\n\nexport default (function custom(tension) {\n\n  function cardinal(context) {\n    return new Cardinal(context, tension);\n  }\n\n  cardinal.tension = function(tension) {\n    return custom(+tension);\n  };\n\n  return cardinal;\n})(0);\n","import noop from \"../noop.js\";\nimport {point} from \"./cardinal.js\";\n\nexport function CardinalClosed(context, tension) {\n  this._context = context;\n  this._k = (1 - tension) / 6;\n}\n\nCardinalClosed.prototype = {\n  areaStart: noop,\n  areaEnd: noop,\n  lineStart: function() {\n    this._x0 = this._x1 = this._x2 = this._x3 = this._x4 = this._x5 =\n    this._y0 = this._y1 = this._y2 = this._y3 = this._y4 = this._y5 = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    switch (this._point) {\n      case 1: {\n        this._context.moveTo(this._x3, this._y3);\n        this._context.closePath();\n        break;\n      }\n      case 2: {\n        this._context.lineTo(this._x3, this._y3);\n        this._context.closePath();\n        break;\n      }\n      case 3: {\n        this.point(this._x3, this._y3);\n        this.point(this._x4, this._y4);\n        this.point(this._x5, this._y5);\n        break;\n      }\n    }\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; this._x3 = x, this._y3 = y; break;\n      case 1: this._point = 2; this._context.moveTo(this._x4 = x, this._y4 = y); break;\n      case 2: this._point = 3; this._x5 = x, this._y5 = y; break;\n      default: point(this, x, y); break;\n    }\n    this._x0 = this._x1, this._x1 = this._x2, this._x2 = x;\n    this._y0 = this._y1, this._y1 = this._y2, this._y2 = y;\n  }\n};\n\nexport default (function custom(tension) {\n\n  function cardinal(context) {\n    return new CardinalClosed(context, tension);\n  }\n\n  cardinal.tension = function(tension) {\n    return custom(+tension);\n  };\n\n  return cardinal;\n})(0);\n","import {point} from \"./cardinal.js\";\n\nexport function CardinalOpen(context, tension) {\n  this._context = context;\n  this._k = (1 - tension) / 6;\n}\n\nCardinalOpen.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x0 = this._x1 = this._x2 =\n    this._y0 = this._y1 = this._y2 = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    if (this._line || (this._line !== 0 && this._point === 3)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; break;\n      case 1: this._point = 2; break;\n      case 2: this._point = 3; this._line ? this._context.lineTo(this._x2, this._y2) : this._context.moveTo(this._x2, this._y2); break;\n      case 3: this._point = 4; // falls through\n      default: point(this, x, y); break;\n    }\n    this._x0 = this._x1, this._x1 = this._x2, this._x2 = x;\n    this._y0 = this._y1, this._y1 = this._y2, this._y2 = y;\n  }\n};\n\nexport default (function custom(tension) {\n\n  function cardinal(context) {\n    return new CardinalOpen(context, tension);\n  }\n\n  cardinal.tension = function(tension) {\n    return custom(+tension);\n  };\n\n  return cardinal;\n})(0);\n","import {epsilon} from \"../math.js\";\nimport {Cardinal} from \"./cardinal.js\";\n\nexport function point(that, x, y) {\n  var x1 = that._x1,\n      y1 = that._y1,\n      x2 = that._x2,\n      y2 = that._y2;\n\n  if (that._l01_a > epsilon) {\n    var a = 2 * that._l01_2a + 3 * that._l01_a * that._l12_a + that._l12_2a,\n        n = 3 * that._l01_a * (that._l01_a + that._l12_a);\n    x1 = (x1 * a - that._x0 * that._l12_2a + that._x2 * that._l01_2a) / n;\n    y1 = (y1 * a - that._y0 * that._l12_2a + that._y2 * that._l01_2a) / n;\n  }\n\n  if (that._l23_a > epsilon) {\n    var b = 2 * that._l23_2a + 3 * that._l23_a * that._l12_a + that._l12_2a,\n        m = 3 * that._l23_a * (that._l23_a + that._l12_a);\n    x2 = (x2 * b + that._x1 * that._l23_2a - x * that._l12_2a) / m;\n    y2 = (y2 * b + that._y1 * that._l23_2a - y * that._l12_2a) / m;\n  }\n\n  that._context.bezierCurveTo(x1, y1, x2, y2, that._x2, that._y2);\n}\n\nfunction CatmullRom(context, alpha) {\n  this._context = context;\n  this._alpha = alpha;\n}\n\nCatmullRom.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x0 = this._x1 = this._x2 =\n    this._y0 = this._y1 = this._y2 = NaN;\n    this._l01_a = this._l12_a = this._l23_a =\n    this._l01_2a = this._l12_2a = this._l23_2a =\n    this._point = 0;\n  },\n  lineEnd: function() {\n    switch (this._point) {\n      case 2: this._context.lineTo(this._x2, this._y2); break;\n      case 3: this.point(this._x2, this._y2); break;\n    }\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n\n    if (this._point) {\n      var x23 = this._x2 - x,\n          y23 = this._y2 - y;\n      this._l23_a = Math.sqrt(this._l23_2a = Math.pow(x23 * x23 + y23 * y23, this._alpha));\n    }\n\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; break;\n      case 2: this._point = 3; // falls through\n      default: point(this, x, y); break;\n    }\n\n    this._l01_a = this._l12_a, this._l12_a = this._l23_a;\n    this._l01_2a = this._l12_2a, this._l12_2a = this._l23_2a;\n    this._x0 = this._x1, this._x1 = this._x2, this._x2 = x;\n    this._y0 = this._y1, this._y1 = this._y2, this._y2 = y;\n  }\n};\n\nexport default (function custom(alpha) {\n\n  function catmullRom(context) {\n    return alpha ? new CatmullRom(context, alpha) : new Cardinal(context, 0);\n  }\n\n  catmullRom.alpha = function(alpha) {\n    return custom(+alpha);\n  };\n\n  return catmullRom;\n})(0.5);\n","import {CardinalClosed} from \"./cardinalClosed.js\";\nimport noop from \"../noop.js\";\nimport {point} from \"./catmullRom.js\";\n\nfunction CatmullRomClosed(context, alpha) {\n  this._context = context;\n  this._alpha = alpha;\n}\n\nCatmullRomClosed.prototype = {\n  areaStart: noop,\n  areaEnd: noop,\n  lineStart: function() {\n    this._x0 = this._x1 = this._x2 = this._x3 = this._x4 = this._x5 =\n    this._y0 = this._y1 = this._y2 = this._y3 = this._y4 = this._y5 = NaN;\n    this._l01_a = this._l12_a = this._l23_a =\n    this._l01_2a = this._l12_2a = this._l23_2a =\n    this._point = 0;\n  },\n  lineEnd: function() {\n    switch (this._point) {\n      case 1: {\n        this._context.moveTo(this._x3, this._y3);\n        this._context.closePath();\n        break;\n      }\n      case 2: {\n        this._context.lineTo(this._x3, this._y3);\n        this._context.closePath();\n        break;\n      }\n      case 3: {\n        this.point(this._x3, this._y3);\n        this.point(this._x4, this._y4);\n        this.point(this._x5, this._y5);\n        break;\n      }\n    }\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n\n    if (this._point) {\n      var x23 = this._x2 - x,\n          y23 = this._y2 - y;\n      this._l23_a = Math.sqrt(this._l23_2a = Math.pow(x23 * x23 + y23 * y23, this._alpha));\n    }\n\n    switch (this._point) {\n      case 0: this._point = 1; this._x3 = x, this._y3 = y; break;\n      case 1: this._point = 2; this._context.moveTo(this._x4 = x, this._y4 = y); break;\n      case 2: this._point = 3; this._x5 = x, this._y5 = y; break;\n      default: point(this, x, y); break;\n    }\n\n    this._l01_a = this._l12_a, this._l12_a = this._l23_a;\n    this._l01_2a = this._l12_2a, this._l12_2a = this._l23_2a;\n    this._x0 = this._x1, this._x1 = this._x2, this._x2 = x;\n    this._y0 = this._y1, this._y1 = this._y2, this._y2 = y;\n  }\n};\n\nexport default (function custom(alpha) {\n\n  function catmullRom(context) {\n    return alpha ? new CatmullRomClosed(context, alpha) : new CardinalClosed(context, 0);\n  }\n\n  catmullRom.alpha = function(alpha) {\n    return custom(+alpha);\n  };\n\n  return catmullRom;\n})(0.5);\n","import {CardinalOpen} from \"./cardinalOpen.js\";\nimport {point} from \"./catmullRom.js\";\n\nfunction CatmullRomOpen(context, alpha) {\n  this._context = context;\n  this._alpha = alpha;\n}\n\nCatmullRomOpen.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x0 = this._x1 = this._x2 =\n    this._y0 = this._y1 = this._y2 = NaN;\n    this._l01_a = this._l12_a = this._l23_a =\n    this._l01_2a = this._l12_2a = this._l23_2a =\n    this._point = 0;\n  },\n  lineEnd: function() {\n    if (this._line || (this._line !== 0 && this._point === 3)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n\n    if (this._point) {\n      var x23 = this._x2 - x,\n          y23 = this._y2 - y;\n      this._l23_a = Math.sqrt(this._l23_2a = Math.pow(x23 * x23 + y23 * y23, this._alpha));\n    }\n\n    switch (this._point) {\n      case 0: this._point = 1; break;\n      case 1: this._point = 2; break;\n      case 2: this._point = 3; this._line ? this._context.lineTo(this._x2, this._y2) : this._context.moveTo(this._x2, this._y2); break;\n      case 3: this._point = 4; // falls through\n      default: point(this, x, y); break;\n    }\n\n    this._l01_a = this._l12_a, this._l12_a = this._l23_a;\n    this._l01_2a = this._l12_2a, this._l12_2a = this._l23_2a;\n    this._x0 = this._x1, this._x1 = this._x2, this._x2 = x;\n    this._y0 = this._y1, this._y1 = this._y2, this._y2 = y;\n  }\n};\n\nexport default (function custom(alpha) {\n\n  function catmullRom(context) {\n    return alpha ? new CatmullRomOpen(context, alpha) : new CardinalOpen(context, 0);\n  }\n\n  catmullRom.alpha = function(alpha) {\n    return custom(+alpha);\n  };\n\n  return catmullRom;\n})(0.5);\n","import noop from \"../noop.js\";\n\nfunction LinearClosed(context) {\n  this._context = context;\n}\n\nLinearClosed.prototype = {\n  areaStart: noop,\n  areaEnd: noop,\n  lineStart: function() {\n    this._point = 0;\n  },\n  lineEnd: function() {\n    if (this._point) this._context.closePath();\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    if (this._point) this._context.lineTo(x, y);\n    else this._point = 1, this._context.moveTo(x, y);\n  }\n};\n\nexport default function(context) {\n  return new LinearClosed(context);\n}\n","function sign(x) {\n  return x < 0 ? -1 : 1;\n}\n\n// Calculate the slopes of the tangents (Hermite-type interpolation) based on\n// the following paper: Steffen, M. 1990. A Simple Method for Monotonic\n// Interpolation in One Dimension. Astronomy and Astrophysics, Vol. 239, NO.\n// NOV(II), P. 443, 1990.\nfunction slope3(that, x2, y2) {\n  var h0 = that._x1 - that._x0,\n      h1 = x2 - that._x1,\n      s0 = (that._y1 - that._y0) / (h0 || h1 < 0 && -0),\n      s1 = (y2 - that._y1) / (h1 || h0 < 0 && -0),\n      p = (s0 * h1 + s1 * h0) / (h0 + h1);\n  return (sign(s0) + sign(s1)) * Math.min(Math.abs(s0), Math.abs(s1), 0.5 * Math.abs(p)) || 0;\n}\n\n// Calculate a one-sided slope.\nfunction slope2(that, t) {\n  var h = that._x1 - that._x0;\n  return h ? (3 * (that._y1 - that._y0) / h - t) / 2 : t;\n}\n\n// According to https://en.wikipedia.org/wiki/Cubic_Hermite_spline#Representations\n// \"you can express cubic Hermite interpolation in terms of cubic BÃ©zier curves\n// with respect to the four values p0, p0 + m0 / 3, p1 - m1 / 3, p1\".\nfunction point(that, t0, t1) {\n  var x0 = that._x0,\n      y0 = that._y0,\n      x1 = that._x1,\n      y1 = that._y1,\n      dx = (x1 - x0) / 3;\n  that._context.bezierCurveTo(x0 + dx, y0 + dx * t0, x1 - dx, y1 - dx * t1, x1, y1);\n}\n\nfunction MonotoneX(context) {\n  this._context = context;\n}\n\nMonotoneX.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x0 = this._x1 =\n    this._y0 = this._y1 =\n    this._t0 = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    switch (this._point) {\n      case 2: this._context.lineTo(this._x1, this._y1); break;\n      case 3: point(this, this._t0, slope2(this, this._t0)); break;\n    }\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    var t1 = NaN;\n\n    x = +x, y = +y;\n    if (x === this._x1 && y === this._y1) return; // Ignore coincident points.\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; break;\n      case 2: this._point = 3; point(this, slope2(this, t1 = slope3(this, x, y)), t1); break;\n      default: point(this, this._t0, t1 = slope3(this, x, y)); break;\n    }\n\n    this._x0 = this._x1, this._x1 = x;\n    this._y0 = this._y1, this._y1 = y;\n    this._t0 = t1;\n  }\n}\n\nfunction MonotoneY(context) {\n  this._context = new ReflectContext(context);\n}\n\n(MonotoneY.prototype = Object.create(MonotoneX.prototype)).point = function(x, y) {\n  MonotoneX.prototype.point.call(this, y, x);\n};\n\nfunction ReflectContext(context) {\n  this._context = context;\n}\n\nReflectContext.prototype = {\n  moveTo: function(x, y) { this._context.moveTo(y, x); },\n  closePath: function() { this._context.closePath(); },\n  lineTo: function(x, y) { this._context.lineTo(y, x); },\n  bezierCurveTo: function(x1, y1, x2, y2, x, y) { this._context.bezierCurveTo(y1, x1, y2, x2, y, x); }\n};\n\nexport function monotoneX(context) {\n  return new MonotoneX(context);\n}\n\nexport function monotoneY(context) {\n  return new MonotoneY(context);\n}\n","function Natural(context) {\n  this._context = context;\n}\n\nNatural.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x = [];\n    this._y = [];\n  },\n  lineEnd: function() {\n    var x = this._x,\n        y = this._y,\n        n = x.length;\n\n    if (n) {\n      this._line ? this._context.lineTo(x[0], y[0]) : this._context.moveTo(x[0], y[0]);\n      if (n === 2) {\n        this._context.lineTo(x[1], y[1]);\n      } else {\n        var px = controlPoints(x),\n            py = controlPoints(y);\n        for (var i0 = 0, i1 = 1; i1 < n; ++i0, ++i1) {\n          this._context.bezierCurveTo(px[0][i0], py[0][i0], px[1][i0], py[1][i0], x[i1], y[i1]);\n        }\n      }\n    }\n\n    if (this._line || (this._line !== 0 && n === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n    this._x = this._y = null;\n  },\n  point: function(x, y) {\n    this._x.push(+x);\n    this._y.push(+y);\n  }\n};\n\n// See https://www.particleincell.com/2012/bezier-splines/ for derivation.\nfunction controlPoints(x) {\n  var i,\n      n = x.length - 1,\n      m,\n      a = new Array(n),\n      b = new Array(n),\n      r = new Array(n);\n  a[0] = 0, b[0] = 2, r[0] = x[0] + 2 * x[1];\n  for (i = 1; i < n - 1; ++i) a[i] = 1, b[i] = 4, r[i] = 4 * x[i] + 2 * x[i + 1];\n  a[n - 1] = 2, b[n - 1] = 7, r[n - 1] = 8 * x[n - 1] + x[n];\n  for (i = 1; i < n; ++i) m = a[i] / b[i - 1], b[i] -= m, r[i] -= m * r[i - 1];\n  a[n - 1] = r[n - 1] / b[n - 1];\n  for (i = n - 2; i >= 0; --i) a[i] = (r[i] - a[i + 1]) / b[i];\n  b[n - 1] = (x[n] + a[n - 1]) / 2;\n  for (i = 0; i < n - 1; ++i) b[i] = 2 * x[i + 1] - a[i + 1];\n  return [a, b];\n}\n\nexport default function(context) {\n  return new Natural(context);\n}\n","function Step(context, t) {\n  this._context = context;\n  this._t = t;\n}\n\nStep.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x = this._y = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    if (0 < this._t && this._t < 1 && this._point === 2) this._context.lineTo(this._x, this._y);\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    if (this._line >= 0) this._t = 1 - this._t, this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; // falls through\n      default: {\n        if (this._t <= 0) {\n          this._context.lineTo(this._x, y);\n          this._context.lineTo(x, y);\n        } else {\n          var x1 = this._x * (1 - this._t) + x * this._t;\n          this._context.lineTo(x1, this._y);\n          this._context.lineTo(x1, y);\n        }\n        break;\n      }\n    }\n    this._x = x, this._y = y;\n  }\n};\n\nexport default function(context) {\n  return new Step(context, 0.5);\n}\n\nexport function stepBefore(context) {\n  return new Step(context, 0);\n}\n\nexport function stepAfter(context) {\n  return new Step(context, 1);\n}\n","import {hasOwnProperty} from 'vega-util';\n\nimport {\n  curveBasis,\n  curveBasisClosed,\n  curveBasisOpen,\n  curveBundle,\n  curveCardinal,\n  curveCardinalClosed,\n  curveCardinalOpen,\n  curveCatmullRom,\n  curveCatmullRomClosed,\n  curveCatmullRomOpen,\n  curveLinear,\n  curveLinearClosed,\n  curveMonotoneX,\n  curveMonotoneY,\n  curveNatural,\n  curveStep,\n  curveStepAfter,\n  curveStepBefore\n} from 'd3-shape';\n\nconst lookup = {\n  'basis': {\n    curve: curveBasis\n  },\n  'basis-closed': {\n    curve: curveBasisClosed\n  },\n  'basis-open': {\n    curve: curveBasisOpen\n  },\n  'bundle': {\n    curve: curveBundle,\n    tension: 'beta',\n    value: 0.85\n  },\n  'cardinal': {\n    curve: curveCardinal,\n    tension: 'tension',\n    value: 0\n  },\n  'cardinal-open': {\n    curve: curveCardinalOpen,\n    tension: 'tension',\n    value: 0\n  },\n  'cardinal-closed': {\n    curve: curveCardinalClosed,\n    tension: 'tension',\n    value: 0\n  },\n  'catmull-rom': {\n    curve: curveCatmullRom,\n    tension: 'alpha',\n    value: 0.5\n  },\n  'catmull-rom-closed': {\n    curve: curveCatmullRomClosed,\n    tension: 'alpha',\n    value: 0.5\n  },\n  'catmull-rom-open': {\n    curve: curveCatmullRomOpen,\n    tension: 'alpha',\n    value: 0.5\n  },\n  'linear': {\n    curve: curveLinear\n  },\n  'linear-closed': {\n    curve: curveLinearClosed\n  },\n  'monotone': {\n    horizontal: curveMonotoneY,\n    vertical:   curveMonotoneX\n  },\n  'natural': {\n    curve: curveNatural\n  },\n  'step': {\n    curve: curveStep\n  },\n  'step-after': {\n    curve: curveStepAfter\n  },\n  'step-before': {\n    curve: curveStepBefore\n  }\n};\n\nexport default function curves(type, orientation, tension) {\n  var entry = hasOwnProperty(lookup, type) && lookup[type],\n      curve = null;\n\n  if (entry) {\n    curve = entry.curve || entry[orientation || 'vertical'];\n    if (entry.tension && tension != null) {\n      curve = curve[entry.tension](tension);\n    }\n  }\n\n  return curve;\n}\n","const paramCounts = { m:2, l:2, h:1, v:1, z:0, c:6, s:4, q:4, t:2, a:7 };\nconst commandPattern = /[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi;\nconst numberPattern = /^[+-]?(([0-9]*\\.[0-9]+)|([0-9]+\\.)|([0-9]+))([eE][+-]?[0-9]+)?/;\nconst spacePattern = /^((\\s+,?\\s*)|(,\\s*))/;\nconst flagPattern = /^[01]/;\n\nexport default function parse(path) {\n  const commands = [];\n  const matches = path.match(commandPattern) || [];\n\n  matches.forEach(str => {\n    let cmd = str[0];\n    const type = cmd.toLowerCase();\n\n    // parse parameters\n    const paramCount = paramCounts[type];\n    const params = parseParams(type, paramCount, str.slice(1).trim());\n    const count = params.length;\n\n    // error checking based on parameter count\n    if (count < paramCount || (count && count % paramCount !== 0)) {\n      throw Error('Invalid SVG path, incorrect parameter count');\n    }\n\n    // register the command\n    commands.push([cmd, ...params.slice(0, paramCount)]);\n\n    // exit now if we're done, also handles zero-param 'z'\n    if (count === paramCount) {\n      return;\n    }\n\n    // handle implicit line-to\n    if (type === 'm') {\n      cmd = (cmd === 'M') ? 'L' : 'l';\n    }\n\n    // repeat command when given extended param list\n    for (let i = paramCount; i < count; i += paramCount) {\n      commands.push([cmd, ...params.slice(i, i + paramCount)]);\n    }\n  });\n\n  return commands;\n}\n\nfunction parseParams(type, paramCount, segment) {\n  const params = [];\n\n  for (let index = 0; paramCount && index < segment.length; ) {\n    for (let i = 0; i < paramCount; ++i) {\n      const pattern = type === 'a' && (i === 3 || i === 4) ? flagPattern : numberPattern;\n      const match = segment.slice(index).match(pattern);\n\n      if (match === null) {\n        throw Error('Invalid SVG path, incorrect parameter type');\n      }\n\n      index += match[0].length;\n      params.push(+match[0]);\n\n      const ws = segment.slice(index).match(spacePattern);\n      if (ws !== null) {\n        index += ws[0].length;\n      }\n    }\n  }\n\n  return params;\n}\n","export const DegToRad = Math.PI / 180;\nexport const Epsilon = 1e-14;\nexport const HalfPi = Math.PI / 2;\nexport const Tau = Math.PI * 2;\nexport const HalfSqrt3 = Math.sqrt(3) / 2;\n","import {DegToRad, HalfPi, Tau} from '../util/constants';\n\nexport var segmentCache = {};\nexport var bezierCache = {};\n\nvar join = [].join;\n\n// Copied from Inkscape svgtopdf, thanks!\nexport function segments(x, y, rx, ry, large, sweep, rotateX, ox, oy) {\n  const key = join.call(arguments);\n  if (segmentCache[key]) {\n    return segmentCache[key];\n  }\n\n  const th = rotateX * DegToRad;\n  const sin_th = Math.sin(th);\n  const cos_th = Math.cos(th);\n  rx = Math.abs(rx);\n  ry = Math.abs(ry);\n  const px = cos_th * (ox - x) * 0.5 + sin_th * (oy - y) * 0.5;\n  const py = cos_th * (oy - y) * 0.5 - sin_th * (ox - x) * 0.5;\n  let pl = (px*px) / (rx*rx) + (py*py) / (ry*ry);\n  if (pl > 1) {\n    pl = Math.sqrt(pl);\n    rx *= pl;\n    ry *= pl;\n  }\n\n  const a00 = cos_th / rx;\n  const a01 = sin_th / rx;\n  const a10 = (-sin_th) / ry;\n  const a11 = (cos_th) / ry;\n  const x0 = a00 * ox + a01 * oy;\n  const y0 = a10 * ox + a11 * oy;\n  const x1 = a00 * x + a01 * y;\n  const y1 = a10 * x + a11 * y;\n\n  const d = (x1-x0) * (x1-x0) + (y1-y0) * (y1-y0);\n  let sfactor_sq = 1 / d - 0.25;\n  if (sfactor_sq < 0) sfactor_sq = 0;\n  let sfactor = Math.sqrt(sfactor_sq);\n  if (sweep == large) sfactor = -sfactor;\n  const xc = 0.5 * (x0 + x1) - sfactor * (y1-y0);\n  const yc = 0.5 * (y0 + y1) + sfactor * (x1-x0);\n\n  const th0 = Math.atan2(y0-yc, x0-xc);\n  const th1 = Math.atan2(y1-yc, x1-xc);\n\n  let th_arc = th1-th0;\n  if (th_arc < 0 && sweep === 1) {\n    th_arc += Tau;\n  } else if (th_arc > 0 && sweep === 0) {\n    th_arc -= Tau;\n  }\n\n  const segs = Math.ceil(Math.abs(th_arc / (HalfPi + 0.001)));\n  const result = [];\n  for (let i=0; i<segs; ++i) {\n    const th2 = th0 + i * th_arc / segs;\n    const th3 = th0 + (i+1) * th_arc / segs;\n    result[i] = [xc, yc, th2, th3, rx, ry, sin_th, cos_th];\n  }\n\n  return (segmentCache[key] = result);\n}\n\nexport function bezier(params) {\n  const key = join.call(params);\n  if (bezierCache[key]) {\n    return bezierCache[key];\n  }\n\n  var cx = params[0],\n      cy = params[1],\n      th0 = params[2],\n      th1 = params[3],\n      rx = params[4],\n      ry = params[5],\n      sin_th = params[6],\n      cos_th = params[7];\n\n  const a00 = cos_th * rx;\n  const a01 = -sin_th * ry;\n  const a10 = sin_th * rx;\n  const a11 = cos_th * ry;\n\n  const cos_th0 = Math.cos(th0);\n  const sin_th0 = Math.sin(th0);\n  const cos_th1 = Math.cos(th1);\n  const sin_th1 = Math.sin(th1);\n\n  const th_half = 0.5 * (th1 - th0);\n  const sin_th_h2 = Math.sin(th_half * 0.5);\n  const t = (8/3) * sin_th_h2 * sin_th_h2 / Math.sin(th_half);\n  const x1 = cx + cos_th0 - t * sin_th0;\n  const y1 = cy + sin_th0 + t * cos_th0;\n  const x3 = cx + cos_th1;\n  const y3 = cy + sin_th1;\n  const x2 = x3 + t * sin_th1;\n  const y2 = y3 - t * cos_th1;\n\n  return (bezierCache[key] = [\n    a00 * x1 + a01 * y1,  a10 * x1 + a11 * y1,\n    a00 * x2 + a01 * y2,  a10 * x2 + a11 * y2,\n    a00 * x3 + a01 * y3,  a10 * x3 + a11 * y3\n  ]);\n}\n","import {bezier, segments} from './arc';\n\nconst temp = ['l', 0, 0, 0, 0, 0, 0, 0];\n\nfunction scale(current, sX, sY) {\n  const c = (temp[0] = current[0]);\n  if (c === 'a' || c === 'A') {\n    temp[1] = sX * current[1];\n    temp[2] = sY * current[2];\n    temp[3] = current[3];\n    temp[4] = current[4];\n    temp[5] = current[5];\n    temp[6] = sX * current[6];\n    temp[7] = sY * current[7];\n  } else if (c === 'h' || c === 'H') {\n    temp[1] = sX * current[1];\n  } else if (c === 'v' || c === 'V') {\n    temp[1] = sY * current[1];\n  } else {\n    for (var i=1, n=current.length; i<n; ++i) {\n      temp[i] = (i % 2 == 1 ? sX : sY) * current[i];\n    }\n  }\n  return temp;\n}\n\nexport default function(context, path, l, t, sX, sY) {\n  var current, // current instruction\n      previous = null,\n      x = 0, // current x\n      y = 0, // current y\n      controlX = 0, // current control point x\n      controlY = 0, // current control point y\n      tempX,\n      tempY,\n      tempControlX,\n      tempControlY,\n      anchorX = 0,\n      anchorY = 0;\n\n  if (l == null) l = 0;\n  if (t == null) t = 0;\n  if (sX == null) sX = 1;\n  if (sY == null) sY = sX;\n\n  if (context.beginPath) context.beginPath();\n\n  for (var i=0, len=path.length; i<len; ++i) {\n    current = path[i];\n    if (sX !== 1 || sY !== 1) {\n      current = scale(current, sX, sY);\n    }\n\n    switch (current[0]) { // first letter\n\n      case 'l': // lineto, relative\n        x += current[1];\n        y += current[2];\n        context.lineTo(x + l, y + t);\n        break;\n\n      case 'L': // lineto, absolute\n        x = current[1];\n        y = current[2];\n        context.lineTo(x + l, y + t);\n        break;\n\n      case 'h': // horizontal lineto, relative\n        x += current[1];\n        context.lineTo(x + l, y + t);\n        break;\n\n      case 'H': // horizontal lineto, absolute\n        x = current[1];\n        context.lineTo(x + l, y + t);\n        break;\n\n      case 'v': // vertical lineto, relative\n        y += current[1];\n        context.lineTo(x + l, y + t);\n        break;\n\n      case 'V': // verical lineto, absolute\n        y = current[1];\n        context.lineTo(x + l, y + t);\n        break;\n\n      case 'm': // moveTo, relative\n        x += current[1];\n        y += current[2];\n        anchorX = x;\n        anchorY = y;\n        context.moveTo(x + l, y + t);\n        break;\n\n      case 'M': // moveTo, absolute\n        x = current[1];\n        y = current[2];\n        anchorX = x;\n        anchorY = y;\n        context.moveTo(x + l, y + t);\n        break;\n\n      case 'c': // bezierCurveTo, relative\n        tempX = x + current[5];\n        tempY = y + current[6];\n        controlX = x + current[3];\n        controlY = y + current[4];\n        context.bezierCurveTo(\n          x + current[1] + l, // x1\n          y + current[2] + t, // y1\n          controlX + l, // x2\n          controlY + t, // y2\n          tempX + l,\n          tempY + t\n        );\n        x = tempX;\n        y = tempY;\n        break;\n\n      case 'C': // bezierCurveTo, absolute\n        x = current[5];\n        y = current[6];\n        controlX = current[3];\n        controlY = current[4];\n        context.bezierCurveTo(\n          current[1] + l,\n          current[2] + t,\n          controlX + l,\n          controlY + t,\n          x + l,\n          y + t\n        );\n        break;\n\n      case 's': // shorthand cubic bezierCurveTo, relative\n        // transform to absolute x,y\n        tempX = x + current[3];\n        tempY = y + current[4];\n        // calculate reflection of previous control points\n        controlX = 2 * x - controlX;\n        controlY = 2 * y - controlY;\n        context.bezierCurveTo(\n          controlX + l,\n          controlY + t,\n          x + current[1] + l,\n          y + current[2] + t,\n          tempX + l,\n          tempY + t\n        );\n\n        // set control point to 2nd one of this command\n        // the first control point is assumed to be the reflection of\n        // the second control point on the previous command relative\n        // to the current point.\n        controlX = x + current[1];\n        controlY = y + current[2];\n\n        x = tempX;\n        y = tempY;\n        break;\n\n      case 'S': // shorthand cubic bezierCurveTo, absolute\n        tempX = current[3];\n        tempY = current[4];\n        // calculate reflection of previous control points\n        controlX = 2*x - controlX;\n        controlY = 2*y - controlY;\n        context.bezierCurveTo(\n          controlX + l,\n          controlY + t,\n          current[1] + l,\n          current[2] + t,\n          tempX + l,\n          tempY + t\n        );\n        x = tempX;\n        y = tempY;\n        // set control point to 2nd one of this command\n        // the first control point is assumed to be the reflection of\n        // the second control point on the previous command relative\n        // to the current point.\n        controlX = current[1];\n        controlY = current[2];\n\n        break;\n\n      case 'q': // quadraticCurveTo, relative\n        // transform to absolute x,y\n        tempX = x + current[3];\n        tempY = y + current[4];\n\n        controlX = x + current[1];\n        controlY = y + current[2];\n\n        context.quadraticCurveTo(\n          controlX + l,\n          controlY + t,\n          tempX + l,\n          tempY + t\n        );\n        x = tempX;\n        y = tempY;\n        break;\n\n      case 'Q': // quadraticCurveTo, absolute\n        tempX = current[3];\n        tempY = current[4];\n\n        context.quadraticCurveTo(\n          current[1] + l,\n          current[2] + t,\n          tempX + l,\n          tempY + t\n        );\n        x = tempX;\n        y = tempY;\n        controlX = current[1];\n        controlY = current[2];\n        break;\n\n      case 't': // shorthand quadraticCurveTo, relative\n\n        // transform to absolute x,y\n        tempX = x + current[1];\n        tempY = y + current[2];\n\n        if (previous[0].match(/[QqTt]/) === null) {\n          // If there is no previous command or if the previous command was not a Q, q, T or t,\n          // assume the control point is coincident with the current point\n          controlX = x;\n          controlY = y;\n        }\n        else if (previous[0] === 't') {\n          // calculate reflection of previous control points for t\n          controlX = 2 * x - tempControlX;\n          controlY = 2 * y - tempControlY;\n        }\n        else if (previous[0] === 'q') {\n          // calculate reflection of previous control points for q\n          controlX = 2 * x - controlX;\n          controlY = 2 * y - controlY;\n        }\n\n        tempControlX = controlX;\n        tempControlY = controlY;\n\n        context.quadraticCurveTo(\n          controlX + l,\n          controlY + t,\n          tempX + l,\n          tempY + t\n        );\n        x = tempX;\n        y = tempY;\n        controlX = x + current[1];\n        controlY = y + current[2];\n        break;\n\n      case 'T':\n        tempX = current[1];\n        tempY = current[2];\n\n        // calculate reflection of previous control points\n        controlX = 2 * x - controlX;\n        controlY = 2 * y - controlY;\n        context.quadraticCurveTo(\n          controlX + l,\n          controlY + t,\n          tempX + l,\n          tempY + t\n        );\n        x = tempX;\n        y = tempY;\n        break;\n\n      case 'a':\n        drawArc(context, x + l, y + t, [\n          current[1],\n          current[2],\n          current[3],\n          current[4],\n          current[5],\n          current[6] + x + l,\n          current[7] + y + t\n        ]);\n        x += current[6];\n        y += current[7];\n        break;\n\n      case 'A':\n        drawArc(context, x + l, y + t, [\n          current[1],\n          current[2],\n          current[3],\n          current[4],\n          current[5],\n          current[6] + l,\n          current[7] + t\n        ]);\n        x = current[6];\n        y = current[7];\n        break;\n\n      case 'z':\n      case 'Z':\n        x = anchorX;\n        y = anchorY;\n        context.closePath();\n        break;\n    }\n    previous = current;\n  }\n}\n\nfunction drawArc(context, x, y, coords) {\n  const seg = segments(\n    coords[5], // end x\n    coords[6], // end y\n    coords[0], // radius x\n    coords[1], // radius y\n    coords[3], // large flag\n    coords[4], // sweep flag\n    coords[2], // rotation\n    x, y\n  );\n  for (let i=0; i<seg.length; ++i) {\n    const bez = bezier(seg[i]);\n    context.bezierCurveTo(bez[0], bez[1], bez[2], bez[3], bez[4], bez[5]);\n  }\n}\n","import pathParse from './parse';\nimport pathRender from './render';\nimport {HalfSqrt3, Tau} from '../util/constants';\nimport {hasOwnProperty} from 'vega-util';\n\nconst Tan30 = 0.5773502691896257;\n\nconst builtins = {\n  'circle': {\n    draw: function(context, size) {\n      const r = Math.sqrt(size) / 2;\n      context.moveTo(r, 0);\n      context.arc(0, 0, r, 0, Tau);\n    }\n  },\n  'cross': {\n    draw: function(context, size) {\n      var r = Math.sqrt(size) / 2,\n          s = r / 2.5;\n      context.moveTo(-r, -s);\n      context.lineTo(-r, s);\n      context.lineTo(-s, s);\n      context.lineTo(-s, r);\n      context.lineTo(s, r);\n      context.lineTo(s, s);\n      context.lineTo(r, s);\n      context.lineTo(r, -s);\n      context.lineTo(s, -s);\n      context.lineTo(s, -r);\n      context.lineTo(-s, -r);\n      context.lineTo(-s, -s);\n      context.closePath();\n    }\n  },\n  'diamond': {\n    draw: function(context, size) {\n      const r = Math.sqrt(size) / 2;\n      context.moveTo(-r, 0);\n      context.lineTo(0, -r);\n      context.lineTo(r, 0);\n      context.lineTo(0, r);\n      context.closePath();\n    }\n  },\n  'square': {\n    draw: function(context, size) {\n      var w = Math.sqrt(size),\n          x = -w / 2;\n      context.rect(x, x, w, w);\n    }\n  },\n  'arrow': {\n    draw: function(context, size) {\n      var r = Math.sqrt(size) / 2,\n          s = r / 7,\n          t = r / 2.5,\n          v = r / 8;\n      context.moveTo(-s, r);\n      context.lineTo(s, r);\n      context.lineTo(s, -v);\n      context.lineTo(t, -v);\n      context.lineTo(0, -r);\n      context.lineTo(-t, -v);\n      context.lineTo(-s, -v);\n      context.closePath();\n    }\n  },\n  'wedge': {\n    draw: function(context, size) {\n      var r = Math.sqrt(size) / 2,\n          h = HalfSqrt3 * r,\n          o = (h - r * Tan30),\n          b = r / 4;\n      context.moveTo(0, -h - o);\n      context.lineTo(-b, h - o);\n      context.lineTo(b, h - o);\n      context.closePath();\n    }\n  },\n  'triangle': {\n    draw: function(context, size) {\n      var r = Math.sqrt(size) / 2,\n          h = HalfSqrt3 * r,\n          o = (h - r * Tan30);\n      context.moveTo(0, -h - o);\n      context.lineTo(-r, h - o);\n      context.lineTo(r, h - o);\n      context.closePath();\n    }\n  },\n  'triangle-up': {\n    draw: function(context, size) {\n      var r = Math.sqrt(size) / 2,\n          h = HalfSqrt3 * r;\n      context.moveTo(0, -h);\n      context.lineTo(-r, h);\n      context.lineTo(r, h);\n      context.closePath();\n    }\n  },\n  'triangle-down': {\n    draw: function(context, size) {\n      var r = Math.sqrt(size) / 2,\n          h = HalfSqrt3 * r;\n      context.moveTo(0, h);\n      context.lineTo(-r, -h);\n      context.lineTo(r, -h);\n      context.closePath();\n    }\n  },\n  'triangle-right': {\n    draw: function(context, size) {\n      var r = Math.sqrt(size) / 2,\n          h = HalfSqrt3 * r;\n      context.moveTo(h, 0);\n      context.lineTo(-h, -r);\n      context.lineTo(-h, r);\n      context.closePath();\n    }\n  },\n  'triangle-left': {\n    draw: function(context, size) {\n      var r = Math.sqrt(size) / 2,\n          h = HalfSqrt3 * r;\n      context.moveTo(-h, 0);\n      context.lineTo(h, -r);\n      context.lineTo(h, r);\n      context.closePath();\n    }\n  },\n  'stroke': {\n    draw: function(context, size) {\n      const r = Math.sqrt(size) / 2;\n      context.moveTo(-r, 0);\n      context.lineTo(r, 0);\n    }\n  }\n};\n\nexport default function symbols(_) {\n  return hasOwnProperty(builtins, _) ? builtins[_] : customSymbol(_);\n}\n\nvar custom = {};\n\nfunction customSymbol(path) {\n  if (!hasOwnProperty(custom, path)) {\n    const parsed = pathParse(path);\n    custom[path] = {\n      draw: function(context, size) {\n        pathRender(context, parsed, 0, 0, Math.sqrt(size) / 2);\n      }\n    };\n  }\n  return custom[path];\n}\n","import {path} from 'd3-path';\n\n// See http://spencermortensen.com/articles/bezier-circle/\nconst C = 0.448084975506; // C = 1 - c\n\nfunction rectangleX(d) {\n  return d.x;\n}\n\nfunction rectangleY(d) {\n  return d.y;\n}\n\nfunction rectangleWidth(d) {\n  return d.width;\n}\n\nfunction rectangleHeight(d) {\n  return d.height;\n}\n\nfunction number(_) {\n  return typeof _ === 'function' ? _ : () => +_;\n}\n\nfunction clamp(value, min, max) {\n  return Math.max(min, Math.min(value, max));\n}\n\nexport default function() {\n  var x = rectangleX,\n      y = rectangleY,\n      width = rectangleWidth,\n      height = rectangleHeight,\n      crTL = number(0),\n      crTR = crTL,\n      crBL = crTL,\n      crBR = crTL,\n      context = null;\n\n  function rectangle(_, x0, y0) {\n    var buffer,\n        x1 = x0 != null ? x0 : +x.call(this, _),\n        y1 = y0 != null ? y0 : +y.call(this, _),\n        w  = +width.call(this, _),\n        h  = +height.call(this, _),\n        s  = Math.min(w, h) / 2,\n        tl = clamp(+crTL.call(this, _), 0, s),\n        tr = clamp(+crTR.call(this, _), 0, s),\n        bl = clamp(+crBL.call(this, _), 0, s),\n        br = clamp(+crBR.call(this, _), 0, s);\n\n    if (!context) {\n      context = buffer = path();\n    }\n\n    if (tl <= 0 && tr <= 0 && bl <= 0 && br <= 0) {\n      context.rect(x1, y1, w, h);\n    } else {\n      var x2 = x1 + w,\n          y2 = y1 + h;\n      context.moveTo(x1 + tl, y1);\n      context.lineTo(x2 - tr, y1);\n      context.bezierCurveTo(x2 - C * tr, y1, x2, y1 + C * tr, x2, y1 + tr);\n      context.lineTo(x2, y2 - br);\n      context.bezierCurveTo(x2, y2 - C * br, x2 - C * br, y2, x2 - br, y2);\n      context.lineTo(x1 + bl, y2);\n      context.bezierCurveTo(x1 + C * bl, y2, x1, y2 - C * bl, x1, y2 - bl);\n      context.lineTo(x1, y1 + tl);\n      context.bezierCurveTo(x1, y1 + C * tl, x1 + C * tl, y1, x1 + tl, y1);\n      context.closePath();\n    }\n\n    if (buffer) {\n      context = null;\n      return buffer + '' || null;\n    }\n  }\n\n  rectangle.x = function(_) {\n    if (arguments.length) {\n      x = number(_);\n      return rectangle;\n    } else {\n      return x;\n    }\n  };\n\n  rectangle.y = function(_) {\n    if (arguments.length) {\n      y = number(_);\n      return rectangle;\n    } else {\n      return y;\n    }\n  };\n\n  rectangle.width = function(_) {\n    if (arguments.length) {\n      width = number(_);\n      return rectangle;\n    } else {\n      return width;\n    }\n  };\n\n  rectangle.height = function(_) {\n    if (arguments.length) {\n      height = number(_);\n      return rectangle;\n    } else {\n      return height;\n    }\n  };\n\n  rectangle.cornerRadius = function(tl, tr, br, bl) {\n    if (arguments.length) {\n      crTL = number(tl);\n      crTR = tr != null ? number(tr) : crTL;\n      crBR = br != null ? number(br) : crTL;\n      crBL = bl != null ? number(bl) : crTR;\n      return rectangle;\n    } else {\n      return crTL;\n    }\n  };\n\n  rectangle.context = function(_) {\n    if (arguments.length) {\n      context = _ == null ? null : _;\n      return rectangle;\n    } else {\n      return context;\n    }\n  };\n\n  return rectangle;\n}\n","import {Tau} from '../util/constants';\nimport {path} from 'd3-path';\n\nexport default function() {\n  var x,\n      y,\n      size,\n      defined,\n      context = null,\n      ready, x1, y1, r1;\n\n  function point(x2, y2, w2) {\n    const r2 = w2 / 2;\n\n    if (ready) {\n      var ux = y1 - y2,\n          uy = x2 - x1;\n\n      if (ux || uy) {\n        // get normal vector\n        var ud = Math.hypot(ux, uy),\n            rx = (ux /= ud) * r1,\n            ry = (uy /= ud) * r1,\n            t = Math.atan2(uy, ux);\n\n        // draw segment\n        context.moveTo(x1 - rx, y1 - ry);\n        context.lineTo(x2 - ux * r2, y2 - uy * r2);\n        context.arc(x2, y2, r2, t - Math.PI, t);\n        context.lineTo(x1 + rx, y1 + ry);\n        context.arc(x1, y1, r1, t, t + Math.PI);\n      } else {\n        context.arc(x2, y2, r2, 0, Tau);\n      }\n      context.closePath();\n    } else {\n      ready = 1;\n    }\n    x1 = x2;\n    y1 = y2;\n    r1 = r2;\n  }\n\n  function trail(data) {\n    var i,\n        n = data.length,\n        d,\n        defined0 = false,\n        buffer;\n\n    if (context == null) context = buffer = path();\n\n    for (i = 0; i <= n; ++i) {\n      if (!(i < n && defined(d = data[i], i, data)) === defined0) {\n        if (defined0 = !defined0) ready = 0;\n      }\n      if (defined0) point(+x(d, i, data), +y(d, i, data), +size(d, i, data));\n    }\n\n    if (buffer) {\n      context = null;\n      return buffer + '' || null;\n    }\n  }\n\n  trail.x = function(_) {\n    if (arguments.length) {\n      x = _;\n      return trail;\n    } else {\n      return x;\n    }\n  };\n\n  trail.y = function(_) {\n    if (arguments.length) {\n      y = _;\n      return trail;\n    } else {\n      return y;\n    }\n  };\n\n  trail.size = function(_) {\n    if (arguments.length) {\n      size = _;\n      return trail;\n    } else {\n      return size;\n    }\n  };\n\n  trail.defined = function(_) {\n    if (arguments.length) {\n      defined = _;\n      return trail;\n    } else {\n      return defined;\n    }\n  };\n\n  trail.context = function(_) {\n    if (arguments.length) {\n      if (_ == null) {\n        context = null;\n      } else {\n        context = _;\n      }\n      return trail;\n    } else {\n      return context;\n    }\n  };\n\n  return trail;\n}\n","import curves from './curves';\nimport symbols from './symbols';\n\nimport {default as vg_rect} from './rectangle';\nimport {default as vg_trail} from './trail';\n\nimport {\n  arc as d3_arc,\n  area as d3_area,\n  line as d3_line,\n  symbol as d3_symbol\n} from 'd3-shape';\n\nfunction value(a, b) {\n  return a != null ? a : b;\n}\n\nconst x =  item => item.x || 0,\n      y =  item => item.y || 0,\n      w =  item => item.width || 0,\n      h =  item => item.height || 0,\n      xw = item => (item.x || 0) + (item.width || 0),\n      yh = item => (item.y || 0) + (item.height || 0),\n      sa = item => item.startAngle || 0,\n      ea = item => item.endAngle || 0,\n      pa = item => item.padAngle || 0,\n      ir = item => item.innerRadius || 0,\n      or = item => item.outerRadius || 0,\n      cr = item => item.cornerRadius || 0,\n      tl = item => value(item.cornerRadiusTopLeft, item.cornerRadius) || 0,\n      tr = item => value(item.cornerRadiusTopRight, item.cornerRadius) || 0,\n      br = item => value(item.cornerRadiusBottomRight, item.cornerRadius) || 0,\n      bl = item => value(item.cornerRadiusBottomLeft, item.cornerRadius) || 0,\n      sz = item => value(item.size, 64),\n      ts = item => item.size || 1,\n      def = item => !(item.defined === false),\n      type = item => symbols(item.shape || 'circle');\n\nconst arcShape    = d3_arc().startAngle(sa).endAngle(ea).padAngle(pa)\n                      .innerRadius(ir).outerRadius(or).cornerRadius(cr),\n      areavShape  = d3_area().x(x).y1(y).y0(yh).defined(def),\n      areahShape  = d3_area().y(y).x1(x).x0(xw).defined(def),\n      lineShape   = d3_line().x(x).y(y).defined(def),\n      rectShape   = vg_rect().x(x).y(y).width(w).height(h)\n                      .cornerRadius(tl, tr, br, bl),\n      symbolShape = d3_symbol().type(type).size(sz),\n      trailShape  = vg_trail().x(x).y(y).defined(def).size(ts);\n\nexport function hasCornerRadius(item) {\n  return item.cornerRadius\n    || item.cornerRadiusTopLeft\n    || item.cornerRadiusTopRight\n    || item.cornerRadiusBottomRight\n    || item.cornerRadiusBottomLeft;\n}\n\nexport function arc(context, item) {\n  return arcShape.context(context)(item);\n}\n\nexport function area(context, items) {\n  const item = items[0],\n        interp = item.interpolate || 'linear';\n  return (item.orient === 'horizontal' ? areahShape : areavShape)\n    .curve(curves(interp, item.orient, item.tension))\n    .context(context)(items);\n}\n\nexport function line(context, items) {\n  const item = items[0],\n        interp = item.interpolate || 'linear';\n  return lineShape.curve(curves(interp, item.orient, item.tension))\n    .context(context)(items);\n}\n\nexport function rectangle(context, item, x, y) {\n  return rectShape.context(context)(item, x, y);\n}\n\nexport function shape(context, item) {\n  return (item.mark.shape || item.shape)\n    .context(context)(item);\n}\n\nexport function symbol(context, item) {\n  return symbolShape.context(context)(item);\n}\n\nexport function trail(context, items) {\n  return trailShape.context(context)(items);\n}\n","import constant from \"./constant.js\";\nimport {withPath} from \"./path.js\";\nimport asterisk from \"./symbol/asterisk.js\";\nimport circle from \"./symbol/circle.js\";\nimport cross from \"./symbol/cross.js\";\nimport diamond from \"./symbol/diamond.js\";\nimport diamond2 from \"./symbol/diamond2.js\";\nimport plus from \"./symbol/plus.js\";\nimport square from \"./symbol/square.js\";\nimport square2 from \"./symbol/square2.js\";\nimport star from \"./symbol/star.js\";\nimport triangle from \"./symbol/triangle.js\";\nimport triangle2 from \"./symbol/triangle2.js\";\nimport wye from \"./symbol/wye.js\";\nimport times from \"./symbol/times.js\";\n\n// These symbols are designed to be filled.\nexport const symbolsFill = [\n  circle,\n  cross,\n  diamond,\n  square,\n  star,\n  triangle,\n  wye\n];\n\n// These symbols are designed to be stroked (with a width of 1.5px and round caps).\nexport const symbolsStroke = [\n  circle,\n  plus,\n  times,\n  triangle2,\n  asterisk,\n  square2,\n  diamond2\n];\n\nexport default function Symbol(type, size) {\n  let context = null,\n      path = withPath(symbol);\n\n  type = typeof type === \"function\" ? type : constant(type || circle);\n  size = typeof size === \"function\" ? size : constant(size === undefined ? 64 : +size);\n\n  function symbol() {\n    let buffer;\n    if (!context) context = buffer = path();\n    type.apply(this, arguments).draw(context, +size.apply(this, arguments));\n    if (buffer) return context = null, buffer + \"\" || null;\n  }\n\n  symbol.type = function(_) {\n    return arguments.length ? (type = typeof _ === \"function\" ? _ : constant(_), symbol) : type;\n  };\n\n  symbol.size = function(_) {\n    return arguments.length ? (size = typeof _ === \"function\" ? _ : constant(+_), symbol) : size;\n  };\n\n  symbol.context = function(_) {\n    return arguments.length ? (context = _ == null ? null : _, symbol) : context;\n  };\n\n  return symbol;\n}\n","import {hasCornerRadius, rectangle} from '../../path/shapes';\nimport {isFunction} from 'vega-util';\n\nvar clip_id = 1;\n\nexport function resetSVGClipId() {\n  clip_id = 1;\n}\n\nexport default function(renderer, item, size) {\n  var clip = item.clip,\n      defs = renderer._defs,\n      id = item.clip_id || (item.clip_id = 'clip' + clip_id++),\n      c = defs.clipping[id] || (defs.clipping[id] = {id: id});\n\n  if (isFunction(clip)) {\n    c.path = clip(null);\n  } else if (hasCornerRadius(size)) {\n    c.path = rectangle(null, size, 0, 0);\n  } else {\n    c.width = size.width || 0;\n    c.height = size.height || 0;\n  }\n\n  return 'url(#' + id + ')';\n}\n","export default function Bounds(b) {\n  this.clear();\n  if (b) this.union(b);\n}\n\nBounds.prototype = {\n  clone() {\n    return new Bounds(this);\n  },\n\n  clear() {\n    this.x1 = +Number.MAX_VALUE;\n    this.y1 = +Number.MAX_VALUE;\n    this.x2 = -Number.MAX_VALUE;\n    this.y2 = -Number.MAX_VALUE;\n    return this;\n  },\n\n  empty() {\n    return (\n      this.x1 === +Number.MAX_VALUE &&\n      this.y1 === +Number.MAX_VALUE &&\n      this.x2 === -Number.MAX_VALUE &&\n      this.y2 === -Number.MAX_VALUE\n    );\n  },\n\n  equals(b) {\n    return (\n      this.x1 === b.x1 &&\n      this.y1 === b.y1 &&\n      this.x2 === b.x2 &&\n      this.y2 === b.y2\n    );\n  },\n\n  set(x1, y1, x2, y2) {\n    if (x2 < x1) {\n      this.x2 = x1;\n      this.x1 = x2;\n    } else {\n      this.x1 = x1;\n      this.x2 = x2;\n    }\n    if (y2 < y1) {\n      this.y2 = y1;\n      this.y1 = y2;\n    } else {\n      this.y1 = y1;\n      this.y2 = y2;\n    }\n    return this;\n  },\n\n  add(x, y) {\n    if (x < this.x1) this.x1 = x;\n    if (y < this.y1) this.y1 = y;\n    if (x > this.x2) this.x2 = x;\n    if (y > this.y2) this.y2 = y;\n    return this;\n  },\n\n  expand(d) {\n    this.x1 -= d;\n    this.y1 -= d;\n    this.x2 += d;\n    this.y2 += d;\n    return this;\n  },\n\n  round() {\n    this.x1 = Math.floor(this.x1);\n    this.y1 = Math.floor(this.y1);\n    this.x2 = Math.ceil(this.x2);\n    this.y2 = Math.ceil(this.y2);\n    return this;\n  },\n\n  scale(s) {\n    this.x1 *= s;\n    this.y1 *= s;\n    this.x2 *= s;\n    this.y2 *= s;\n    return this;\n  },\n\n  translate(dx, dy) {\n    this.x1 += dx;\n    this.x2 += dx;\n    this.y1 += dy;\n    this.y2 += dy;\n    return this;\n  },\n\n  rotate(angle, x, y) {\n    const p = this.rotatedPoints(angle, x, y);\n    return this.clear()\n      .add(p[0], p[1])\n      .add(p[2], p[3])\n      .add(p[4], p[5])\n      .add(p[6], p[7]);\n  },\n\n  rotatedPoints(angle, x, y) {\n    var {x1, y1, x2, y2} = this,\n        cos = Math.cos(angle),\n        sin = Math.sin(angle),\n        cx = x - x * cos + y * sin,\n        cy = y - x * sin - y * cos;\n\n    return [\n      cos * x1 - sin * y1 + cx, sin * x1 + cos * y1 + cy,\n      cos * x1 - sin * y2 + cx, sin * x1 + cos * y2 + cy,\n      cos * x2 - sin * y1 + cx, sin * x2 + cos * y1 + cy,\n      cos * x2 - sin * y2 + cx, sin * x2 + cos * y2 + cy\n    ];\n  },\n\n  union(b) {\n    if (b.x1 < this.x1) this.x1 = b.x1;\n    if (b.y1 < this.y1) this.y1 = b.y1;\n    if (b.x2 > this.x2) this.x2 = b.x2;\n    if (b.y2 > this.y2) this.y2 = b.y2;\n    return this;\n  },\n\n  intersect(b) {\n    if (b.x1 > this.x1) this.x1 = b.x1;\n    if (b.y1 > this.y1) this.y1 = b.y1;\n    if (b.x2 < this.x2) this.x2 = b.x2;\n    if (b.y2 < this.y2) this.y2 = b.y2;\n    return this;\n  },\n\n  encloses(b) {\n    return b && (\n      this.x1 <= b.x1 &&\n      this.x2 >= b.x2 &&\n      this.y1 <= b.y1 &&\n      this.y2 >= b.y2\n    );\n  },\n\n  alignsWith(b) {\n    return b && (\n      this.x1 == b.x1 ||\n      this.x2 == b.x2 ||\n      this.y1 == b.y1 ||\n      this.y2 == b.y2\n    );\n  },\n\n  intersects(b) {\n    return b && !(\n      this.x2 < b.x1 ||\n      this.x1 > b.x2 ||\n      this.y2 < b.y1 ||\n      this.y1 > b.y2\n    );\n  },\n\n  contains(x, y) {\n    return !(\n      x < this.x1 ||\n      x > this.x2 ||\n      y < this.y1 ||\n      y > this.y2\n    );\n  },\n\n  width() {\n    return this.x2 - this.x1;\n  },\n\n  height() {\n    return this.y2 - this.y1;\n  }\n};\n","import Bounds from './Bounds';\n\nexport default function Item(mark) {\n  this.mark = mark;\n  this.bounds = (this.bounds || new Bounds());\n}\n","import Item from './Item';\nimport {inherits} from 'vega-util';\n\nexport default function GroupItem(mark) {\n  Item.call(this, mark);\n  this.items = (this.items || []);\n}\n\ninherits(GroupItem, Item);\n","import {image} from 'vega-canvas';\nimport {loader} from 'vega-loader';\nimport {hasOwnProperty} from 'vega-util';\n\nexport default class ResourceLoader {\n  constructor(customLoader) {\n    this._pending = 0;\n    this._loader = customLoader || loader();\n  }\n\n  pending() {\n    return this._pending;\n  }\n\n  sanitizeURL(uri) {\n    const loader = this;\n    increment(loader);\n\n    return loader._loader.sanitize(uri, { context: 'href' })\n      .then(opt => {\n        decrement(loader);\n        return opt;\n      })\n      .catch(() => {\n        decrement(loader);\n        return null;\n      });\n  }\n\n  loadImage(uri) {\n    const loader = this, Image = image();\n    increment(loader);\n\n    return loader._loader\n      .sanitize(uri, { context: 'image' })\n      .then(opt => {\n        const url = opt.href;\n        if (!url || !Image) throw { url: url };\n\n        const img = new Image();\n\n        // set crossOrigin only if cors is defined; empty string sets anonymous mode\n        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/crossOrigin\n        const cors = hasOwnProperty(opt, 'crossOrigin') ? opt.crossOrigin : 'anonymous';\n        if (cors != null) img.crossOrigin = cors;\n\n        // attempt to load image resource\n        img.onload = () => decrement(loader);\n        img.onerror = () => decrement(loader);\n        img.src = url;\n\n        return img;\n      })\n      .catch(e => {\n        decrement(loader);\n        return { complete: false, width: 0, height: 0, src: e && e.url || '' };\n      });\n  }\n\n  ready() {\n    const loader = this;\n    return new Promise(accept => {\n      function poll(value) {\n        if (!loader.pending()) accept(value);\n        else setTimeout(() => { poll(true); }, 10);\n      }\n      poll(false);\n    });\n  }\n}\n\nfunction increment(loader) {\n  loader._pending += 1;\n}\n\nfunction decrement(loader) {\n  loader._pending -= 1;\n}\n\n","export default function(bounds, item, miter) {\n  if (item.stroke && item.opacity !== 0 && item.strokeOpacity !== 0) {\n    const sw = item.strokeWidth != null ? +item.strokeWidth : 1;\n    bounds.expand(sw + (miter ? miterAdjustment(item, sw) : 0));\n  }\n  return bounds;\n}\n\nfunction miterAdjustment(item, strokeWidth) {\n  // TODO: more sophisticated adjustment? Or miter support in boundContext?\n  return item.strokeJoin && item.strokeJoin !== 'miter' ? 0 : strokeWidth;\n}\n","import {DegToRad, Epsilon, HalfPi, Tau} from '../util/constants';\n\nconst circleThreshold = Tau - 1e-8;\nlet bounds, lx, ly, rot, ma, mb, mc, md;\n\nconst add = (x, y) => bounds.add(x, y);\nconst addL = (x, y) => add(lx = x, ly = y);\nconst addX = x => add(x, bounds.y1);\nconst addY = y => add(bounds.x1, y);\n\nconst px = (x, y) => ma * x + mc * y;\nconst py = (x, y) => mb * x + md * y;\nconst addp = (x, y) => add(px(x, y), py(x, y));\nconst addpL = (x, y) => addL(px(x, y), py(x, y));\n\nexport default function(_, deg) {\n  bounds = _;\n  if (deg) {\n    rot = deg * DegToRad;\n    ma = md = Math.cos(rot);\n    mb = Math.sin(rot);\n    mc = -mb;\n  } else {\n    ma = md = 1;\n    rot = mb = mc = 0;\n  }\n  return context;\n}\n\nconst context = {\n  beginPath() {},\n  closePath() {},\n\n  moveTo: addpL,\n  lineTo: addpL,\n\n  rect(x, y, w, h) {\n    if (rot) {\n      addp(x + w, y);\n      addp(x + w, y + h);\n      addp(x, y + h);\n      addpL(x, y);\n    } else {\n      add(x + w, y + h);\n      addL(x, y);\n    }\n  },\n\n  quadraticCurveTo(x1, y1, x2, y2) {\n    const px1 = px(x1, y1),\n          py1 = py(x1, y1),\n          px2 = px(x2, y2),\n          py2 = py(x2, y2);\n    quadExtrema(lx, px1, px2, addX);\n    quadExtrema(ly, py1, py2, addY);\n    addL(px2, py2);\n  },\n\n  bezierCurveTo(x1, y1, x2, y2, x3, y3) {\n    const px1 = px(x1, y1),\n          py1 = py(x1, y1),\n          px2 = px(x2, y2),\n          py2 = py(x2, y2),\n          px3 = px(x3, y3),\n          py3 = py(x3, y3);\n    cubicExtrema(lx, px1, px2, px3, addX);\n    cubicExtrema(ly, py1, py2, py3, addY);\n    addL(px3, py3);\n  },\n\n  arc(cx, cy, r, sa, ea, ccw) {\n    sa += rot;\n    ea += rot;\n\n    // store last point on path\n    lx = r * Math.cos(ea) + cx;\n    ly = r * Math.sin(ea) + cy;\n\n    if (Math.abs(ea - sa) > circleThreshold) {\n      // treat as full circle\n      add(cx - r, cy - r);\n      add(cx + r, cy + r);\n    } else {\n      const update = a => add(r * Math.cos(a) + cx, r * Math.sin(a) + cy);\n      let s, i;\n\n      // sample end points\n      update(sa);\n      update(ea);\n\n      // sample interior points aligned with 90 degrees\n      if (ea !== sa) {\n        sa = sa % Tau; if (sa < 0) sa += Tau;\n        ea = ea % Tau; if (ea < 0) ea += Tau;\n\n        if (ea < sa) {\n          ccw = !ccw; // flip direction\n          s = sa; sa = ea; ea = s; // swap end-points\n        }\n\n        if (ccw) {\n          ea -= Tau;\n          s = sa - (sa % HalfPi);\n          for (i=0; i<4 && s>ea; ++i, s-=HalfPi) update(s);\n        } else {\n          s = sa - (sa % HalfPi) + HalfPi;\n          for (i=0; i<4 && s<ea; ++i, s=s+HalfPi) update(s);\n        }\n      }\n    }\n  }\n};\n\nfunction quadExtrema(x0, x1, x2, cb) {\n  const t = (x0 - x1) / (x0 + x2 - 2 * x1);\n  if (0 < t && t < 1) cb(x0 + (x1 - x0) * t);\n}\n\nfunction cubicExtrema(x0, x1, x2, x3, cb) {\n  const a = x3 - x0 + 3 * x1 - 3 * x2,\n        b = x0 + x2 - 2 * x1,\n        c = x0 - x1;\n\n  let t0 = 0, t1 = 0, r;\n\n  // solve for parameter t\n  if (Math.abs(a) > Epsilon) {\n    // quadratic equation\n    r = b * b + c * a;\n    if (r >= 0) {\n      r = Math.sqrt(r);\n      t0 = (-b + r) / a;\n      t1 = (-b - r) / a;\n    }\n  } else {\n    // linear equation\n    t0 = 0.5 * c / b;\n  }\n\n  // calculate position\n  if (0 < t0 && t0 < 1) cb(cubic(t0, x0, x1, x2, x3));\n  if (0 < t1 && t1 < 1) cb(cubic(t1, x0, x1, x2, x3));\n}\n\nfunction cubic(t, x0, x1, x2, x3) {\n  const s = 1 - t, s2 = s * s, t2 = t * t;\n  return (s2 * s * x0) + (3 * s2 * t * x1) + (3 * s * t2 * x2) + (t2 * t * x3);\n}\n","import {canvas} from 'vega-canvas';\n\nexport var context = (context = canvas(1,1))\n  ? context.getContext('2d')\n  : null;\n","import {context} from './canvas/context';\nimport Bounds from '../Bounds';\n\nconst b = new Bounds();\n\nexport function intersectPath(draw) {\n  return function(item, brush) {\n    // rely on (inaccurate) bounds intersection if no context\n    if (!context) return true;\n\n    // add path to offscreen graphics context\n    draw(context, item);\n\n    // get bounds intersection region\n    b.clear().union(item.bounds).intersect(brush).round();\n    const {x1, y1, x2, y2} = b;\n\n    // iterate over intersection region\n    // perform fine grained inclusion test\n    for (let y = y1; y <= y2; ++y) {\n      for (let x = x1; x <= x2; ++x) {\n        if (context.isPointInPath(x, y)) {\n          return true;\n        }\n      }\n    }\n\n    // false if no hits in intersection region\n    return false;\n  };\n}\n\nexport function intersectPoint(item, box) {\n  return box.contains(item.x || 0, item.y || 0);\n}\n\nexport function intersectRect(item, box) {\n  const x = item.x || 0,\n        y = item.y || 0,\n        w = item.width || 0,\n        h = item.height || 0;\n  return box.intersects(b.set(x, y, x + w, y + h));\n}\n\nexport function intersectRule(item, box) {\n  const x = item.x || 0,\n        y = item.y || 0,\n        x2 = item.x2 != null ? item.x2 : x,\n        y2 = item.y2 != null ? item.y2 : y;\n  return intersectBoxLine(box, x, y, x2, y2);\n}\n\nexport function intersectBoxLine(box, x, y, u, v) {\n  const {x1, y1, x2, y2} = box,\n        dx = u - x,\n        dy = v - y;\n\n  let t0 = 0, t1 = 1, p, q, r, e;\n\n  for (e=0; e<4; ++e) {\n    if (e === 0) { p = -dx; q = -(x1 - x); }\n    if (e === 1) { p =  dx; q =  (x2 - x); }\n    if (e === 2) { p = -dy; q = -(y1 - y); }\n    if (e === 3) { p =  dy; q =  (y2 - y); }\n\n    if (Math.abs(p) < 1e-10 && q < 0) return false;\n\n    r = q / p;\n\n    if (p < 0) {\n      if (r > t1) return false;\n      else if (r > t0) t0 = r;\n    } else if (p > 0) {\n      if (r < t0) return false;\n      else if (r < t1) t1 = r;\n    }\n  }\n\n  return true;\n}\n","export default function(context, item) {\n  context.globalCompositeOperation = item.blend || 'source-over';\n}\n","export default function(value, dflt) {\n  return value == null ? dflt : value;\n}\n","import value from '../value';\nimport {canvas} from 'vega-canvas';\n\nfunction addStops(gradient, stops) {\n  const n = stops.length;\n  for (let i=0; i<n; ++i) {\n    gradient.addColorStop(stops[i].offset, stops[i].color);\n  }\n  return gradient;\n}\n\nexport default function(context, spec, bounds) {\n  const w = bounds.width(),\n        h = bounds.height();\n  let gradient;\n\n\n  if (spec.gradient === 'radial') {\n    gradient = context.createRadialGradient(\n      bounds.x1 + value(spec.x1, 0.5) * w,\n      bounds.y1 + value(spec.y1, 0.5) * h,\n      Math.max(w, h) * value(spec.r1, 0),\n      bounds.x1 + value(spec.x2, 0.5) * w,\n      bounds.y1 + value(spec.y2, 0.5) * h,\n      Math.max(w, h) * value(spec.r2, 0.5)\n    );\n  } else { // linear gradient\n    const x1 = value(spec.x1, 0),\n          y1 = value(spec.y1, 0),\n          x2 = value(spec.x2, 1),\n          y2 = value(spec.y2, 0);\n\n    if (x1 === x2 || y1 === y2 || w === h) {\n      // axis aligned: use normal gradient\n      gradient = context.createLinearGradient(\n        bounds.x1 + x1 * w,\n        bounds.y1 + y1 * h,\n        bounds.x1 + x2 * w,\n        bounds.y1 + y2 * h\n      );\n    } else {\n      // not axis aligned: render gradient into a pattern (#2365)\n      // this allows us to use normalized bounding box coordinates\n      const image = canvas(Math.ceil(w), Math.ceil(h)),\n            ictx = image.getContext('2d');\n\n      ictx.scale(w, h);\n      ictx.fillStyle = addStops(\n        ictx.createLinearGradient(x1, y1, x2, y2),\n        spec.stops\n      );\n      ictx.fillRect(0, 0, w, h);\n\n      return context.createPattern(image, 'no-repeat');\n    }\n  }\n\n  return addStops(gradient, spec.stops);\n}\n","import {isGradient} from '../../Gradient';\nimport gradient from './gradient';\n\nexport default function(context, item, value) {\n  return isGradient(value)\n    ? gradient(context, value, item.bounds)\n    : value;\n}\n","import color from './color';\n\nexport default function(context, item, opacity) {\n  opacity *= (item.fillOpacity==null ? 1 : item.fillOpacity);\n  if (opacity > 0) {\n    context.globalAlpha = opacity;\n    context.fillStyle = color(context, item, item.fill);\n    return true;\n  } else {\n    return false;\n  }\n}\n","import color from './color';\n\nvar Empty = [];\n\nexport default function(context, item, opacity) {\n  var lw = (lw = item.strokeWidth) != null ? lw : 1;\n\n  if (lw <= 0) return false;\n\n  opacity *= (item.strokeOpacity==null ? 1 : item.strokeOpacity);\n  if (opacity > 0) {\n    context.globalAlpha = opacity;\n    context.strokeStyle = color(context, item, item.stroke);\n\n    context.lineWidth = lw;\n    context.lineCap = item.strokeCap || 'butt';\n    context.lineJoin = item.strokeJoin || 'miter';\n    context.miterLimit = item.strokeMiterLimit || 10;\n\n    if (context.setLineDash) {\n      context.setLineDash(item.strokeDash || Empty);\n      context.lineDashOffset = item.strokeDashOffset || 0;\n    }\n    return true;\n  } else {\n    return false;\n  }\n}\n","function compare(a, b) {\n  return a.zindex - b.zindex || a.index - b.index;\n}\n\nexport function zorder(scene) {\n  if (!scene.zdirty) return scene.zitems;\n\n  var items = scene.items,\n      output = [], item, i, n;\n\n  for (i=0, n=items.length; i<n; ++i) {\n    item = items[i];\n    item.index = i;\n    if (item.zindex) output.push(item);\n  }\n\n  scene.zdirty = false;\n  return scene.zitems = output.sort(compare);\n}\n\nexport function visit(scene, visitor) {\n  var items = scene.items, i, n;\n  if (!items || !items.length) return;\n\n  const zitems = zorder(scene);\n\n  if (zitems && zitems.length) {\n    for (i=0, n=items.length; i<n; ++i) {\n      if (!items[i].zindex) visitor(items[i]);\n    }\n    items = zitems;\n  }\n\n  for (i=0, n=items.length; i<n; ++i) {\n    visitor(items[i]);\n  }\n}\n\nexport function pickVisit(scene, visitor) {\n  var items = scene.items, hit, i;\n\n  if (!items || !items.length) return null;\n\n  const zitems = zorder(scene);\n  if (zitems && zitems.length) items = zitems;\n\n  for (i=items.length; --i >= 0;) {\n    if (hit = visitor(items[i])) return hit;\n  }\n\n  if (items === zitems) {\n    for (items=scene.items, i=items.length; --i >= 0;) {\n      if (!items[i].zindex) {\n        if (hit = visitor(items[i])) return hit;\n      }\n    }\n  }\n\n  return null;\n}\n","import blend from './blend';\nimport fill from './fill';\nimport stroke from './stroke';\nimport {visit} from '../visit';\n\nexport function drawAll(path) {\n  return function(context, scene, bounds) {\n    visit(scene, item => {\n      if (!bounds || bounds.intersects(item.bounds)) {\n        drawPath(path, context, item, item);\n      }\n    });\n  };\n}\n\nexport function drawOne(path) {\n  return function(context, scene, bounds) {\n    if (scene.items.length && (!bounds || bounds.intersects(scene.bounds))) {\n      drawPath(path, context, scene.items[0], scene.items);\n    }\n  };\n}\n\nfunction drawPath(path, context, item, items) {\n  var opacity = item.opacity == null ? 1 : item.opacity;\n  if (opacity === 0) return;\n\n  if (path(context, items)) return;\n\n  blend(context, item);\n\n  if (item.fill && fill(context, item, opacity)) {\n    context.fill();\n  }\n\n  if (item.stroke && stroke(context, item, opacity)) {\n    context.stroke();\n  }\n}\n","import {pickVisit} from '../visit';\nimport {truthy} from 'vega-util';\n\nexport function pick(test) {\n  test = test || truthy;\n\n  return function(context, scene, x, y, gx, gy) {\n    // x *= context.pixelRatio;\n    // y *= context.pixelRatio;\n\n    return pickVisit(scene, item => {\n      const b = item.bounds;\n\n      // first hit test against bounding box\n      if ((b && !b.contains(gx, gy)) || !b) {\n        return;\n      }\n\n      // if in bounding box, perform more careful test\n      if (test(context, item, x, y, gx, gy)) {\n        return item;\n      }\n    });\n  };\n}\n\nexport function hitPath(path, filled) {\n  return function(context, o, x, y) {\n\n    var item = Array.isArray(o) ? o[0] : o,\n        fill = (filled == null) ? item.fill : filled,\n        stroke = item.stroke && context.isPointInStroke, lw, lc;\n\n    if (stroke) {\n      lw = item.strokeWidth;\n      lc = item.strokeCap;\n      context.lineWidth = lw != null ? lw : 1;\n      context.lineCap   = lc != null ? lc : 'butt';\n    }\n\n    // Previous code\n    // return path(context, o) ? false :\n    //   (fill && context.isPointInPath(x, y)) ||\n    //   (stroke && context.isPointInStroke(x, y));\n\n\n    // ==== Added: go back from vis to canvas coordinates.\n\n    // CHECK HOW TO HANDLE PADDING THERE\n    // const transform = context.getTransform();\n    // const scaleFactor = transform.a;\n    // const dx = transform.e - (25 * scaleFactor);\n    // const dy = transform.f - (25 * scaleFactor);\n    // const xCanvas = x * scaleFactor + dx;\n    // const yCanvas = y * scaleFactor + dy;\n\n    const origin = context.origin;\n    const scaleFactor = context.scale;\n\n    const xCanvas = (x + origin[0]) * scaleFactor;\n    const yCanvas = (y + origin[1]) * scaleFactor;\n\n    path(context, o);\n\n    // const test = (fill && context.isPointInPath(x * scaleFactor, y * scaleFactor)) ||\n    //   (stroke && context.isPointInStroke(x * scaleFactor, y * scaleFactor));\n    const isHitting = (fill && context.isPointInPath(xCanvas, yCanvas)) ||\n      (stroke && context.isPointInStroke(xCanvas, yCanvas));\n    return isHitting;\n  };\n}\n\nexport function pickPath(path) {\n  return pick(hitPath(path));\n}\n","export function translate(x, y) {\n  return 'translate(' + x + ',' + y + ')';\n}\n\nexport function rotate(a) {\n  return 'rotate(' + a + ')';\n}\n\nexport function scale(scaleX, scaleY){\n  return 'scale('+ scaleX + ',' + scaleY+')';\n}\n\nexport function translateItem(item) {\n  return translate(item.x || 0, item.y || 0);\n}\n\nexport function rotateItem(item) {\n  return translate(item.x || 0, item.y || 0)\n    + (item.angle ? ' ' + rotate(item.angle) : '');\n}\n\nexport function transformItem(item) {\n  return translate(item.x || 0, item.y || 0)\n    + (item.angle ? ' ' + rotate(item.angle) : '')\n    + (item.scaleX || item.scaleY ? ' ' + scale(item.scaleX || 1, item.scaleY || 1) : '');\n}\n","import boundStroke from '../bound/boundStroke';\nimport context from '../bound/boundContext';\nimport {intersectPath} from '../util/intersect';\nimport {drawAll} from '../util/canvas/draw';\nimport {pickPath} from '../util/canvas/pick';\nimport {rotateItem} from '../util/svg/transform';\nimport {DegToRad} from '../util/constants';\n\nexport default function(type, shape, isect) {\n\n  function attr(emit, item) {\n    emit('transform', rotateItem(item));\n    emit('d', shape(null, item));\n  }\n\n  function bound(bounds, item) {\n    shape(context(bounds, item.angle), item);\n    return boundStroke(bounds, item).translate(item.x || 0, item.y || 0);\n  }\n\n  function draw(context, item) {\n    var x = item.x || 0,\n        y = item.y || 0,\n        a = item.angle || 0;\n\n    context.translate(x, y);\n    if (a) context.rotate(a *= DegToRad);\n    context.beginPath();\n    shape(context, item);\n    if (a) context.rotate(-a);\n    context.translate(-x, -y);\n  }\n\n  return {\n    type:   type,\n    tag:    'path',\n    nested: false,\n    attr:   attr,\n    bound:  bound,\n    draw:   drawAll(draw),\n    pick:   pickPath(draw),\n    isect:  isect || intersectPath(draw)\n  };\n\n}\n","import {arc} from '../path/shapes';\nimport markItemPath from './markItemPath';\n\nexport default markItemPath('arc', arc);\n","import boundStroke from '../bound/boundStroke';\nimport context from '../bound/boundContext';\nimport {intersectPoint} from '../util/intersect';\nimport {drawOne} from '../util/canvas/draw';\nimport {hitPath} from '../util/canvas/pick';\n\nexport default function(type, shape, tip) {\n\n  function attr(emit, item) {\n    var items = item.mark.items;\n    if (items.length) emit('d', shape(null, items));\n  }\n\n  function bound(bounds, mark) {\n    var items = mark.items;\n    if (items.length === 0) {\n      return bounds;\n    } else {\n      shape(context(bounds), items);\n      return boundStroke(bounds, items[0]);\n    }\n  }\n\n  function draw(context, items) {\n    context.beginPath();\n    shape(context, items);\n  }\n\n  const hit = hitPath(draw);\n\n  function pick(context, scene, x, y, gx, gy) {\n    var items = scene.items,\n        b = scene.bounds;\n\n    if (!items || !items.length || b && !b.contains(gx, gy)) {\n      console.log(111)\n      return null;\n    }\n\n    // x *= context.pixelRatio;\n    // y *= context.pixelRatio;\n    return hit(context, items, x, y) ? items[0] : null;\n  }\n\n  return {\n    type:   type,\n    tag:    'path',\n    nested: true,\n    attr:   attr,\n    bound:  bound,\n    draw:   drawOne(draw),\n    pick:   pick,\n    isect:  intersectPoint,\n    tip:    tip\n  };\n\n}\n\n\n","import {area} from '../path/shapes';\nimport {pickArea} from '../util/pickPath';\nimport markMultiItemPath from './markMultiItemPath';\n\nexport default markMultiItemPath('area', area, pickArea);\n","export function pickArea(a, p) {\n  var v = a[0].orient === 'horizontal' ? p[1] : p[0],\n      z = a[0].orient === 'horizontal' ? 'y' : 'x',\n      i = a.length,\n      min = +Infinity, hit, d;\n\n  while (--i >= 0) {\n    if (a[i].defined === false) continue;\n    d = Math.abs(a[i][z] - v);\n    if (d < min) {\n      min = d;\n      hit = a[i];\n    }\n  }\n\n  return hit;\n}\n\nexport function pickLine(a, p) {\n  var t = Math.pow(a[0].strokeWidth || 1, 2),\n      i = a.length, dx, dy, dd;\n\n  while (--i >= 0) {\n    if (a[i].defined === false) continue;\n    dx = a[i].x - p[0];\n    dy = a[i].y - p[1];\n    dd = dx * dx + dy * dy;\n    if (dd < t) return a[i];\n  }\n\n  return null;\n}\n\nexport function pickTrail(a, p) {\n  var i = a.length, dx, dy, dd;\n\n  while (--i >= 0) {\n    if (a[i].defined === false) continue;\n    dx = a[i].x - p[0];\n    dy = a[i].y - p[1];\n    dd = dx * dx + dy * dy;\n    dx = a[i].size || 1;\n    if (dd < dx*dx) return a[i];\n  }\n\n  return null;\n}\n","import {hasCornerRadius, rectangle} from '../../path/shapes';\nimport {isFunction} from 'vega-util';\n\nexport default function(context, scene) {\n  var clip = scene.clip;\n\n  context.save();\n\n  if (isFunction(clip)) {\n    context.beginPath();\n    clip(context);\n    context.clip();\n  } else {\n    clipGroup(context, scene.group);\n  }\n}\n\nexport function clipGroup(context, group) {\n  context.beginPath();\n  hasCornerRadius(group)\n    ? rectangle(context, group, 0, 0)\n    : context.rect(0, 0, group.width || 0, group.height || 0);\n  context.clip();\n}\n","import {hasCornerRadius, rectangle} from '../path/shapes';\nimport boundStroke from '../bound/boundStroke';\nimport {intersectRect} from '../util/intersect';\nimport value from '../util/value';\nimport {pickVisit, visit} from '../util/visit';\nimport blend from '../util/canvas/blend';\nimport {clipGroup} from '../util/canvas/clip';\nimport fill from '../util/canvas/fill';\nimport stroke from '../util/canvas/stroke';\nimport {hitPath} from '../util/canvas/pick';\nimport clip from '../util/svg/clip';\nimport {translateItem} from '../util/svg/transform';\n\nfunction offset(item) {\n  const sw = value(item.strokeWidth, 1);\n  return item.strokeOffset != null ? item.strokeOffset\n    : item.stroke && sw > 0.5 && sw < 1.5 ? 0.5 - Math.abs(sw - 1)\n    : 0;\n}\n\nfunction attr(emit, item) {\n  emit('transform', translateItem(item));\n}\n\nfunction emitRectangle(emit, item) {\n  const off = offset(item);\n  emit('d', rectangle(null, item, off, off));\n}\n\nfunction background(emit, item) {\n  emit('class', 'background');\n  emit('aria-hidden', true);\n  emitRectangle(emit, item);\n}\n\nfunction foreground(emit, item) {\n  emit('class', 'foreground');\n  emit('aria-hidden', true);\n  if (item.strokeForeground) {\n    emitRectangle(emit, item);\n  } else {\n    emit('d', '');\n  }\n}\n\nfunction content(emit, item, renderer) {\n  const url = item.clip ? clip(renderer, item, item) : null;\n  emit('clip-path', url);\n}\n\nfunction bound(bounds, group) {\n  if (!group.clip && group.items) {\n    const items = group.items, m = items.length;\n    for (let j=0; j<m; ++j) {\n      bounds.union(items[j].bounds);\n    }\n  }\n\n  if ((group.clip || group.width || group.height) && !group.noBound) {\n    bounds.add(0, 0).add(group.width || 0, group.height || 0);\n  }\n\n  boundStroke(bounds, group);\n\n  return bounds.translate(group.x || 0, group.y || 0);\n}\n\nfunction rectanglePath(context, group, x, y) {\n  const off = offset(group);\n\n  context.beginPath();\n  rectangle(context, group, (x || 0) + off, (y || 0) + off);\n}\n\nconst hitBackground = hitPath(rectanglePath);\nconst hitForeground = hitPath(rectanglePath, false);\nconst hitCorner = hitPath(rectanglePath, true);\n\nfunction draw(context, scene, bounds, markTypes) {\n  visit(scene, group => {\n    const gx = group.x || 0,\n          gy = group.y || 0,\n          fore = group.strokeForeground,\n          opacity = group.opacity == null ? 1 : group.opacity;\n\n    // draw group background\n    if ((group.stroke || group.fill) && opacity) {\n      rectanglePath(context, group, gx, gy);\n      blend(context, group);\n      if (group.fill && fill(context, group, opacity)) {\n        context.fill();\n      }\n      if (group.stroke && !fore && stroke(context, group, opacity)) {\n        context.stroke();\n      }\n    }\n\n    // setup graphics context, set clip and bounds\n    context.save();\n    context.translate(gx, gy);\n    if (group.clip) clipGroup(context, group);\n    if (bounds) bounds.translate(-gx, -gy);\n\n    // draw group contents\n    visit(group, item => {\n      if (item.marktype === 'group' || markTypes == null || markTypes.includes(item.marktype)) {\n        this.draw(context, item, bounds, markTypes);\n      }\n    });\n\n    // restore graphics context\n    if (bounds) bounds.translate(gx, gy);\n    context.restore();\n\n    // draw group foreground\n    if (fore && group.stroke && opacity) {\n      rectanglePath(context, group, gx, gy);\n      blend(context, group);\n      if (stroke(context, group, opacity)) {\n        context.stroke();\n      }\n    }\n  });\n}\n\nfunction pick(context, scene, x, y, gx, gy) {\n\n  if (scene.bounds && !scene.bounds.contains(gx, gy) || !scene.items) {\n    return null;\n  }\n\n  // Added\n  // const cx = x * context.pixelRatio,\n  //       cy = y * context.pixelRatio;\n  const cx = x * context.scale,\n        cy = y * context.scale;\n\n  return pickVisit(scene, group => {\n    let hit, dx, dy;\n\n    // first hit test bounding box\n    const b = group.bounds;\n\n    if (b && !b.contains(gx, gy)) {\n      return;\n    }\n\n    // passed bounds check, test rectangular clip\n    dx = group.x || 0;\n    dy = group.y || 0;\n\n\n    const dw = dx + (group.width || 0),\n          dh = dy + (group.height || 0),\n          c = group.clip;\n    if (c && (gx < dx || gx > dw || gy < dy || gy > dh)) {\n      return;\n    }\n\n    // adjust coordinate system\n    context.save();\n    context.translate(dx, dy);\n    dx = gx - dx;\n    dy = gy - dy;\n\n    // test background for rounded corner clip\n    if (c && hasCornerRadius(group) && !hitCorner(context, group, cx, cy)) {\n      context.restore();\n      return null;\n    }\n\n    const fore = group.strokeForeground,\n          ix = scene.interactive !== false;\n\n    // hit test against group foreground\n    if (ix && fore && group.stroke\n        && hitForeground(context, group, cx, cy)) {\n      context.restore();\n      return group;\n    }\n\n    // hit test against contained marks\n    hit = pickVisit(group, mark => pickMark(mark, dx, dy)\n      ? this.pick(mark, x, y, dx, dy)\n      : null\n    );\n\n    // hit test against group background\n    if (!hit && ix && (group.fill || (!fore && group.stroke))\n        && hitBackground(context, group, cx, cy)) {\n      hit = group;\n    }\n\n    // restore state and return\n    context.restore();\n\n    return hit || null;\n  });\n}\n\nfunction pickMark(mark, x, y) {\n  return (mark.interactive !== false || mark.marktype === 'group')\n    && mark.bounds && mark.bounds.contains(x, y);\n}\n\nexport default {\n  type:       'group',\n  tag:        'g',\n  nested:     false,\n  attr:       attr,\n  bound:      bound,\n  draw:       draw,\n  pick:       pick,\n  isect:      intersectRect,\n  content:    content,\n  background: background,\n  foreground: foreground\n};\n","export default {\n  'xmlns': 'http://www.w3.org/2000/svg',\n  'xmlns:xlink': 'http://www.w3.org/1999/xlink',\n  'version': '1.1'\n};","import {visit} from '../util/visit';\nimport blend from '../util/canvas/blend';\nimport {pick} from '../util/canvas/pick';\nimport metadata from '../util/svg/metadata';\nimport {translate} from '../util/svg/transform';\nimport {truthy} from 'vega-util';\n\nfunction getImage(item, renderer) {\n  var image = item.image;\n  if (!image || item.url && item.url !== image.url) {\n    image = {complete: false, width: 0, height: 0};\n    renderer.loadImage(item.url).then(image => {\n      item.image = image;\n      item.image.url = item.url;\n    });\n  }\n  return image;\n}\n\nfunction imageWidth(item, image) {\n  return item.width != null ? item.width\n    : !image || !image.width ? 0\n    : item.aspect !== false && item.height ? item.height * image.width / image.height\n    : image.width;\n}\n\nfunction imageHeight(item, image) {\n  return item.height != null ? item.height\n    : !image || !image.height ? 0\n    : item.aspect !== false && item.width ? item.width * image.height / image.width\n    : image.height;\n}\n\nfunction imageXOffset(align, w) {\n  return align === 'center' ? w / 2 : align === 'right' ? w : 0;\n}\n\nfunction imageYOffset(baseline, h) {\n  return baseline === 'middle' ? h / 2 : baseline === 'bottom' ? h : 0;\n}\n\nfunction attr(emit, item, renderer) {\n  const img = getImage(item, renderer),\n        w = imageWidth(item, img),\n        h = imageHeight(item, img),\n        x = (item.x || 0) - imageXOffset(item.align, w),\n        y = (item.y || 0) - imageYOffset(item.baseline, h),\n        i = !img.src && img.toDataURL ? img.toDataURL() : img.src || '';\n\n  emit('href', i, metadata['xmlns:xlink'], 'xlink:href');\n  emit('transform', translate(x, y));\n  emit('width', w);\n  emit('height', h);\n  emit('preserveAspectRatio', item.aspect === false ? 'none' : 'xMidYMid');\n}\n\nfunction bound(bounds, item) {\n  const img = item.image,\n        w = imageWidth(item, img),\n        h = imageHeight(item, img),\n        x = (item.x || 0) - imageXOffset(item.align, w),\n        y = (item.y || 0) - imageYOffset(item.baseline, h);\n\n  return bounds.set(x, y, x + w, y + h);\n}\n\nfunction draw(context, scene, bounds) {\n  visit(scene, item => {\n    if (bounds && !bounds.intersects(item.bounds)) return; // bounds check\n\n    const img = getImage(item, this);\n\n    let w = imageWidth(item, img);\n    let h = imageHeight(item, img);\n    if (w === 0 || h === 0) return; // early exit\n\n    let x = (item.x || 0) - imageXOffset(item.align, w),\n        y = (item.y || 0) - imageYOffset(item.baseline, h),\n        opacity, ar0, ar1, t;\n\n    if (item.aspect !== false) {\n      ar0 = img.width / img.height;\n      ar1 = item.width / item.height;\n      if (ar0 === ar0 && ar1 === ar1 && ar0 !== ar1) {\n        if (ar1 < ar0) {\n          t = w / ar0;\n          y += (h - t) / 2;\n          h = t;\n        } else {\n          t = h * ar0;\n          x += (w - t) / 2;\n          w = t;\n        }\n      }\n    }\n\n    if (img.complete || img.toDataURL) {\n      blend(context, item);\n      context.globalAlpha = (opacity = item.opacity) != null ? opacity : 1;\n      context.imageSmoothingEnabled = item.smooth !== false;\n      context.drawImage(img, x, y, w, h);\n    }\n  });\n}\n\nexport default {\n  type:     'image',\n  tag:      'image',\n  nested:   false,\n  attr:     attr,\n  bound:    bound,\n  draw:     draw,\n  pick:     pick(),\n  isect:    truthy, // bounds check is sufficient\n  get:      getImage,\n  xOffset:  imageXOffset,\n  yOffset:  imageYOffset\n};\n","import {line} from '../path/shapes';\nimport {pickLine} from '../util/pickPath';\nimport markMultiItemPath from './markMultiItemPath';\n\nexport default markMultiItemPath('line', line, pickLine);\n","import boundStroke from '../bound/boundStroke';\nimport context from '../bound/boundContext';\nimport pathParse from '../path/parse';\nimport pathRender from '../path/render';\nimport {intersectPath} from '../util/intersect';\nimport {drawAll} from '../util/canvas/draw';\nimport {pickPath} from '../util/canvas/pick';\nimport {transformItem} from '../util/svg/transform';\nimport {DegToRad} from '../util/constants';\n\nfunction attr(emit, item) {\n  var sx = item.scaleX || 1,\n      sy = item.scaleY || 1;\n  if (sx !== 1 || sy !== 1) {\n    emit('vector-effect', 'non-scaling-stroke');\n  }\n  emit('transform', transformItem(item));\n  emit('d', item.path);\n}\n\nfunction path(context, item) {\n  var path = item.path;\n  if (path == null) return true;\n\n  var x = item.x || 0,\n      y = item.y || 0,\n      sx = item.scaleX || 1,\n      sy = item.scaleY || 1,\n      a = (item.angle || 0) * DegToRad,\n      cache = item.pathCache;\n\n  if (!cache || cache.path !== path) {\n    (item.pathCache = cache = pathParse(path)).path = path;\n  }\n\n  if (a && context.rotate && context.translate) {\n    context.translate(x, y);\n    context.rotate(a);\n    pathRender(context, cache, 0, 0, sx, sy);\n    context.rotate(-a);\n    context.translate(-x, -y);\n  } else {\n    pathRender(context, cache, x, y, sx, sy);\n  }\n}\n\nfunction bound(bounds, item) {\n  return path(context(bounds, item.angle), item)\n    ? bounds.set(0, 0, 0, 0)\n    : boundStroke(bounds, item, true);\n}\n\nexport default {\n  type:   'path',\n  tag:    'path',\n  nested: false,\n  attr:   attr,\n  bound:  bound,\n  draw:   drawAll(path),\n  pick:   pickPath(path),\n  isect:  intersectPath(path)\n};\n","import boundStroke from '../bound/boundStroke';\nimport {rectangle} from '../path/shapes';\nimport {intersectRect} from '../util/intersect';\nimport {drawAll} from '../util/canvas/draw';\nimport {pickPath} from '../util/canvas/pick';\n\nfunction attr(emit, item) {\n  emit('d', rectangle(null, item));\n}\n\nfunction bound(bounds, item) {\n  var x, y;\n  return boundStroke(bounds.set(\n    x = item.x || 0,\n    y = item.y || 0,\n    (x + item.width) || 0,\n    (y + item.height) || 0\n  ), item);\n}\n\nfunction draw(context, item) {\n  context.beginPath();\n  rectangle(context, item);\n}\n\nexport default {\n  type:   'rect',\n  tag:    'path',\n  nested: false,\n  attr:   attr,\n  bound:  bound,\n  draw:   drawAll(draw),\n  pick:   pickPath(draw),\n  isect:  intersectRect\n};\n","import boundStroke from '../bound/boundStroke';\nimport {intersectRule} from '../util/intersect';\nimport {visit} from '../util/visit';\nimport blend from '../util/canvas/blend';\nimport {pick} from '../util/canvas/pick';\nimport stroke from '../util/canvas/stroke';\nimport {translateItem} from '../util/svg/transform';\n\nfunction attr(emit, item) {\n  emit('transform', translateItem(item));\n  emit('x2', item.x2 != null ? item.x2 - (item.x || 0) : 0);\n  emit('y2', item.y2 != null ? item.y2 - (item.y || 0) : 0);\n}\n\nfunction bound(bounds, item) {\n  var x1, y1;\n  return boundStroke(bounds.set(\n    x1 = item.x || 0,\n    y1 = item.y || 0,\n    item.x2 != null ? item.x2 : x1,\n    item.y2 != null ? item.y2 : y1\n  ), item);\n}\n\nfunction path(context, item, opacity) {\n  var x1, y1, x2, y2;\n\n  if (item.stroke && stroke(context, item, opacity)) {\n    x1 = item.x || 0;\n    y1 = item.y || 0;\n    x2 = item.x2 != null ? item.x2 : x1;\n    y2 = item.y2 != null ? item.y2 : y1;\n    context.beginPath();\n    context.moveTo(x1, y1);\n    context.lineTo(x2, y2);\n    return true;\n  }\n  return false;\n}\n\nfunction draw(context, scene, bounds) {\n  visit(scene, item => {\n    if (bounds && !bounds.intersects(item.bounds)) return; // bounds check\n    var opacity = item.opacity == null ? 1 : item.opacity;\n    if (opacity && path(context, item, opacity)) {\n      blend(context, item);\n      context.stroke();\n    }\n  });\n}\n\nfunction hit(context, item, x, y) {\n  if (!context.isPointInStroke) return false;\n  return path(context, item, 1) && context.isPointInStroke(x, y);\n}\n\nexport default {\n  type:   'rule',\n  tag:    'line',\n  nested: false,\n  attr:   attr,\n  bound:  bound,\n  draw:   draw,\n  pick:   pick(hit),\n  isect:  intersectRule\n};\n","import {shape} from '../path/shapes';\nimport markItemPath from './markItemPath';\n\nexport default markItemPath('shape', shape);\n","import {symbol} from '../path/shapes';\nimport {intersectPoint} from '../util/intersect';\nimport markItemPath from './markItemPath';\n\nexport default markItemPath('symbol', symbol, intersectPoint);\n","import {context} from './canvas/context';\nimport {isArray, lruCache} from 'vega-util';\n\n// memoize text width measurement\nconst widthCache = lruCache();\n\nexport var textMetrics = {\n  height: fontSize,\n  measureWidth: measureWidth,\n  estimateWidth: estimateWidth,\n  width: estimateWidth,\n  canvas: useCanvas\n};\n\nuseCanvas(true);\n\nfunction useCanvas(use) {\n  textMetrics.width = (use && context) ? measureWidth : estimateWidth;\n}\n\n// make simple estimate if no canvas is available\nfunction estimateWidth(item, text) {\n  return _estimateWidth(textValue(item, text), fontSize(item));\n}\n\nfunction _estimateWidth(text, currentFontHeight) {\n  return ~~(0.8 * text.length * currentFontHeight);\n}\n\n// measure text width if canvas is available\nfunction measureWidth(item, text) {\n  return fontSize(item) <= 0 || !(text = textValue(item, text)) ? 0\n    : _measureWidth(text, font(item));\n}\n\nfunction _measureWidth(text, currentFont) {\n  const key = `(${currentFont}) ${text}`;\n  let width = widthCache.get(key);\n  if (width === undefined) {\n    context.font = currentFont;\n    width = context.measureText(text).width;\n    widthCache.set(key, width);\n  }\n  return width;\n}\n\nexport function fontSize(item) {\n  return item.fontSize != null ? (+item.fontSize || 0) : 11;\n}\n\nexport function lineHeight(item) {\n  return item.lineHeight != null ? item.lineHeight : (fontSize(item) + 2);\n}\n\nfunction lineArray(_) {\n  return isArray(_) ? _.length > 1 ? _ : _[0] : _;\n}\n\nexport function textLines(item) {\n  return lineArray(\n    item.lineBreak && item.text && !isArray(item.text)\n      ? item.text.split(item.lineBreak)\n      : item.text\n  );\n}\n\nexport function multiLineOffset(item) {\n  const tl = textLines(item);\n  return (isArray(tl) ? (tl.length - 1) : 0) * lineHeight(item);\n}\n\nexport function textValue(item, line) {\n  const text = line == null ? '' : (line + '').trim();\n  return item.limit > 0 && text.length ? truncate(item, text) : text;\n}\n\nfunction widthGetter(item) {\n  if (textMetrics.width === measureWidth) {\n    // we are using canvas\n    const currentFont = font(item);\n    return text => _measureWidth(text, currentFont);\n  } else if (textMetrics.width === estimateWidth) {\n    // we are relying on estimates\n    const currentFontHeight = fontSize(item);\n    return text => _estimateWidth(text, currentFontHeight);\n  } else {\n    // User defined textMetrics.width function in use (e.g. vl-convert)\n    return text => textMetrics.width(item, text);\n  }\n}\n\nfunction truncate(item, text) {\n  var limit = +item.limit,\n      width = widthGetter(item);\n\n  if (width(text) < limit) return text;\n\n  var ellipsis = item.ellipsis || '\\u2026',\n      rtl = item.dir === 'rtl',\n      lo = 0,\n      hi = text.length, mid;\n\n  limit -= width(ellipsis);\n\n  if (rtl) {\n    while (lo < hi) {\n      mid = (lo + hi >>> 1);\n      if (width(text.slice(mid)) > limit) lo = mid + 1;\n      else hi = mid;\n    }\n    return ellipsis + text.slice(lo);\n  } else {\n    while (lo < hi) {\n      mid = 1 + (lo + hi >>> 1);\n      if (width(text.slice(0, mid)) < limit) lo = mid;\n      else hi = mid - 1;\n    }\n    return text.slice(0, lo) + ellipsis;\n  }\n}\n\nexport function fontFamily(item, quote) {\n  var font = item.font;\n  return (quote && font\n    ? String(font).replace(/\"/g, '\\'')\n    : font) || 'sans-serif';\n}\n\nexport function font(item, quote) {\n  return '' +\n    (item.fontStyle ? item.fontStyle + ' ' : '') +\n    (item.fontVariant ? item.fontVariant + ' ' : '') +\n    (item.fontWeight ? item.fontWeight + ' ' : '') +\n    fontSize(item) + 'px ' +\n    fontFamily(item, quote);\n}\n\nexport function offset(item) {\n  // perform our own font baseline calculation\n  // why? not all browsers support SVG 1.1 'alignment-baseline' :(\n  // this also ensures consistent layout across renderers\n  var baseline = item.baseline,\n      h = fontSize(item);\n\n  return Math.round(\n    baseline === 'top'         ?  0.79 * h :\n    baseline === 'middle'      ?  0.30 * h :\n    baseline === 'bottom'      ? -0.21 * h :\n    baseline === 'line-top'    ?  0.29 * h + 0.5 * lineHeight(item) :\n    baseline === 'line-bottom' ?  0.29 * h - 0.5 * lineHeight(item) : 0\n  );\n}\n","import Bounds from '../Bounds';\nimport {DegToRad, HalfPi} from '../util/constants';\nimport {font, lineHeight, offset, textLines, textMetrics, textValue} from '../util/text';\nimport {intersectBoxLine} from '../util/intersect';\nimport {visit} from '../util/visit';\nimport blend from '../util/canvas/blend';\nimport fill from '../util/canvas/fill';\nimport {pick} from '../util/canvas/pick';\nimport stroke from '../util/canvas/stroke';\nimport {rotate, translate} from '../util/svg/transform';\nimport {isArray} from 'vega-util';\n\nconst textAlign = {\n  'left':   'start',\n  'center': 'middle',\n  'right':  'end'\n};\n\nconst tempBounds = new Bounds();\n\nfunction anchorPoint(item) {\n  var x = item.x || 0,\n      y = item.y || 0,\n      r = item.radius || 0, t;\n\n  if (r) {\n    t = (item.theta || 0) - HalfPi;\n    x += r * Math.cos(t);\n    y += r * Math.sin(t);\n  }\n\n  tempBounds.x1 = x;\n  tempBounds.y1 = y;\n  return tempBounds;\n}\n\nfunction attr(emit, item) {\n  var dx = item.dx || 0,\n      dy = (item.dy || 0) + offset(item),\n      p = anchorPoint(item),\n      x = p.x1,\n      y = p.y1,\n      a = item.angle || 0, t;\n\n  emit('text-anchor', textAlign[item.align] || 'start');\n\n  if (a) {\n    t = translate(x, y) + ' ' + rotate(a);\n    if (dx || dy) t += ' ' + translate(dx, dy);\n  } else {\n    t = translate(x + dx, y + dy);\n  }\n  emit('transform', t);\n}\n\nfunction bound(bounds, item, mode) {\n  var h = textMetrics.height(item),\n      a = item.align,\n      p = anchorPoint(item),\n      x = p.x1,\n      y = p.y1,\n      dx = item.dx || 0,\n      dy = (item.dy || 0) + offset(item) - Math.round(0.8*h), // use 4/5 offset\n      tl = textLines(item),\n      w;\n\n  // get dimensions\n  if (isArray(tl)) {\n    // multi-line text\n    h += lineHeight(item) * (tl.length - 1);\n    w = tl.reduce((w, t) => Math.max(w, textMetrics.width(item, t)), 0);\n  } else {\n    // single-line text\n    w = textMetrics.width(item, tl);\n  }\n\n  // horizontal alignment\n  if (a === 'center') {\n    dx -= (w / 2);\n  } else if (a === 'right') {\n    dx -= w;\n  } else {\n    // left by default, do nothing\n  }\n\n  bounds.set(dx+=x, dy+=y, dx+w, dy+h);\n\n  if (item.angle && !mode) {\n    bounds.rotate(item.angle * DegToRad, x, y);\n  } else if (mode === 2) {\n    return bounds.rotatedPoints(item.angle * DegToRad, x, y);\n  }\n  return bounds;\n}\n\nfunction draw(context, scene, bounds) {\n  visit(scene, item => {\n    var opacity = item.opacity == null ? 1 : item.opacity,\n        p, x, y, i, lh, tl, str;\n\n    if (bounds && !bounds.intersects(item.bounds) || // bounds check\n        opacity === 0 || item.fontSize <= 0 ||\n        item.text == null || item.text.length === 0) return;\n\n    context.font = font(item);\n    context.textAlign = item.align || 'left';\n\n    p = anchorPoint(item);\n    x = p.x1,\n    y = p.y1;\n\n    if (item.angle) {\n      context.save();\n      context.translate(x, y);\n      context.rotate(item.angle * DegToRad);\n      x = y = 0; // reset x, y\n    }\n    x += (item.dx || 0);\n    y += (item.dy || 0) + offset(item);\n\n    tl = textLines(item);\n    blend(context, item);\n    if (isArray(tl)) {\n      lh = lineHeight(item);\n      for (i=0; i<tl.length; ++i) {\n        str = textValue(item, tl[i]);\n        if (item.fill && fill(context, item, opacity)) {\n          context.fillText(str, x, y);\n        }\n        if (item.stroke && stroke(context, item, opacity)) {\n          context.strokeText(str, x, y);\n        }\n        y += lh;\n      }\n    } else {\n      str = textValue(item, tl);\n      if (item.fill && fill(context, item, opacity)) {\n        context.fillText(str, x, y);\n      }\n      if (item.stroke && stroke(context, item, opacity)) {\n        context.strokeText(str, x, y);\n      }\n    }\n\n    if (item.angle) context.restore();\n  });\n}\n\nfunction hit(context, item, x, y, gx, gy) {\n  if (item.fontSize <= 0) return false;\n  if (!item.angle) return true; // bounds sufficient if no rotation\n\n  // project point into space of unrotated bounds\n  var p = anchorPoint(item),\n      ax = p.x1,\n      ay = p.y1,\n      b = bound(tempBounds, item, 1),\n      a = -item.angle * DegToRad,\n      cos = Math.cos(a),\n      sin = Math.sin(a),\n      px = cos * gx - sin * gy + (ax - cos * ax + sin * ay),\n      py = sin * gx + cos * gy + (ay - sin * ax - cos * ay);\n\n  return b.contains(px, py);\n}\n\nfunction intersectText(item, box) {\n  const p = bound(tempBounds, item, 2);\n  return intersectBoxLine(box, p[0], p[1], p[2], p[3])\n      || intersectBoxLine(box, p[0], p[1], p[4], p[5])\n      || intersectBoxLine(box, p[4], p[5], p[6], p[7])\n      || intersectBoxLine(box, p[2], p[3], p[6], p[7]);\n}\n\nexport default {\n  type:   'text',\n  tag:    'text',\n  nested: false,\n  attr:   attr,\n  bound:  bound,\n  draw:   draw,\n  pick:   pick(hit),\n  isect:  intersectText\n};\n","import {trail} from '../path/shapes';\nimport {pickTrail} from '../util/pickPath';\nimport markMultiItemPath from './markMultiItemPath';\n\nexport default markMultiItemPath('trail', trail, pickTrail);\n","import arc from './arc';\nimport area from './area';\nimport group from './group';\nimport image from './image';\nimport line from './line';\nimport path from './path';\nimport rect from './rect';\nimport rule from './rule';\nimport shape from './shape';\nimport symbol from './symbol';\nimport text from './text';\nimport trail from './trail';\n\nexport default {\n  arc:     arc,\n  area:    area,\n  group:   group,\n  image:   image,\n  line:    line,\n  path:    path,\n  rect:    rect,\n  rule:    rule,\n  shape:   shape,\n  symbol:  symbol,\n  text:    text,\n  trail:   trail\n};\n","import Bounds from '../Bounds';\nimport marks from '../marks/index';\n\nexport default function(item, func, opt) {\n  var type = marks[item.mark.marktype],\n      bound = func || type.bound;\n  if (type.nested) item = item.mark;\n\n  return bound(item.bounds || (item.bounds = new Bounds()), item, opt);\n}\n","import Bounds from '../Bounds';\nimport boundItem from './boundItem';\nimport marks from '../marks/index';\n\nvar DUMMY = {mark: null};\n\nexport default function(mark, bounds, opt) {\n  var type  = marks[mark.marktype],\n      bound = type.bound,\n      items = mark.items,\n      hasItems = items && items.length,\n      i, n, item, b;\n\n  if (type.nested) {\n    if (hasItems) {\n      item = items[0];\n    } else {\n      // no items, fake it\n      DUMMY.mark = mark;\n      item = DUMMY;\n    }\n    b = boundItem(item, bound, opt);\n    bounds = bounds && bounds.union(b) || b;\n    return bounds;\n  }\n\n  bounds = bounds\n    || mark.bounds && mark.bounds.clear()\n    || new Bounds();\n\n  if (hasItems) {\n    for (i=0, n=items.length; i<n; ++i) {\n      bounds.union(boundItem(items[i], bound, opt));\n    }\n  }\n\n  return mark.bounds = bounds;\n}\n","import boundMark from '../bound/boundMark';\n\nconst keys = [\n  'marktype', 'name', 'role', 'interactive', 'clip', 'items', 'zindex',\n  'x', 'y', 'width', 'height', 'align', 'baseline',             // layout\n  'fill', 'fillOpacity', 'opacity', 'blend',                    // fill\n  'stroke', 'strokeOpacity', 'strokeWidth', 'strokeCap',        // stroke\n  'strokeDash', 'strokeDashOffset',                             // stroke dash\n  'strokeForeground', 'strokeOffset',                           // group\n  'startAngle', 'endAngle', 'innerRadius', 'outerRadius',       // arc\n  'cornerRadius', 'padAngle',                                   // arc, rect\n  'cornerRadiusTopLeft', 'cornerRadiusTopRight',                // rect, group\n  'cornerRadiusBottomLeft', 'cornerRadiusBottomRight',\n  'interpolate', 'tension', 'orient', 'defined',                // area, line\n  'url', 'aspect', 'smooth',                                    // image\n  'path', 'scaleX', 'scaleY',                                   // path\n  'x2', 'y2',                                                   // rule\n  'size', 'shape',                                              // symbol\n  'text', 'angle', 'theta', 'radius', 'dir', 'dx', 'dy',        // text\n  'ellipsis', 'limit', 'lineBreak', 'lineHeight',\n  'font', 'fontSize', 'fontWeight', 'fontStyle', 'fontVariant', // font\n  'description', 'aria', 'ariaRole', 'ariaRoleDescription'      // aria\n];\n\nexport function sceneToJSON(scene, indent) {\n  return JSON.stringify(scene, keys, indent);\n}\n\nexport function sceneFromJSON(json) {\n  const scene = (typeof json === 'string' ? JSON.parse(json) : json);\n  return initialize(scene);\n}\n\nfunction initialize(scene) {\n  var type = scene.marktype,\n      items = scene.items,\n      parent, i, n;\n\n  if (items) {\n    for (i=0, n=items.length; i<n; ++i) {\n      parent = type ? 'mark' : 'group';\n      items[i][parent] = scene;\n      if (items[i].zindex) items[i][parent].zdirty = true;\n      if ('group' === (type || parent)) initialize(items[i]);\n    }\n  }\n\n  if (type) boundMark(scene);\n  return scene;\n}\n","import Bounds from './Bounds';\nimport GroupItem from './GroupItem';\nimport {sceneFromJSON, sceneToJSON} from './util/serialize';\n\nexport default class Scenegraph {\n  constructor(scene) {\n    if (arguments.length) {\n      this.root = sceneFromJSON(scene);\n    } else {\n      this.root = createMark({\n        marktype: 'group',\n        name: 'root',\n        role: 'frame'\n      });\n      this.root.items = [new GroupItem(this.root)];\n    }\n  }\n\n  toJSON(indent) {\n    return sceneToJSON(this.root, indent || 0);\n  }\n\n  mark(markdef, group, index) {\n    group = group || this.root.items[0];\n    const mark = createMark(markdef, group);\n    group.items[index] = mark;\n    if (mark.zindex) mark.group.zdirty = true;\n    return mark;\n  }\n}\n\n\nfunction createMark(def, group) {\n  const mark = {\n    bounds:      new Bounds(),\n    clip:        !!def.clip,\n    group:       group,\n    interactive: def.interactive === false ? false : true,\n    items:       [],\n    marktype:    def.marktype,\n    name:        def.name || undefined,\n    role:        def.role || undefined,\n    zindex:      def.zindex || 0\n  };\n\n  // add accessibility properties if defined\n  if (def.aria != null) {\n    mark.aria = def.aria;\n  }\n  if (def.description) {\n    mark.description = def.description;\n  }\n\n  return mark;\n}\n","// create a new DOM element\nexport function domCreate(doc, tag, ns) {\n  if (!doc && typeof document !== 'undefined' && document.createElement) {\n    doc = document;\n  }\n  return doc\n    ? (ns ? doc.createElementNS(ns, tag) : doc.createElement(tag))\n    : null;\n}\n\n// find first child element with matching tag\nexport function domFind(el, tag) {\n  tag = tag.toLowerCase();\n  var nodes = el.childNodes, i = 0, n = nodes.length;\n  for (; i<n; ++i) if (nodes[i].tagName.toLowerCase() === tag) {\n    return nodes[i];\n  }\n}\n\n// retrieve child element at given index\n// create & insert if doesn't exist or if tags do not match\nexport function domChild(el, index, tag, ns) {\n  var a = el.childNodes[index], b;\n  if (!a || a.tagName.toLowerCase() !== tag.toLowerCase()) {\n    b = a || null;\n    a = domCreate(el.ownerDocument, tag, ns);\n    el.insertBefore(a, b);\n  }\n  return a;\n}\n\n// remove all child elements at or above the given index\nexport function domClear(el, index) {\n  var nodes = el.childNodes,\n      curr = nodes.length;\n  while (curr > index) el.removeChild(nodes[--curr]);\n  return el;\n}\n\n// generate css class name for mark\nexport function cssClass(mark) {\n  return 'mark-' + mark.marktype\n    + (mark.role ? ' role-' + mark.role : '')\n    + (mark.name ? ' ' + mark.name : '');\n}\n","export default function(event, el) {\n  const rect = el.getBoundingClientRect();\n  const point = [\n    event.clientX - rect.left - (el.clientLeft || 0),\n    event.clientY - rect.top - (el.clientTop || 0)\n  ];\n  return point;\n}\n","import {domCreate} from './util/dom';\nimport resolveItem from './util/resolveItem';\nimport {loader} from 'vega-loader';\n\nexport default class Handler {\n  /**\n   * Create a new Handler instance.\n   * @param {object} [customLoader] - Optional loader instance for\n   *   href URL sanitization. If not specified, a standard loader\n   *   instance will be generated.\n   * @param {function} [customTooltip] - Optional tooltip handler\n   *   function for custom tooltip display.\n   * @constructor\n   */\n  constructor(customLoader, customTooltip) {\n    this._active = null;\n    this._handlers = {};\n    this._loader = customLoader || loader();\n    this._tooltip = customTooltip || defaultTooltip;\n  }\n\n  /**\n   * Initialize a new Handler instance.\n   * @param {DOMElement} el - The containing DOM element for the display.\n   * @param {Array<number>} origin - The origin of the display, in pixels.\n   *   The coordinate system will be translated to this point.\n   * @param {object} [obj] - Optional context object that should serve as\n   *   the \"this\" context for event callbacks.\n   * @return {Handler} - This handler instance.\n   */\n  initialize(el, origin, obj) {\n    this._el = el;\n    this._obj = obj || null;\n    return this.origin(origin);\n  }\n\n  /**\n   * Returns the parent container element for a visualization.\n   * @return {DOMElement} - The containing DOM element.\n   */\n  element() {\n    return this._el;\n  }\n\n  /**\n   * Returns the scene element (e.g., canvas or SVG) of the visualization\n   * Subclasses must override if the first child is not the scene element.\n   * @return {DOMElement} - The scene (e.g., canvas or SVG) element.\n   */\n  canvas() {\n    return this._el && this._el.firstChild;\n  }\n\n  /**\n   * Get / set the origin coordinates of the visualization.\n   */\n  origin(origin) {\n    if (arguments.length) {\n      this._origin = origin || [0, 0];\n      return this;\n    } else {\n      return this._origin.slice();\n    }\n  }\n\n  /**\n   * Get / set the scenegraph root.\n   */\n  scene(scene) {\n    if (!arguments.length) return this._scene;\n    this._scene = scene;\n    return this;\n  }\n\n  /**\n   * Add an event handler. Subclasses should override this method.\n   */\n  on( /*type, handler*/) { }\n\n  /**\n   * Remove an event handler. Subclasses should override this method.\n   */\n  off( /*type, handler*/) { }\n\n  /**\n   * Utility method for finding the array index of an event handler.\n   * @param {Array} h - An array of registered event handlers.\n   * @param {string} type - The event type.\n   * @param {function} handler - The event handler instance to find.\n   * @return {number} - The handler's array index or -1 if not registered.\n   */\n  _handlerIndex(h, type, handler) {\n    for (let i = h ? h.length : 0; --i >= 0;) {\n      if (h[i].type === type && (!handler || h[i].handler === handler)) {\n        return i;\n      }\n    }\n    return -1;\n  }\n\n  /**\n   * Returns an array with registered event handlers.\n   * @param {string} [type] - The event type to query. Any annotations\n   *   are ignored; for example, for the argument \"click.foo\", \".foo\" will\n   *   be ignored and the method returns all \"click\" handlers. If type is\n   *   null or unspecified, this method returns handlers for all types.\n   * @return {Array} - A new array containing all registered event handlers.\n   */\n  handlers(type) {\n    const h = this._handlers, a = [];\n    if (type) {\n      a.push(...h[this.eventName(type)]);\n    } else {\n      for (const k in h) { a.push(...h[k]); }\n    }\n    return a;\n  }\n\n  /**\n   * Parses an event name string to return the specific event type.\n   * For example, given \"click.foo\" returns \"click\"\n   * @param {string} name - The input event type string.\n   * @return {string} - A string with the event type only.\n   */\n  eventName(name) {\n    const i = name.indexOf('.');\n    return i < 0 ? name : name.slice(0, i);\n  }\n\n  /**\n   * Handle hyperlink navigation in response to an item.href value.\n   * @param {Event} event - The event triggering hyperlink navigation.\n   * @param {Item} item - The scenegraph item.\n   * @param {string} href - The URL to navigate to.\n   */\n  handleHref(event, item, href) {\n    this._loader\n      .sanitize(href, { context: 'href' })\n      .then(opt => {\n        const e = new MouseEvent(event.type, event), a = domCreate(null, 'a');\n        for (const name in opt) a.setAttribute(name, opt[name]);\n        a.dispatchEvent(e);\n      })\n      .catch(() => { });\n  }\n\n  /**\n   * Handle tooltip display in response to an item.tooltip value.\n   * @param {Event} event - The event triggering tooltip display.\n   * @param {Item} item - The scenegraph item.\n   * @param {boolean} show - A boolean flag indicating whether\n   *   to show or hide a tooltip for the given item.\n   */\n  handleTooltip(event, item, show) {\n    if (item && item.tooltip != null) {\n      item = resolveItem(item, event, this.canvas(), this._origin);\n      const value = (show && item && item.tooltip) || null;\n      this._tooltip.call(this._obj, this, event, item, value);\n    }\n  }\n\n  /**\n   * Returns the size of a scenegraph item and its position relative\n   * to the viewport.\n   * @param {Item} item - The scenegraph item.\n   * @return {object} - A bounding box object (compatible with the\n   *   DOMRect type) consisting of x, y, width, heigh, top, left,\n   *   right, and bottom properties.\n   */\n  getItemBoundingClientRect(item) {\n    const el = this.canvas();\n    if (!el) return;\n\n    const rect = el.getBoundingClientRect(), origin = this._origin, bounds = item.bounds, width = bounds.width(), height = bounds.height();\n\n    let x = bounds.x1 + origin[0] + rect.left, y = bounds.y1 + origin[1] + rect.top;\n\n    // translate coordinate for each parent group\n    while (item.mark && (item = item.mark.group)) {\n      x += item.x || 0;\n      y += item.y || 0;\n    }\n\n    // return DOMRect-compatible bounding box\n    return {\n      x, y, width, height,\n      left: x, top: y, right: x + width, bottom: y + height\n    };\n  }\n}\n\n// The default tooltip display handler.\n// Sets the HTML title attribute on the visualization container.\nfunction defaultTooltip(handler, event, item, value) {\n  handler.element().setAttribute('title', value || '');\n}\n\n\n","import marks from '../marks/index';\nimport point from './point';\n\nexport default function(item, event, el, origin) {\n  var mark = item && item.mark,\n      mdef, p;\n\n  if (mark && (mdef = marks[mark.marktype]).tip) {\n    p = point(event, el);\n    p[0] -= origin[0];\n    p[1] -= origin[1];\n    while (item = item.mark.group) {\n      p[0] -= item.x || 0;\n      p[1] -= item.y || 0;\n    }\n    item = mdef.tip(mark.items, p);\n  }\n\n  return item;\n}\n","import ResourceLoader from './ResourceLoader';\n\nexport default class Renderer {\n  /**\n   * Create a new Renderer instance.\n   * @param {object} [loader] - Optional loader instance for\n   *   image and href URL sanitization. If not specified, a\n   *   standard loader instance will be generated.\n   * @constructor\n   */\n  constructor(loader) {\n    this._el = null;\n    this._bgcolor = null;\n    this._loader = new ResourceLoader(loader);\n  }\n\n  /**\n   * Initialize a new Renderer instance.\n   * @param {DOMElement} el - The containing DOM element for the display.\n   * @param {number} width - The coordinate width of the display, in pixels.\n   * @param {number} height - The coordinate height of the display, in pixels.\n   * @param {Array<number>} origin - The origin of the display, in pixels.\n   *   The coordinate system will be translated to this point.\n   * @param {number} [scaleFactor=1] - Optional scaleFactor by which to multiply\n   *   the width and height to determine the final pixel size.\n   * @return {Renderer} - This renderer instance.\n   */\n  initialize(el, width, height, origin, scaleFactor) {\n    this._el = el;\n    return this.resize(width, height, origin, scaleFactor);\n  }\n\n  /**\n   * Returns the parent container element for a visualization.\n   * @return {DOMElement} - The containing DOM element.\n   */\n  element() {\n    return this._el;\n  }\n\n  /**\n   * Returns the scene element (e.g., canvas or SVG) of the visualization\n   * Subclasses must override if the first child is not the scene element.\n   * @return {DOMElement} - The scene (e.g., canvas or SVG) element.\n   */\n  canvas() {\n    return this._el && this._el.firstChild;\n  }\n\n  /**\n   * Get / set the background color.\n   */\n  background(bgcolor) {\n    if (arguments.length === 0) return this._bgcolor;\n    this._bgcolor = bgcolor;\n    return this;\n  }\n\n  /**\n   * Resize the display.\n   * @param {number} width - The new coordinate width of the display, in pixels.\n   * @param {number} height - The new coordinate height of the display, in pixels.\n   * @param {Array<number>} origin - The new origin of the display, in pixels.\n   *   The coordinate system will be translated to this point.\n   * @param {number} [scaleFactor=1] - Optional scaleFactor by which to multiply\n   *   the width and height to determine the final pixel size.\n   * @return {Renderer} - This renderer instance;\n   */\n  resize(width, height, origin, scaleFactor) {\n    this._width = width;\n    this._height = height;\n    this._origin = origin || [0, 0];\n    this._scale = scaleFactor || 1;\n    return this;\n  }\n\n  /**\n   * Report a dirty item whose bounds should be redrawn.\n   * This base class method does nothing. Subclasses that perform\n   * incremental should implement this method.\n   * @param {Item} item - The dirty item whose bounds should be redrawn.\n   */\n  dirty( /*item*/) { }\n\n  /**\n   * Render an input scenegraph, potentially with a set of dirty items.\n   * This method will perform an immediate rendering with available resources.\n   * The renderer may also need to perform image loading to perform a complete\n   * render. This process can lead to asynchronous re-rendering of the scene\n   * after this method returns. To receive notification when rendering is\n   * complete, use the renderAsync method instead.\n   * @param {object} scene - The root mark of a scenegraph to render.\n   * @param {Array} markTypes - Array of the mark types to render.\n   *                            If undefined, render all mark types\n   * @return {Renderer} - This renderer instance.\n   */\n  render(scene, markTypes) {\n    const r = this;\n\n    // bind arguments into a render call, and cache it\n    // this function may be subsequently called for async redraw\n    r._call = function () { r._render(scene, markTypes); };\n\n    // invoke the renderer\n    r._call();\n\n    // clear the cached call for garbage collection\n    // async redraws will stash their own copy\n    r._call = null;\n\n    return r;\n  }\n\n  /**\n   * Internal rendering method. Renderer subclasses should override this\n   * method to actually perform rendering.\n   * @param {object} scene - The root mark of a scenegraph to render.\n   * @param {Array} markTypes - Array of the mark types to render.\n   *                            If undefined, render all mark types\n   */\n  _render( /*scene, markTypes*/) {\n    // subclasses to override\n  }\n\n  /**\n   * Asynchronous rendering method. Similar to render, but returns a Promise\n   * that resolves when all rendering is completed. Sometimes a renderer must\n   * perform image loading to get a complete rendering. The returned\n   * Promise will not resolve until this process completes.\n   * @param {object} scene - The root mark of a scenegraph to render.\n   * @param {Array} markTypes - Array of the mark types to render.\n   *                            If undefined, render all mark types\n   * @return {Promise} - A Promise that resolves when rendering is complete.\n   */\n  renderAsync(scene, markTypes) {\n    const r = this.render(scene, markTypes);\n    return this._ready\n      ? this._ready.then(() => r)\n      : Promise.resolve(r);\n  }\n\n  /**\n   * Internal method for asynchronous resource loading.\n   * Proxies method calls to the ImageLoader, and tracks loading\n   * progress to invoke a re-render once complete.\n   * @param {string} method - The method name to invoke on the ImageLoader.\n   * @param {string} uri - The URI for the requested resource.\n   * @return {Promise} - A Promise that resolves to the requested resource.\n   */\n  _load(method, uri) {\n    var r = this, p = r._loader[method](uri);\n\n    if (!r._ready) {\n      // re-render the scene when loading completes\n      const call = r._call;\n      r._ready = r._loader.ready()\n        .then(redraw => {\n          if (redraw) call();\n          r._ready = null;\n        });\n    }\n\n    return p;\n  }\n\n  /**\n   * Sanitize a URL to include as a hyperlink in the rendered scene.\n   * This method proxies a call to ImageLoader.sanitizeURL, but also tracks\n   * image loading progress and invokes a re-render once complete.\n   * @param {string} uri - The URI string to sanitize.\n   * @return {Promise} - A Promise that resolves to the sanitized URL.\n   */\n  sanitizeURL(uri) {\n    return this._load('sanitizeURL', uri);\n  }\n\n  /**\n   * Requests an image to include in the rendered scene.\n   * This method proxies a call to ImageLoader.loadImage, but also tracks\n   * image loading progress and invokes a re-render once complete.\n   * @param {string} uri - The URI string of the image.\n   * @return {Promise} - A Promise that resolves to the loaded Image.\n   */\n  loadImage(uri) {\n    return this._load('loadImage', uri);\n  }\n}\n\n","export const KeyDownEvent = 'keydown';\nexport const KeyPressEvent = 'keypress';\nexport const KeyUpEvent = 'keyup';\nexport const DragEnterEvent = 'dragenter';\nexport const DragLeaveEvent = 'dragleave';\nexport const DragOverEvent = 'dragover';\nexport const PointerDownEvent = 'pointerdown';\nexport const PointerUpEvent = 'pointerup';\nexport const PointerMoveEvent = 'pointermove';\nexport const PointerOutEvent = 'pointerout';\nexport const PointerOverEvent = 'pointerover';\nexport const MouseDownEvent = 'mousedown';\nexport const MouseUpEvent = 'mouseup';\nexport const MouseMoveEvent = 'mousemove';\nexport const MouseOutEvent = 'mouseout';\nexport const MouseOverEvent = 'mouseover';\nexport const ClickEvent = 'click';\nexport const DoubleClickEvent = 'dblclick';\nexport const WheelEvent = 'wheel';\nexport const MouseWheelEvent = 'mousewheel';\nexport const TouchStartEvent = 'touchstart';\nexport const TouchMoveEvent = 'touchmove';\nexport const TouchEndEvent = 'touchend';\n\nexport const Events = [\n  KeyDownEvent,\n  KeyPressEvent,\n  KeyUpEvent,\n  DragEnterEvent,\n  DragLeaveEvent,\n  DragOverEvent,\n  PointerDownEvent,\n  PointerUpEvent,\n  PointerMoveEvent,\n  PointerOutEvent,\n  PointerOverEvent,\n  MouseDownEvent,\n  MouseUpEvent,\n  MouseMoveEvent,\n  MouseOutEvent,\n  MouseOverEvent,\n  ClickEvent,\n  DoubleClickEvent,\n  WheelEvent,\n  MouseWheelEvent,\n  TouchStartEvent,\n  TouchMoveEvent,\n  TouchEndEvent\n];\n\nexport const TooltipShowEvent = PointerMoveEvent;\n\nexport const TooltipHideEvent = PointerOutEvent;\n\nexport const HrefEvent = ClickEvent;\n","import Handler from './Handler';\nimport Marks from './marks/index';\nimport {\n  ClickEvent,\n  DragEnterEvent, DragLeaveEvent, DragOverEvent, Events, HrefEvent,\n  MouseDownEvent, MouseMoveEvent, MouseOutEvent, MouseOverEvent,\n  MouseWheelEvent,\n  PointerDownEvent, PointerMoveEvent, PointerOutEvent, PointerOverEvent,\n  TooltipHideEvent, TooltipShowEvent,\n  TouchEndEvent, TouchMoveEvent, TouchStartEvent\n} from './util/events';\nimport point from './util/point';\nimport {domFind} from './util/dom';\n\nexport default class CanvasHandler extends Handler {\n  constructor(loader, tooltip) {\n    super(loader, tooltip);\n    this._down = null;\n    this._touch = null;\n    this._first = true;\n    this._events = {};\n\n    // supported events\n    this.events = Events;\n    this.pointermove = move(\n      [PointerMoveEvent, MouseMoveEvent],\n      [PointerOverEvent, MouseOverEvent],\n      [PointerOutEvent, MouseOutEvent]\n    );\n\n    this.dragover = move([DragOverEvent], [DragEnterEvent], [DragLeaveEvent]),\n\n    this.pointerout = inactive([PointerOutEvent, MouseOutEvent]);\n    this.dragleave = inactive([DragLeaveEvent]);\n  }\n\n  initialize(el, origin, obj) {\n    this._canvas = el && domFind(el, 'canvas');\n\n    // add minimal events required for proper state management\n    [\n      ClickEvent, MouseDownEvent,\n      PointerDownEvent, PointerMoveEvent, PointerOutEvent,\n      DragLeaveEvent\n    ].forEach(type => eventListenerCheck(this, type));\n\n    return super.initialize(el, origin, obj);\n  }\n\n  // return the backing canvas instance\n  canvas() {\n    return this._canvas;\n  }\n\n  // retrieve the current canvas context\n  context() {\n    return this._canvas.getContext('2d');\n  }\n\n\n  // to keep old versions of firefox happy\n  DOMMouseScroll(evt) {\n    this.fire(MouseWheelEvent, evt);\n  }\n\n  pointerdown(evt) {\n    this._down = this._active;\n    this.fire(PointerDownEvent, evt);\n  }\n\n  mousedown(evt) {\n    this._down = this._active;\n    this.fire(MouseDownEvent, evt);\n  }\n\n  click(evt) {\n    if (this._down === this._active) {\n      this.fire(ClickEvent, evt);\n      this._down = null;\n    }\n  }\n\n  touchstart(evt) {\n    this._touch = this.pickEvent(evt.changedTouches[0]);\n\n    if (this._first) {\n      this._active = this._touch;\n      this._first = false;\n    }\n\n    this.fire(TouchStartEvent, evt, true);\n  }\n\n  touchmove(evt) {\n    this.fire(TouchMoveEvent, evt, true);\n  }\n\n  touchend(evt) {\n    this.fire(TouchEndEvent, evt, true);\n    this._touch = null;\n  }\n\n  // fire an event\n  fire(type, evt, touch) {\n    const a = touch ? this._touch : this._active,\n          h = this._handlers[type];\n\n    // set event type relative to scenegraph items\n    evt.vegaType = type;\n\n    // handle hyperlinks and tooltips first\n    if (type === HrefEvent && a && a.href) {\n      this.handleHref(evt, a, a.href);\n    } else if (type === TooltipShowEvent || type === TooltipHideEvent) {\n      this.handleTooltip(evt, a, type !== TooltipHideEvent);\n    }\n\n    // invoke all registered handlers\n    if (h) {\n      for (let i=0, len=h.length; i<len; ++i) {\n        h[i].handler.call(this._obj, evt, a);\n      }\n    }\n  }\n\n  // add an event handler\n  on(type, handler) {\n    const name = this.eventName(type),\n          h = this._handlers,\n          i = this._handlerIndex(h[name], type, handler);\n\n    if (i < 0) {\n      eventListenerCheck(this, type);\n      (h[name] || (h[name] = [])).push({\n        type:    type,\n        handler: handler\n      });\n    }\n\n    return this;\n  }\n\n  // remove an event handler\n  off(type, handler) {\n    const name = this.eventName(type),\n          h = this._handlers[name],\n          i = this._handlerIndex(h, type, handler);\n\n    if (i >= 0) {\n      h.splice(i, 1);\n    }\n\n    return this;\n  }\n\n  pickEvent(evt) {\n    const p = point(evt, this._canvas),\n          o = this._origin;\n\n    // TODO: check pixelRatio\n    // Change: go from canvas coordinates to vis coordinates\n    const ctx = this.context();\n    const transform = ctx.getTransform();\n    const scaleFactor = transform.a;\n    const dx = transform.e / ctx.pixelRatio;\n    const dy = transform.f / ctx.pixelRatio;\n\n    p[0] = (p[0] - dx) * ctx.pixelRatio / scaleFactor;\n    p[1] = (p[1] - dy) * ctx.pixelRatio / scaleFactor;\n\n    return this.pick(this._scene, p[0], p[1], p[0] - o[0], p[1] - o[1]);\n  }\n\n  // find the scenegraph item at the current pointer position\n  // x, y -- the absolute x, y pointer coordinates on the canvas element\n  // gx, gy -- the relative coordinates within the current group\n  pick(scene, x, y, gx, gy) {\n    const g = this.context(),\n          mark = Marks[scene.marktype];\n    return mark.pick.call(this, g, scene, x, y, gx, gy);\n  }\n}\n\nconst eventBundle = type => (\n  type === TouchStartEvent ||\n  type === TouchMoveEvent ||\n  type === TouchEndEvent\n)\n? [TouchStartEvent, TouchMoveEvent, TouchEndEvent]\n: [type];\n\n// lazily add listeners to the canvas as needed\nfunction eventListenerCheck(handler, type) {\n  eventBundle(type).forEach(_ => addEventListener(handler, _));\n}\n\nfunction addEventListener(handler, type) {\n  const canvas = handler.canvas();\n  if (canvas && !handler._events[type]) {\n    handler._events[type] = 1;\n    canvas.addEventListener(type, handler[type]\n      ? evt => handler[type](evt)\n      : evt => handler.fire(type, evt)\n    );\n  }\n}\n\nfunction fireAll(handler, types, event) {\n  types.forEach(type => handler.fire(type, event));\n}\n\nfunction move(moveEvents, overEvents, outEvents) {\n  return function(evt) {\n\n    const a = this._active,\n          p = this.pickEvent(evt);\n\n    if (p === a) {\n      // active item and picked item are the same\n      fireAll(this, moveEvents, evt); // fire move\n    } else {\n      // active item and picked item are different\n      if (!a || !a.exit) {\n        // fire out for prior active item\n        // suppress if active item was removed from scene\n        fireAll(this, outEvents, evt);\n      }\n      this._active = p; // set new active item\n      fireAll(this, overEvents, evt); // fire over for new active item\n      fireAll(this, moveEvents, evt); // fire move for new active item\n    }\n  };\n}\n\nfunction inactive(types) {\n  return function(evt) {\n    fireAll(this, types, evt);\n    this._active = null;\n  };\n}\n","import Renderer from './Renderer';\nimport Bounds from './Bounds';\nimport marks from './marks/index';\n\nimport {domClear} from './util/dom';\nimport clip from './util/canvas/clip';\nimport resize from './util/canvas/resize';\nimport {canvas} from 'vega-canvas';\nimport {error} from 'vega-util';\n\nexport default class CanvasRenderer extends Renderer {\n  constructor(loader) {\n    super(loader);\n    this._options = {};\n    this._redraw = false;\n    this._dirty = new Bounds();\n    this._tempb = new Bounds();\n  }\n\n  initialize(el, width, height, origin, scaleFactor, options) {\n    this._options = options || {};\n\n    this._canvas = this._options.externalContext\n      ? null\n      : canvas(1, 1, this._options.type); // instantiate a small canvas\n\n    if (el && this._canvas) {\n      domClear(el, 0).appendChild(this._canvas);\n      this._canvas.setAttribute('class', 'marks');\n    }\n\n    // this method will invoke resize to size the canvas appropriately\n    return super.initialize(el, width, height, origin, scaleFactor);\n  }\n\n  resize(width, height, origin, scaleFactor) {\n    super.resize(width, height, origin, scaleFactor);\n\n    if (this._canvas) {\n      // configure canvas size and transform\n      resize(this._canvas, this._width, this._height,\n        this._origin, this._scale, this._options.context);\n    } else {\n      // external context needs to be scaled and positioned to origin\n      const ctx = this._options.externalContext;\n      if (!ctx) error('CanvasRenderer is missing a valid canvas or context');\n      ctx.scale(this._scale, this._scale);\n      ctx.translate(this._origin[0], this._origin[1]);\n    }\n\n    this._redraw = true;\n    return this;\n  }\n\n  canvas() {\n    return this._canvas;\n  }\n\n  context() {\n    return this._options.externalContext\n      || (this._canvas ? this._canvas.getContext('2d') : null);\n  }\n\n  dirty(item) {\n    const b = this._tempb.clear().union(item.bounds);\n    let g = item.mark.group;\n\n    while (g) {\n      b.translate(g.x || 0, g.y || 0);\n      g = g.mark.group;\n    }\n\n    this._dirty.union(b);\n  }\n\n  _render(scene, markTypes) {\n    const g = this.context(),\n          o = this._origin,\n          s = this._scale,\n          w = this._width,\n          h = this._height,\n          db = this._dirty,\n          vb = viewBounds(o, w, h, s);\n\n    // setup\n    g.save();\n    const b = this._redraw || db.empty()\n      ? (this._redraw = false, vb.expand(1))\n      : clipToBounds(g, vb.intersect(db), o, s);\n\n    this.clear(-o[0], -o[1], w, h);\n\n    // render\n    this.draw(g, scene, b, markTypes);\n\n    // takedown\n    g.restore();\n    db.clear();\n\n    return this;\n  }\n\n  draw(ctx, scene, bounds, markTypes) {\n    if (scene.marktype !== 'group' && markTypes != null && !markTypes.includes(scene.marktype)) {\n      return;\n    }\n\n    const mark = marks[scene.marktype];\n\n    if (scene.clip) clip(ctx, scene);\n    mark.draw.call(this, ctx, scene, bounds, markTypes);\n    if (scene.clip) ctx.restore();\n  }\n\n  clear(x, y, w, h) {\n    const opt = this._options,\n          g = this.context();\n\n    if (opt.type !== 'pdf' && !opt.externalContext) {\n      // calling clear rect voids vector output in pdf mode\n      // and could remove external context content (#2615)\n      g.clearRect(x, y, w, h);\n    }\n\n    if (this._bgcolor != null) {\n      g.fillStyle = this._bgcolor;\n      g.fillRect(x, y, w, h);\n    }\n  }\n}\n\nconst viewBounds = (origin, width, height, scaleFactor) => new Bounds()\n  .set(0, 0, width, height)\n  .scale(1 / scaleFactor)\n  .translate(-origin[0], -origin[1]);\n\nfunction clipToBounds(g, b, origin, scaleFactor) {\n  // expand bounds by 1 pixel, then round to pixel boundaries\n  b.expand(1).round();\n\n  // align to base pixel grid in case of non-integer scaling (#2425)\n  if (g.pixelRatio % 1) {\n    b.scale(g.pixelRatio).round().scale(1 / g.pixelRatio);\n  }\n\n  b.scale(1 / scaleFactor);\n\n  // to avoid artifacts translate if origin has fractional pixels\n  b.translate(-(origin[0] % 1), -(origin[1] % 1));\n\n  // set clip path\n  g.beginPath();\n  g.rect(b.x1, b.y1, b.width(), b.height());\n  g.clip();\n\n  return b;\n}\n","function devicePixelRatio() {\n  return typeof window !== 'undefined' ? window.devicePixelRatio || 1 : 1;\n}\n\n\nexport default function(canvas, width, height, origin, scaleFactor, opt) {\n  const inDOM = typeof HTMLElement !== 'undefined'\n              && canvas instanceof HTMLElement\n              && canvas.parentNode != null,\n        context = canvas.getContext('2d');\n        // ratio = inDOM ? devicePixelRatio() : scaleFactor;\n\n  // const ratio = scaleFactor;\n  const ratio = 2;\n\n  canvas.width = width * ratio;\n  canvas.height = height * ratio;\n  // canvas.width = width;\n  // canvas.height = height;\n\n  for (const key in opt) {\n    context[key] = opt[key];\n  }\n\n  if (inDOM && ratio !== 1) {\n    canvas.style.width = width + 'px';\n    canvas.style.height = height + 'px';\n  }\n\n  // context.pixelRatio = 1;\n  context.pixelRatio = ratio;\n\n  // context.setTransform(\n  //   ratio, 0, 0, ratio,\n  //   ratio * origin[0],\n  //   ratio * origin[1]\n  // );\n\n  scaleFactor *= ratio;\n\n  // Added: need the origin and scale for event detection later (hitpath fct)\n  context.origin = origin;\n  context.scale = scaleFactor;\n\n  context.setTransform(\n    scaleFactor, 0, 0, scaleFactor,\n    scaleFactor * origin[0],\n    scaleFactor * origin[1]\n  );\n\n  return canvas;\n}\n","import Handler from './Handler';\nimport {domFind} from './util/dom';\nimport {HrefEvent, TooltipHideEvent, TooltipShowEvent} from './util/events';\n\nexport default class SVGHandler extends Handler {\n  constructor(loader, tooltip) {\n    super(loader, tooltip);\n    const h = this;\n    h._hrefHandler = listener(h, (evt, item) => {\n      if (item && item.href) h.handleHref(evt, item, item.href);\n    });\n    h._tooltipHandler = listener(h, (evt, item) => {\n      h.handleTooltip(evt, item, evt.type !== TooltipHideEvent);\n    });\n  }\n\n  initialize(el, origin, obj) {\n    let svg = this._svg;\n    if (svg) {\n      svg.removeEventListener(HrefEvent, this._hrefHandler);\n      svg.removeEventListener(TooltipShowEvent, this._tooltipHandler);\n      svg.removeEventListener(TooltipHideEvent, this._tooltipHandler);\n    }\n    this._svg = svg = el && domFind(el, 'svg');\n    if (svg) {\n      svg.addEventListener(HrefEvent, this._hrefHandler);\n      svg.addEventListener(TooltipShowEvent, this._tooltipHandler);\n      svg.addEventListener(TooltipHideEvent, this._tooltipHandler);\n    }\n    return super.initialize(el, origin, obj);\n  }\n\n  canvas() {\n    return this._svg;\n  }\n\n  // add an event handler\n  on(type, handler) {\n    const name = this.eventName(type),\n          h = this._handlers,\n          i = this._handlerIndex(h[name], type, handler);\n\n    if (i < 0) {\n      const x = {\n        type,\n        handler,\n        listener: listener(this, handler)\n      };\n\n      (h[name] || (h[name] = [])).push(x);\n      if (this._svg) {\n        this._svg.addEventListener(name, x.listener);\n      }\n    }\n\n    return this;\n  }\n\n  // remove an event handler\n  off(type, handler) {\n    const name = this.eventName(type),\n          h = this._handlers[name],\n          i = this._handlerIndex(h, type, handler);\n\n    if (i >= 0) {\n      if (this._svg) {\n        this._svg.removeEventListener(name, h[i].listener);\n      }\n      h.splice(i, 1);\n    }\n\n    return this;\n  }\n}\n\n// wrap an event listener for the SVG DOM\nconst listener = (context, handler) => evt => {\n  let item = evt.target.__data__;\n  item = Array.isArray(item) ? item[0] : item;\n  evt.vegaType = evt.type;\n  handler.call(context._obj, evt, item);\n};\n","import {domainCaption, isDiscrete} from 'vega-scale';\nimport {array, peek, toSet} from 'vega-util';\n\nconst ARIA_HIDDEN = 'aria-hidden';\nconst ARIA_LABEL = 'aria-label';\nconst ARIA_ROLE = 'role';\nconst ARIA_ROLEDESCRIPTION = 'aria-roledescription';\nconst GRAPHICS_OBJECT = 'graphics-object';\nconst GRAPHICS_SYMBOL = 'graphics-symbol';\n\nconst bundle = (role, roledesc, label) => ({\n  [ARIA_ROLE]: role,\n  [ARIA_ROLEDESCRIPTION]: roledesc,\n  [ARIA_LABEL]: label || undefined\n});\n\n// these roles are covered by related roles\n// we can ignore them, no need to generate attributes\nconst AriaIgnore = toSet([\n  'axis-domain',\n  'axis-grid',\n  'axis-label',\n  'axis-tick',\n  'axis-title',\n  'legend-band',\n  'legend-entry',\n  'legend-gradient',\n  'legend-label',\n  'legend-title',\n  'legend-symbol',\n  'title'\n]);\n\n// aria attribute generators for guide roles\nconst AriaGuides = {\n  'axis': {desc: 'axis', caption: axisCaption},\n  'legend': {desc: 'legend', caption: legendCaption},\n  'title-text': {\n    desc: 'title',\n    caption: item => `Title text '${titleCaption(item)}'`\n  },\n  'title-subtitle': {\n    desc: 'subtitle',\n    caption: item => `Subtitle text '${titleCaption(item)}'`\n  }\n};\n\n// aria properties generated for mark item encoding channels\nexport const AriaEncode = {\n  ariaRole: ARIA_ROLE,\n  ariaRoleDescription: ARIA_ROLEDESCRIPTION,\n  description: ARIA_LABEL\n};\n\nexport function ariaItemAttributes(emit, item) {\n  const hide = item.aria === false;\n  emit(ARIA_HIDDEN, hide || undefined);\n\n  if (hide || item.description == null) {\n    for (const prop in AriaEncode) {\n      emit(AriaEncode[prop], undefined);\n    }\n  } else {\n    const type = item.mark.marktype;\n    emit(\n      ARIA_LABEL,\n      item.description\n    );\n    emit(\n      ARIA_ROLE,\n      item.ariaRole || (type === 'group' ? GRAPHICS_OBJECT : GRAPHICS_SYMBOL)\n    );\n    emit(\n      ARIA_ROLEDESCRIPTION,\n      item.ariaRoleDescription || `${type} mark`\n    );\n  }\n}\n\nexport function ariaMarkAttributes(mark) {\n  return mark.aria === false ? { [ARIA_HIDDEN]: true }\n    : AriaIgnore[mark.role] ? null\n    : AriaGuides[mark.role] ? ariaGuide(mark, AriaGuides[mark.role])\n    : ariaMark(mark);\n}\n\nfunction ariaMark(mark) {\n  const type = mark.marktype;\n  const recurse = (\n    type === 'group' ||\n    type === 'text' ||\n    mark.items.some(_ => _.description != null && _.aria !== false)\n  );\n  return bundle(\n    recurse ? GRAPHICS_OBJECT : GRAPHICS_SYMBOL,\n    `${type} mark container`,\n    mark.description\n  );\n}\n\nfunction ariaGuide(mark, opt) {\n  try {\n    const item = mark.items[0],\n          caption = opt.caption || (() => '');\n    return bundle(\n      opt.role || GRAPHICS_SYMBOL,\n      opt.desc,\n      item.description || caption(item)\n    );\n  } catch (err) {\n    return null;\n  }\n}\n\nfunction titleCaption(item) {\n  return array(item.text).join(' ');\n}\n\nfunction axisCaption(item) {\n  const datum = item.datum,\n        orient = item.orient,\n        title = datum.title ? extractTitle(item) : null,\n        ctx = item.context,\n        scale = ctx.scales[datum.scale].value,\n        locale = ctx.dataflow.locale(),\n        type = scale.type,\n        xy = (orient === 'left' || orient === 'right') ? 'Y' : 'X';\n\n  return `${xy}-axis`\n    + (title ? ` titled '${title}'` : '')\n    + ` for a ${isDiscrete(type) ? 'discrete' : type} scale`\n    + ` with ${domainCaption(locale, scale, item)}`;\n}\n\nfunction legendCaption(item) {\n  const datum = item.datum,\n        title = datum.title ? extractTitle(item) : null,\n        type = `${datum.type || ''} legend`.trim(),\n        scales = datum.scales,\n        props = Object.keys(scales),\n        ctx = item.context,\n        scale = ctx.scales[scales[props[0]]].value,\n        locale = ctx.dataflow.locale();\n\n  return capitalize(type)\n    + (title ? ` titled '${title}'` : '')\n    + ` for ${channelCaption(props)}`\n    + ` with ${domainCaption(locale, scale, item)}`;\n}\n\nfunction extractTitle(item) {\n  try {\n    return array(peek(item.items).items[0].text).join(' ');\n  } catch (err) {\n    return null;\n  }\n}\n\nfunction channelCaption(props) {\n  props = props.map(p => p + (p === 'fill' || p === 'stroke' ? ' color' : ''));\n  return props.length < 2 ? props[0]\n    : props.slice(0, -1).join(', ') + ' and ' + peek(props);\n}\n\nfunction capitalize(s) {\n  return s.length ? s[0].toUpperCase() + s.slice(1) : s;\n}\n","const innerText = val => (val + '')\n  .replace(/&/g, '&amp;')\n  .replace(/</g, '&lt;')\n  .replace(/>/g, '&gt;');\n\nconst attrText = val => innerText(val)\n  .replace(/\"/g, '&quot;')\n  .replace(/\\t/g, '&#x9;')\n  .replace(/\\n/g, '&#xA;')\n  .replace(/\\r/g, '&#xD;');\n\nexport function markup() {\n  let buf = '',\n      outer = '',\n      inner = '';\n\n  const stack = [],\n        clear = () => outer = inner = '',\n        push = tag => {\n          if (outer) { buf += `${outer}>${inner}`; clear(); }\n          stack.push(tag);\n        },\n        attr = (name, value) => {\n          if (value != null) outer += ` ${name}=\"${attrText(value)}\"`;\n          return m;\n        },\n\n        m = {\n          open(tag, ...attrs) {\n            push(tag);\n            outer = '<' + tag;\n            for (const set of attrs) {\n              for (const key in set) attr(key, set[key]);\n            }\n            return m;\n          },\n          close() {\n            const tag = stack.pop();\n            if (outer) {\n              buf += outer + (inner\n                ? `>${inner}</${tag}>`\n                : '/>');\n            } else {\n              buf += `</${tag}>`;\n            }\n            clear();\n            return m;\n          },\n          attr,\n          text: t => (inner += innerText(t), m),\n          toString: () => buf\n        };\n\n  return m;\n}\n\nexport const serializeXML = node =>\n  _serialize(markup(), node) + '';\n\nfunction _serialize(m, node) {\n  m.open(node.tagName);\n\n  if (node.hasAttributes()) {\n    const attrs = node.attributes,\n          n = attrs.length;\n    for (let i=0; i<n; ++i) {\n      m.attr(attrs[i].name, attrs[i].value);\n    }\n  }\n\n  if (node.hasChildNodes()) {\n    const children = node.childNodes;\n\n    for (const child of children) {\n      child.nodeType === 3 // text node\n        ? m.text(child.nodeValue)\n        : _serialize(m, child);\n    }\n  }\n\n  return m.close();\n}\n","export const stylesAttr = {\n  fill:             'fill',\n  fillOpacity:      'fill-opacity',\n  stroke:           'stroke',\n  strokeOpacity:    'stroke-opacity',\n  strokeWidth:      'stroke-width',\n  strokeCap:        'stroke-linecap',\n  strokeJoin:       'stroke-linejoin',\n  strokeDash:       'stroke-dasharray',\n  strokeDashOffset: 'stroke-dashoffset',\n  strokeMiterLimit: 'stroke-miterlimit',\n  opacity:          'opacity'\n};\n\nexport const stylesCss = {\n  blend:            'mix-blend-mode'\n};\n\n// ensure miter limit default is consistent with canvas (#2498)\nexport const rootAttributes = {\n  'fill': 'none',\n  'stroke-miterlimit': 10\n};\n","import Renderer from './Renderer';\nimport {gradientRef, isGradient, patternPrefix} from './Gradient';\nimport marks from './marks/index';\nimport {ariaItemAttributes, ariaMarkAttributes} from './util/aria';\nimport {cssClass, domChild, domClear, domCreate} from './util/dom';\nimport {serializeXML} from './util/markup';\nimport {fontFamily, fontSize, lineHeight, textLines, textValue} from './util/text';\nimport {visit} from './util/visit';\nimport clip from './util/svg/clip';\nimport metadata from './util/svg/metadata';\nimport {rootAttributes, stylesAttr, stylesCss} from './util/svg/styles';\nimport {isArray} from 'vega-util';\n\nconst RootIndex = 0,\n      xmlns = 'http://www.w3.org/2000/xmlns/',\n      svgns = metadata.xmlns;\n\nexport default class SVGRenderer extends Renderer {\n  constructor(loader) {\n    super(loader);\n    this._dirtyID = 0;\n    this._dirty = [];\n    this._svg = null;\n    this._root = null;\n    this._defs = null;\n  }\n\n  /**\n   * Initialize a new SVGRenderer instance.\n   * @param {DOMElement} el - The containing DOM element for the display.\n   * @param {number} width - The coordinate width of the display, in pixels.\n   * @param {number} height - The coordinate height of the display, in pixels.\n   * @param {Array<number>} origin - The origin of the display, in pixels.\n   *   The coordinate system will be translated to this point.\n   * @param {number} [scaleFactor=1] - Optional scaleFactor by which to multiply\n   *   the width and height to determine the final pixel size.\n   * @return {SVGRenderer} - This renderer instance.\n   */\n  initialize(el, width, height, origin, scaleFactor) {\n    // create the svg definitions cache\n    this._defs = {};\n    this._clearDefs();\n\n    if (el) {\n      this._svg = domChild(el, 0, 'svg', svgns);\n      this._svg.setAttributeNS(xmlns, 'xmlns', svgns);\n      this._svg.setAttributeNS(xmlns, 'xmlns:xlink', metadata['xmlns:xlink']);\n      this._svg.setAttribute('version', metadata['version']);\n      this._svg.setAttribute('class', 'marks');\n      domClear(el, 1);\n\n      // set the svg root group\n      this._root = domChild(this._svg, RootIndex, 'g', svgns);\n      setAttributes(this._root, rootAttributes);\n\n      // ensure no additional child elements\n      domClear(this._svg, RootIndex + 1);\n    }\n\n    // set background color if defined\n    this.background(this._bgcolor);\n\n    return super.initialize(el, width, height, origin, scaleFactor);\n  }\n\n  /**\n   * Get / set the background color.\n   */\n  background(bgcolor) {\n    if (arguments.length && this._svg) {\n      this._svg.style.setProperty('background-color', bgcolor);\n    }\n    return super.background(...arguments);\n  }\n\n  /**\n   * Resize the display.\n   * @param {number} width - The new coordinate width of the display, in pixels.\n   * @param {number} height - The new coordinate height of the display, in pixels.\n   * @param {Array<number>} origin - The new origin of the display, in pixels.\n   *   The coordinate system will be translated to this point.\n   * @param {number} [scaleFactor=1] - Optional scaleFactor by which to multiply\n   *   the width and height to determine the final pixel size.\n   * @return {SVGRenderer} - This renderer instance;\n   */\n  resize(width, height, origin, scaleFactor) {\n    super.resize(width, height, origin, scaleFactor);\n\n    if (this._svg) {\n      setAttributes(this._svg, {\n        width: this._width * this._scale,\n        height: this._height * this._scale,\n        viewBox: `0 0 ${this._width} ${this._height}`\n      });\n      this._root.setAttribute('transform', `translate(${this._origin})`);\n    }\n\n    this._dirty = [];\n\n    return this;\n  }\n\n  /**\n   * Returns the SVG element of the visualization.\n   * @return {DOMElement} - The SVG element.\n   */\n  canvas() {\n    return this._svg;\n  }\n\n  /**\n   * Returns an SVG text string for the rendered content,\n   * or null if this renderer is currently headless.\n   */\n  svg() {\n    const svg = this._svg,\n          bg = this._bgcolor;\n\n    if (!svg) return null;\n\n    let node;\n    if (bg) {\n      svg.removeAttribute('style');\n      node = domChild(svg, RootIndex, 'rect', svgns);\n      setAttributes(node, {width: this._width, height: this._height, fill: bg});\n    }\n\n    const text = serializeXML(svg);\n\n    if (bg) {\n      svg.removeChild(node);\n      this._svg.style.setProperty('background-color', bg);\n    }\n\n    return text;\n  }\n\n  /**\n   * Internal rendering method.\n   * @param {object} scene - The root mark of a scenegraph to render.\n   * @param {Array} markTypes - Array of the mark types to render.\n   *                            If undefined, render all mark types\n   */\n  _render(scene, markTypes) {\n    // perform spot updates and re-render markup\n    if (this._dirtyCheck()) {\n      if (this._dirtyAll) this._clearDefs();\n      this.mark(this._root, scene, undefined, markTypes);\n      domClear(this._root, 1);\n    }\n\n    this.defs();\n\n    this._dirty = [];\n    ++this._dirtyID;\n\n    return this;\n  }\n\n  // -- Manage rendering of items marked as dirty --\n\n  /**\n   * Flag a mark item as dirty.\n   * @param {Item} item - The mark item.\n   */\n  dirty(item) {\n    if (item.dirty !== this._dirtyID) {\n      item.dirty = this._dirtyID;\n      this._dirty.push(item);\n    }\n  }\n\n  /**\n   * Check if a mark item is considered dirty.\n   * @param {Item} item - The mark item.\n   */\n  isDirty(item) {\n    return this._dirtyAll\n      || !item._svg\n      || !item._svg.ownerSVGElement\n      || item.dirty === this._dirtyID;\n  }\n\n  /**\n   * Internal method to check dirty status and, if possible,\n   * make targetted updates without a full rendering pass.\n   */\n  _dirtyCheck() {\n    this._dirtyAll = true;\n    const items = this._dirty;\n    if (!items.length || !this._dirtyID) return true;\n\n    const id = ++this._dirtyID;\n    let item, mark, type, mdef, i, n, o;\n\n    for (i=0, n=items.length; i<n; ++i) {\n      item = items[i];\n      mark = item.mark;\n\n      if (mark.marktype !== type) {\n        // memoize mark instance lookup\n        type = mark.marktype;\n        mdef = marks[type];\n      }\n\n      if (mark.zdirty && mark.dirty !== id) {\n        this._dirtyAll = false;\n        dirtyParents(item, id);\n        mark.items.forEach(i => { i.dirty = id; });\n      }\n      if (mark.zdirty) continue; // handle in standard drawing pass\n\n      if (item.exit) { // EXIT\n        if (mdef.nested && mark.items.length) {\n          // if nested mark with remaining points, update instead\n          o = mark.items[0];\n          if (o._svg) this._update(mdef, o._svg, o);\n        } else if (item._svg) {\n          // otherwise remove from DOM\n          o = item._svg.parentNode;\n          if (o) o.removeChild(item._svg);\n        }\n        item._svg = null;\n        continue;\n      }\n\n      item = (mdef.nested ? mark.items[0] : item);\n      if (item._update === id) continue; // already visited\n\n      if (!item._svg || !item._svg.ownerSVGElement) {\n        // ENTER\n        this._dirtyAll = false;\n        dirtyParents(item, id);\n      } else {\n        // IN-PLACE UPDATE\n        this._update(mdef, item._svg, item);\n      }\n      item._update = id;\n    }\n    return !this._dirtyAll;\n  }\n\n  // -- Construct & maintain scenegraph to SVG mapping ---\n\n  /**\n   * Render a set of mark items.\n   * @param {SVGElement} el - The parent element in the SVG tree.\n   * @param {object} scene - The mark parent to render.\n   * @param {SVGElement} prev - The previous sibling in the SVG tree.\n   * @param {Array} markTypes - Array of the mark types to render.\n   *                            If undefined, render all mark types\n   */\n  mark(el, scene, prev, markTypes) {\n    if (!this.isDirty(scene)) {\n      return scene._svg;\n    }\n\n    const svg = this._svg,\n          markType = scene.marktype,\n          mdef = marks[markType],\n          events = scene.interactive === false ? 'none' : null,\n          isGroup = mdef.tag === 'g';\n\n    const parent = bind(scene, el, prev, 'g', svg);\n    if (markType !== 'group' && markTypes != null && !markTypes.includes(markType)) {\n      domClear(parent, 0);\n      return scene._svg;\n    }\n\n    parent.setAttribute('class', cssClass(scene));\n\n    // apply aria attributes to parent container element\n    const aria = ariaMarkAttributes(scene);\n    for (const key in aria) setAttribute(parent, key, aria[key]);\n\n    if (!isGroup) {\n      setAttribute(parent, 'pointer-events', events);\n    }\n    setAttribute(parent, 'clip-path',\n      scene.clip ? clip(this, scene, scene.group) : null);\n\n    let sibling = null,\n        i = 0;\n\n    const process = item => {\n      const dirty = this.isDirty(item),\n            node = bind(item, parent, sibling, mdef.tag, svg);\n\n      if (dirty) {\n        this._update(mdef, node, item);\n        if (isGroup) recurse(this, node, item, markTypes);\n      }\n\n      sibling = node;\n      ++i;\n    };\n\n    if (mdef.nested) {\n      if (scene.items.length) process(scene.items[0]);\n    } else {\n      visit(scene, process);\n    }\n\n    domClear(parent, i);\n    return parent;\n  }\n\n  /**\n   * Update the attributes of an SVG element for a mark item.\n   * @param {object} mdef - The mark definition object\n   * @param {SVGElement} el - The SVG element.\n   * @param {Item} item - The mark item.\n   */\n  _update(mdef, el, item) {\n    // set dom element and values cache\n    // provides access to emit method\n    element = el;\n    values = el.__values__;\n\n    // apply aria-specific properties\n    ariaItemAttributes(emit, item);\n\n    // apply svg attributes\n    mdef.attr(emit, item, this);\n\n    // some marks need special treatment\n    const extra = mark_extras[mdef.type];\n    if (extra) extra.call(this, mdef, el, item);\n\n    // apply svg style attributes\n    // note: element state may have been modified by 'extra' method\n    if (element) this.style(element, item);\n  }\n\n  /**\n   * Update the presentation attributes of an SVG element for a mark item.\n   * @param {SVGElement} el - The SVG element.\n   * @param {Item} item - The mark item.\n   */\n  style(el, item) {\n    if (item == null) return;\n\n    for (const prop in stylesAttr) {\n      let value = prop === 'font' ? fontFamily(item) : item[prop];\n      if (value === values[prop]) continue;\n\n      const name = stylesAttr[prop];\n      if (value == null) {\n        el.removeAttribute(name);\n      } else {\n        if (isGradient(value)) {\n          value = gradientRef(value, this._defs.gradient, href());\n        }\n        el.setAttribute(name, value + '');\n      }\n\n      values[prop] = value;\n    }\n\n    for (const prop in stylesCss) {\n      setStyle(el, stylesCss[prop], item[prop]);\n    }\n  }\n\n  /**\n   * Render SVG defs, as needed.\n   * Must be called *after* marks have been processed to ensure the\n   * collected state is current and accurate.\n   */\n  defs() {\n    const svg = this._svg,\n          defs = this._defs;\n\n    let el = defs.el,\n        index = 0;\n\n    for (const id in defs.gradient) {\n      if (!el) defs.el = (el = domChild(svg, RootIndex + 1, 'defs', svgns));\n      index = updateGradient(el, defs.gradient[id], index);\n    }\n\n    for (const id in defs.clipping) {\n      if (!el) defs.el = (el = domChild(svg, RootIndex + 1, 'defs', svgns));\n      index = updateClipping(el, defs.clipping[id], index);\n    }\n\n    // clean-up\n    if (el) {\n      index === 0\n        ? (svg.removeChild(el), defs.el = null)\n        : domClear(el, index);\n    }\n  }\n\n  /**\n   * Clear defs caches.\n   */\n  _clearDefs() {\n    const def = this._defs;\n    def.gradient = {};\n    def.clipping = {};\n  }\n}\n\n// mark ancestor chain with a dirty id\nfunction dirtyParents(item, id) {\n  for (; item && item.dirty !== id; item=item.mark.group) {\n    item.dirty = id;\n    if (item.mark && item.mark.dirty !== id) {\n      item.mark.dirty = id;\n    } else return;\n  }\n}\n\n// update gradient definitions\nfunction updateGradient(el, grad, index) {\n  let i, n, stop;\n\n  if (grad.gradient === 'radial') {\n    // SVG radial gradients automatically transform to normalized bbox\n    // coordinates, in a way that is cumbersome to replicate in canvas.\n    // We wrap the radial gradient in a pattern element, allowing us to\n    // maintain a circular gradient that matches what canvas provides.\n    let pt = domChild(el, index++, 'pattern', svgns);\n    setAttributes(pt, {\n      id: patternPrefix + grad.id,\n      viewBox: '0,0,1,1',\n      width: '100%',\n      height: '100%',\n      preserveAspectRatio: 'xMidYMid slice'\n    });\n\n    pt = domChild(pt, 0, 'rect', svgns);\n    setAttributes(pt, {\n      width: 1,\n      height: 1,\n      fill: `url(${href()}#${grad.id})`\n    });\n\n    el = domChild(el, index++, 'radialGradient', svgns);\n    setAttributes(el, {\n      id: grad.id,\n      fx: grad.x1,\n      fy: grad.y1,\n      fr: grad.r1,\n      cx: grad.x2,\n      cy: grad.y2,\n      r: grad.r2\n    });\n  } else {\n    el = domChild(el, index++, 'linearGradient', svgns);\n    setAttributes(el, {\n      id: grad.id,\n      x1: grad.x1,\n      x2: grad.x2,\n      y1: grad.y1,\n      y2: grad.y2\n    });\n  }\n\n  for (i=0, n=grad.stops.length; i<n; ++i) {\n    stop = domChild(el, i, 'stop', svgns);\n    stop.setAttribute('offset', grad.stops[i].offset);\n    stop.setAttribute('stop-color', grad.stops[i].color);\n  }\n  domClear(el, i);\n\n  return index;\n}\n\n// update clipping path definitions\nfunction updateClipping(el, clip, index) {\n  let mask;\n\n  el = domChild(el, index, 'clipPath', svgns);\n  el.setAttribute('id', clip.id);\n\n  if (clip.path) {\n    mask = domChild(el, 0, 'path', svgns);\n    mask.setAttribute('d', clip.path);\n  } else {\n    mask = domChild(el, 0, 'rect', svgns);\n    setAttributes(mask, {x: 0, y: 0, width: clip.width, height: clip.height});\n  }\n  domClear(el, 1);\n\n  return index + 1;\n}\n\n// Recursively process group contents.\nfunction recurse(renderer, el, group, markTypes) {\n  // child 'g' element is second to last among children (path, g, path)\n  // other children here are foreground and background path elements\n  el = el.lastChild.previousSibling;\n  let prev, idx = 0;\n\n  visit(group, item => {\n    prev = renderer.mark(el, item, prev, markTypes);\n    ++idx;\n  });\n\n  // CHANGE\n  // remove any extraneous DOM elements\n  // domClear(el, 1 + idx);\n  domClear(el, idx);\n}\n\n// Bind a scenegraph item to an SVG DOM element.\n// Create new SVG elements as needed.\nfunction bind(item, el, sibling, tag, svg) {\n  let node = item._svg, doc;\n\n  // create a new dom node if needed\n  if (!node) {\n    doc = el.ownerDocument;\n    node = domCreate(doc, tag, svgns);\n    item._svg = node;\n\n    if (item.mark) {\n      node.__data__ = item;\n      node.__values__ = {fill: 'default'};\n\n      // if group, create background, content, and foreground elements\n      if (tag === 'g') {\n        const bg = domCreate(doc, 'path', svgns);\n        node.appendChild(bg);\n        bg.__data__ = item;\n\n        const cg = domCreate(doc, 'g', svgns);\n        node.appendChild(cg);\n        cg.__data__ = item;\n\n        const fg = domCreate(doc, 'path', svgns);\n        node.appendChild(fg);\n        fg.__data__ = item;\n        fg.__values__ = {fill: 'default'};\n      }\n    }\n  }\n\n  // (re-)insert if (a) not contained in SVG or (b) sibling order has changed\n  if (node.ownerSVGElement !== svg || siblingCheck(node, sibling)) {\n    el.insertBefore(node, sibling ? sibling.nextSibling : el.firstChild);\n  }\n\n  return node;\n}\n\n// check if two nodes are ordered siblings\nfunction siblingCheck(node, sibling) {\n  return node.parentNode\n    && node.parentNode.childNodes.length > 1\n    && node.previousSibling != sibling; // treat null/undefined the same\n}\n\n// -- Set attributes & styles on SVG elements ---\n\nlet element = null, // temp var for current SVG element\n    values = null;  // temp var for current values hash\n\n// Extra configuration for certain mark types\nconst mark_extras = {\n  group(mdef, el, item) {\n    const fg = element = el.childNodes[2];\n    values = fg.__values__;\n    mdef.foreground(emit, item, this);\n\n    values = el.__values__; // use parent's values hash\n    element = el.childNodes[1];\n    mdef.content(emit, item, this);\n\n    const bg = element = el.childNodes[0];\n    mdef.background(emit, item, this);\n\n    const value = item.mark.interactive === false ? 'none' : null;\n    if (value !== values.events) {\n      setAttribute(fg, 'pointer-events', value);\n      setAttribute(bg, 'pointer-events', value);\n      values.events = value;\n    }\n\n    if (item.strokeForeground && item.stroke) {\n      const fill = item.fill;\n      setAttribute(fg, 'display', null);\n\n      // set style of background\n      this.style(bg, item);\n      setAttribute(bg, 'stroke', null);\n\n      // set style of foreground\n      if (fill) item.fill = null;\n      values = fg.__values__;\n      this.style(fg, item);\n      if (fill) item.fill = fill;\n\n      // leave element null to prevent downstream styling\n      element = null;\n    } else {\n      // ensure foreground is ignored\n      setAttribute(fg, 'display', 'none');\n    }\n  },\n  image(mdef, el, item) {\n    if (item.smooth === false) {\n      setStyle(el, 'image-rendering', 'optimizeSpeed');\n      setStyle(el, 'image-rendering', 'pixelated');\n    } else {\n      setStyle(el, 'image-rendering', null);\n    }\n  },\n  text(mdef, el, item) {\n    const tl = textLines(item);\n    let key, value, doc, lh;\n\n    if (isArray(tl)) {\n      // multi-line text\n      value = tl.map(_ => textValue(item, _));\n      key = value.join('\\n'); // content cache key\n\n      if (key !== values.text) {\n        domClear(el, 0);\n        doc = el.ownerDocument;\n        lh = lineHeight(item);\n        value.forEach((t, i) => {\n          const ts = domCreate(doc, 'tspan', svgns);\n          ts.__data__ = item; // data binding\n          ts.textContent = t;\n          if (i) {\n            ts.setAttribute('x', 0);\n            ts.setAttribute('dy', lh);\n          }\n          el.appendChild(ts);\n        });\n        values.text = key;\n      }\n    } else {\n      // single-line text\n      value = textValue(item, tl);\n      if (value !== values.text) {\n        el.textContent = value;\n        values.text = value;\n      }\n    }\n\n    setAttribute(el, 'font-family', fontFamily(item));\n    setAttribute(el, 'font-size', fontSize(item) + 'px');\n    setAttribute(el, 'font-style', item.fontStyle);\n    setAttribute(el, 'font-variant', item.fontVariant);\n    setAttribute(el, 'font-weight', item.fontWeight);\n  }\n};\n\nfunction emit(name, value, ns) {\n  // early exit if value is unchanged\n  if (value === values[name]) return;\n\n  // use appropriate method given namespace (ns)\n  if (ns) {\n    setAttributeNS(element, name, value, ns);\n  } else {\n    setAttribute(element, name, value);\n  }\n\n  // note current value for future comparison\n  values[name] = value;\n}\n\nfunction setStyle(el, name, value) {\n  if (value !== values[name]) {\n    if (value == null) {\n      el.style.removeProperty(name);\n    } else {\n      el.style.setProperty(name, value + '');\n    }\n    values[name] = value;\n  }\n}\n\nfunction setAttributes(el, attrs) {\n  for (const key in attrs) {\n    setAttribute(el, key, attrs[key]);\n  }\n}\n\nfunction setAttribute(el, name, value) {\n  if (value != null) {\n    // if value is provided, update DOM attribute\n    el.setAttribute(name, value);\n  } else {\n    // else remove DOM attribute\n    el.removeAttribute(name);\n  }\n}\n\nfunction setAttributeNS(el, name, value, ns) {\n  if (value != null) {\n    // if value is provided, update DOM attribute\n    el.setAttributeNS(ns, name, value);\n  } else {\n    // else remove DOM attribute\n    el.removeAttributeNS(ns, name);\n  }\n}\n\nfunction href() {\n  let loc;\n  return typeof window === 'undefined' ? ''\n    : (loc = window.location).hash ? loc.href.slice(0, -loc.hash.length)\n    : loc.href;\n}\n","import Renderer from './Renderer';\nimport {gradientRef, isGradient, patternPrefix} from './Gradient';\nimport Marks from './marks/index';\nimport {ariaItemAttributes, ariaMarkAttributes} from './util/aria';\nimport {cssClass} from './util/dom';\nimport {markup} from './util/markup';\nimport {fontFamily, fontSize, lineHeight, textLines, textValue} from './util/text';\nimport {visit} from './util/visit';\nimport clip from './util/svg/clip';\nimport metadata from './util/svg/metadata';\nimport {rootAttributes, stylesAttr, stylesCss} from './util/svg/styles';\nimport {extend, isArray} from 'vega-util';\n\nexport default class SVGStringRenderer extends Renderer {\n  constructor(loader) {\n    super(loader);\n    this._text = null;\n    this._defs = {\n      gradient: {},\n      clipping: {}\n    };\n  }\n\n  /**\n   * Returns the rendered SVG text string,\n   * or null if rendering has not yet occurred.\n   */\n  svg() {\n    return this._text;\n  }\n\n  /**\n   * Internal rendering method.\n   * @param {object} scene - The root mark of a scenegraph to render.\n   */\n  _render(scene) {\n    const m = markup();\n\n    // svg tag\n    m.open('svg', extend({}, metadata, {\n      class:   'marks',\n      width:   this._width * this._scale,\n      height:  this._height * this._scale,\n      viewBox: `0 0 ${this._width} ${this._height}`\n    }));\n\n    // background, if defined\n    const bg = this._bgcolor;\n    if (bg && bg !== 'transparent' && bg !== 'none') {\n      m.open('rect', {\n        width:  this._width,\n        height: this._height,\n        fill:   bg\n      }).close();\n    }\n\n    // root content group\n    m.open('g', rootAttributes, {\n      transform: 'translate(' + this._origin + ')'\n    });\n    this.mark(m, scene);\n    m.close(); // </g>\n\n    // defs\n    this.defs(m);\n\n    // get SVG text string\n    this._text = m.close() + '';\n\n    return this;\n  }\n\n  /**\n   * Render a set of mark items.\n   * @param {object} m - The markup context.\n   * @param {object} scene - The mark parent to render.\n   */\n  mark(m, scene) {\n    const mdef = Marks[scene.marktype],\n          tag  = mdef.tag,\n          attrList = [ariaItemAttributes, mdef.attr];\n\n    // render opening group tag\n    m.open('g',\n      {\n        'class': cssClass(scene),\n        'clip-path': scene.clip ? clip(this, scene, scene.group) : null\n      },\n      ariaMarkAttributes(scene),\n      {\n        'pointer-events': tag !== 'g' && scene.interactive === false ? 'none' : null\n      }\n    );\n\n    // render contained elements\n    const process = item => {\n      const href = this.href(item);\n      if (href) m.open('a', href);\n\n      m.open(\n        tag,\n        this.attr(scene, item, attrList, tag !== 'g' ? tag : null)\n      );\n\n      if (tag === 'text') {\n        const tl = textLines(item);\n        if (isArray(tl)) {\n          // multi-line text\n          const attrs = {x: 0, dy: lineHeight(item)};\n          for (let i=0; i<tl.length; ++i) {\n            m.open('tspan', i ? attrs: null)\n              .text(textValue(item, tl[i]))\n              .close();\n          }\n        } else {\n          // single-line text\n          m.text(textValue(item, tl));\n        }\n      } else if (tag === 'g') {\n        const fore = item.strokeForeground,\n              fill = item.fill,\n              stroke = item.stroke;\n\n        if (fore && stroke) {\n          item.stroke = null;\n        }\n\n        m.open(\n          'path',\n          this.attr(scene, item, mdef.background, 'bgrect')\n        ).close();\n\n        // recurse for group content\n        m.open('g', this.attr(scene, item, mdef.content));\n        visit(item, scene => this.mark(m, scene));\n        m.close();\n\n        if (fore && stroke) {\n          if (fill) item.fill = null;\n          item.stroke = stroke;\n\n          m.open(\n            'path',\n            this.attr(scene, item, mdef.foreground, 'bgrect')\n          ).close();\n\n          if (fill) item.fill = fill;\n        } else {\n          m.open(\n            'path',\n            this.attr(scene, item, mdef.foreground, 'bgfore')\n          ).close();\n        }\n      }\n\n      m.close(); // </tag>\n      if (href) m.close(); // </a>\n    };\n\n    if (mdef.nested) {\n      if (scene.items && scene.items.length) process(scene.items[0]);\n    } else {\n      visit(scene, process);\n    }\n\n    // render closing group tag\n    return m.close(); // </g>\n  }\n\n  /**\n   * Get href attributes for a hyperlinked mark item.\n   * @param {Item} item - The mark item.\n   */\n  href(item) {\n    const href = item.href;\n    let attr;\n\n    if (href) {\n      if (attr = this._hrefs && this._hrefs[href]) {\n        return attr;\n      } else {\n        this.sanitizeURL(href).then(attr => {\n          // rewrite to use xlink namespace\n          attr['xlink:href'] = attr.href;\n          attr.href = null;\n          (this._hrefs || (this._hrefs = {}))[href] = attr;\n        });\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Get an object of SVG attributes for a mark item.\n   * @param {object} scene - The mark parent.\n   * @param {Item} item - The mark item.\n   * @param {array|function} attrs - One or more attribute emitters.\n   * @param {string} tag - The tag being rendered.\n   */\n  attr(scene, item, attrs, tag) {\n    const object = {},\n          emit = (name, value, ns, prefixed) => {\n            object[prefixed || name] = value;\n          };\n\n    // apply mark specific attributes\n    if (Array.isArray(attrs)) {\n      attrs.forEach(fn => fn(emit, item, this));\n    } else {\n      attrs(emit, item, this);\n    }\n\n    // apply style attributes\n    if (tag) {\n      style(object, item, scene, tag, this._defs);\n    }\n\n    return object;\n  }\n\n  /**\n   * Render SVG defs, as needed.\n   * Must be called *after* marks have been processed to ensure the\n   * collected state is current and accurate.\n   * @param {object} m - The markup context.\n   */\n  defs(m) {\n    const gradient = this._defs.gradient,\n          clipping = this._defs.clipping,\n          count = Object.keys(gradient).length + Object.keys(clipping).length;\n\n    if (count === 0) return; // nothing to do\n\n    m.open('defs');\n\n    for (const id in gradient) {\n      const def = gradient[id],\n            stops = def.stops;\n\n      if (def.gradient === 'radial') {\n        // SVG radial gradients automatically transform to normalized bbox\n        // coordinates, in a way that is cumbersome to replicate in canvas.\n        // We wrap the radial gradient in a pattern element, allowing us to\n        // maintain a circular gradient that matches what canvas provides.\n\n        m.open('pattern', {\n          id: patternPrefix + id,\n          viewBox: '0,0,1,1',\n          width: '100%',\n          height: '100%',\n          preserveAspectRatio: 'xMidYMid slice'\n        });\n\n        m.open('rect', {\n          width:  '1',\n          height: '1',\n          fill:   'url(#' + id + ')'\n        }).close();\n\n        m.close(); // </pattern>\n\n        m.open('radialGradient', {\n          id: id,\n          fx: def.x1,\n          fy: def.y1,\n          fr: def.r1,\n          cx: def.x2,\n          cy: def.y2,\n          r: def.r2\n        });\n      } else {\n        m.open('linearGradient', {\n          id: id,\n          x1: def.x1,\n          x2: def.x2,\n          y1: def.y1,\n          y2: def.y2\n        });\n      }\n\n      for (let i = 0; i < stops.length; ++i) {\n        m.open('stop', {\n          offset: stops[i].offset,\n          'stop-color': stops[i].color\n        }).close();\n      }\n\n      m.close();\n    }\n\n    for (const id in clipping) {\n      const def = clipping[id];\n\n      m.open('clipPath', {id: id});\n      if (def.path) {\n        m.open('path', {\n          d: def.path\n        }).close();\n      } else {\n        m.open('rect', {\n          x: 0,\n          y: 0,\n          width: def.width,\n          height: def.height\n        }).close();\n      }\n      m.close();\n    }\n\n    m.close();\n  }\n}\n\n// Helper function for attr for style presentation attributes\nfunction style(s, item, scene, tag, defs) {\n  let styleList;\n  if (item == null) return s;\n\n  if (tag === 'bgrect' && scene.interactive === false) {\n    s['pointer-events'] = 'none';\n  }\n\n  if (tag === 'bgfore') {\n    if (scene.interactive === false) {\n      s['pointer-events'] = 'none';\n    }\n    s.display = 'none';\n    if (item.fill !== null) return s;\n  }\n\n  if (tag === 'image' && item.smooth === false) {\n    styleList = [\n      'image-rendering: optimizeSpeed;',\n      'image-rendering: pixelated;'\n    ];\n  }\n\n  if (tag === 'text') {\n    s['font-family'] = fontFamily(item);\n    s['font-size'] = fontSize(item) + 'px';\n    s['font-style'] = item.fontStyle;\n    s['font-variant'] = item.fontVariant;\n    s['font-weight'] = item.fontWeight;\n  }\n\n  for (const prop in stylesAttr) {\n    let value = item[prop];\n    const name = stylesAttr[prop];\n\n    if (value === 'transparent' && (name === 'fill' || name === 'stroke')) {\n      // transparent is not a legal SVG value\n      // we can skip it to rely on default 'none' instead\n    } else if (value != null) {\n      if (isGradient(value)) {\n        value = gradientRef(value, defs.gradient, '');\n      }\n      s[name] = value;\n    }\n  }\n\n  for (const prop in stylesCss) {\n    const value = item[prop];\n    if (value != null) {\n      styleList = styleList || [];\n      styleList.push(`${stylesCss[prop]}: ${value};`);\n    }\n  }\n  if (styleList) {\n    s.style = styleList.join(' ');\n  }\n\n  return s;\n}\n","import Renderer from './Renderer';\nimport SVGRenderer from './SVGRenderer';\nimport CanvasRenderer from './CanvasRenderer';\nimport {domChild} from './util/dom';\n\n/**\n * @typedef {Object} HybridRendererOptions\n *\n * @property {string[]} [svgMarkTypes=['text']] - An array of SVG mark types to render\n *                                                in the SVG layer. All other mark types\n *                                                will be rendered in the Canvas layer.\n * @property {boolean} [svgOnTop=true] - Flag to determine if SVG should be rendered on top.\n * @property {boolean} [debug=false] - Flag to enable or disable debugging mode. When true,\n *                                     the top layer will be stacked below the bottom layer\n *                                     rather than overlaid on top.\n */\n\n/** @type {HybridRendererOptions} */\nexport const OPTS = {\n  svgMarkTypes: ['text'],\n  svgOnTop: true,\n  debug: false\n};\n\n/**\n * Configure the HybridRenderer\n *\n * @param {HybridRendererOptions} options - HybridRenderer configuration options.\n */\nexport function setHybridRendererOptions(options) {\n  OPTS['svgMarkTypes'] = options.svgMarkTypes ?? ['text'];\n  OPTS['svgOnTop'] = options.svgOnTop ?? true;\n  OPTS['debug'] = options.debug ?? false;\n}\n\nexport default class HybridRenderer extends Renderer {\n  constructor(loader) {\n    super(loader);\n    this._svgRenderer = new SVGRenderer(loader);\n    this._canvasRenderer = new CanvasRenderer(loader);\n  }\n\n  /**\n   * Initialize a new HybridRenderer instance.\n   * @param {DOMElement} el - The containing DOM element for the display.\n   * @param {number} width - The coordinate width of the display, in pixels.\n   * @param {number} height - The coordinate height of the display, in pixels.\n   * @param {Array<number>} origin - The origin of the display, in pixels.\n   *   The coordinate system will be translated to this point.\n   * @param {number} [scaleFactor=1] - Optional scaleFactor by which to multiply\n   *   the width and height to determine the final pixel size.\n   * @return {HybridRenderer} - This renderer instance.\n   */\n  initialize(el, width, height, origin, scaleFactor) {\n    this._root_el = domChild(el, 0, 'div');\n\n    const bottomEl = domChild(this._root_el, 0, 'div');\n    const topEl = domChild(this._root_el, 1, 'div');\n\n    this._root_el.style.position = 'relative';\n\n    // Set position absolute to overlay svg on top of canvas\n    if (!OPTS.debug) {\n      bottomEl.style.height = '100%';\n      topEl.style.position = 'absolute';\n      topEl.style.top = '0';\n      topEl.style.left = '0';\n      topEl.style.height = '100%';\n      topEl.style.width = '100%';\n    }\n\n    this._svgEl = OPTS.svgOnTop? topEl: bottomEl;\n    this._canvasEl = OPTS.svgOnTop? bottomEl: topEl;\n\n    // pointer-events to none on SVG layer so that canvas gets all events\n    this._svgEl.style.pointerEvents = 'none';\n\n    this._canvasRenderer.initialize(this._canvasEl, width, height, origin, scaleFactor);\n    this._svgRenderer.initialize(this._svgEl, width, height, origin, scaleFactor);\n    return super.initialize(el, width, height, origin, scaleFactor);\n  }\n\n  /**\n   * Flag a mark item as dirty.\n   * @param {Item} item - The mark item.\n   */\n  dirty(item) {\n    if (OPTS.svgMarkTypes.includes(item.mark.marktype)) {\n      this._svgRenderer.dirty(item);\n    } else {\n      this._canvasRenderer.dirty(item);\n    }\n    return this;\n  }\n\n  /**\n   * Internal rendering method.\n   * @param {object} scene - The root mark of a scenegraph to render.\n   * @param {Array} markTypes - Array of the mark types to render.\n   *                            If undefined, render all mark types\n   */\n  _render(scene, markTypes) {\n    const allMarkTypes = markTypes ?? [\n      'arc', 'area', 'image', 'line', 'path', 'rect', 'rule', 'shape', 'symbol', 'text', 'trail'\n    ];\n    const canvasMarkTypes = allMarkTypes.filter((m) => !OPTS.svgMarkTypes.includes(m));\n    this._svgRenderer.render(scene, OPTS.svgMarkTypes);\n    this._canvasRenderer.render(scene, canvasMarkTypes);\n  }\n\n  /**\n   * Resize the display.\n   * @param {number} width - The new coordinate width of the display, in pixels.\n   * @param {number} height - The new coordinate height of the display, in pixels.\n   * @param {Array<number>} origin - The new origin of the display, in pixels.\n   *   The coordinate system will be translated to this point.\n   * @param {number} [scaleFactor=1] - Optional scaleFactor by which to multiply\n   *   the width and height to determine the final pixel size.\n   * @return {SVGRenderer} - This renderer instance;\n   */\n  resize(width, height, origin, scaleFactor) {\n    super.resize(width, height, origin, scaleFactor);\n    this._svgRenderer.resize(width, height, origin, scaleFactor);\n    this._canvasRenderer.resize(width, height, origin, scaleFactor);\n    return this;\n  }\n\n  background(bgcolor) {\n    // Propagate background color to lower canvas renderer\n    if (OPTS.svgOnTop) {\n      this._canvasRenderer.background(bgcolor);\n    } else {\n      this._svgRenderer.background(bgcolor);\n    }\n    return this;\n  }\n}\n","import CanvasHandler from './CanvasHandler';\nimport {OPTS} from './HybridRenderer';\nimport {domChild} from './util/dom';\n\nexport default class HybridHandler extends CanvasHandler {\n  constructor (loader, tooltip) {\n    super(loader, tooltip);\n  }\n\n  initialize(el, origin, obj) {\n    const canvas = domChild(domChild(el, 0, 'div'), OPTS.svgOnTop? 0: 1, 'div');\n    return super.initialize(canvas, origin, obj);\n  }\n}\n","import CanvasHandler from './CanvasHandler';\nimport CanvasRenderer from './CanvasRenderer';\nimport SVGHandler from './SVGHandler';\nimport SVGRenderer from './SVGRenderer';\nimport SVGStringRenderer from './SVGStringRenderer';\nimport HybridRenderer from './HybridRenderer';\nimport HybridHandler from './HybridHandler';\n\nconst Canvas = 'canvas';\nconst Hybrid = 'hybrid';\nconst PNG = 'png';\nconst SVG = 'svg';\nconst None = 'none';\n\nexport const RenderType = {\n  Canvas: Canvas,\n  PNG:    PNG,\n  SVG:    SVG,\n  Hybrid: Hybrid,\n  None:   None\n};\n\nconst modules = {};\n\nmodules[Canvas] = modules[PNG] = {\n  renderer: CanvasRenderer,\n  headless: CanvasRenderer,\n  handler:  CanvasHandler\n};\n\nmodules[SVG] = {\n  renderer: SVGRenderer,\n  headless: SVGStringRenderer,\n  handler:  SVGHandler\n};\n\nmodules[Hybrid] = {\n  renderer: HybridRenderer,\n  headless: HybridRenderer,\n  handler:  HybridHandler\n};\n\nmodules[None] = {};\n\nexport function renderModule(name, _) {\n  name = String(name || '').toLowerCase();\n  if (arguments.length > 1) {\n    modules[name] = _;\n    return this;\n  } else {\n    return modules[name];\n  }\n}\n","import Marks from './marks/index';\nimport {error} from 'vega-util';\nimport Bounds from './Bounds';\n\nexport function intersect(scene, bounds, filter) {\n  const hits = [], // intersection results\n        box = new Bounds().union(bounds), // defensive copy\n        type = scene.marktype;\n\n  return type ? intersectMark(scene, box, filter, hits)\n    : type === 'group' ? intersectGroup(scene, box, filter, hits)\n    : error('Intersect scene must be mark node or group item.');\n}\n\nfunction intersectMark(mark, box, filter, hits) {\n  if (visitMark(mark, box, filter)) {\n    const items = mark.items,\n          type = mark.marktype,\n          n = items.length;\n\n    let i = 0;\n\n    if (type === 'group') {\n      for (; i<n; ++i) {\n        intersectGroup(items[i], box, filter, hits);\n      }\n    } else {\n      for (const test = Marks[type].isect; i<n; ++i) {\n        const item = items[i];\n        if (intersectItem(item, box, test)) hits.push(item);\n      }\n    }\n  }\n  return hits;\n}\n\nfunction visitMark(mark, box, filter) {\n  // process if bounds intersect and if\n  // (1) mark is a group mark (so we must recurse), or\n  // (2) mark is interactive and passes filter\n  return mark.bounds && box.intersects(mark.bounds) && (\n    mark.marktype === 'group' ||\n    mark.interactive !== false && (!filter || filter(mark))\n  );\n}\n\nfunction intersectGroup(group, box, filter, hits) {\n  // test intersect against group\n  // skip groups by default unless filter says otherwise\n  if ((filter && filter(group.mark)) &&\n      intersectItem(group, box, Marks.group.isect)) {\n    hits.push(group);\n  }\n\n  // recursively test children marks\n  // translate box to group coordinate space\n  const marks = group.items,\n        n = marks && marks.length;\n\n  if (n) {\n    const x = group.x || 0,\n          y = group.y || 0;\n    box.translate(-x, -y);\n    for (let i=0; i<n; ++i) {\n      intersectMark(marks[i], box, filter, hits);\n    }\n    box.translate(x, y);\n  }\n\n  return hits;\n}\n\nfunction intersectItem(item, box, test) {\n  // test bounds enclosure, bounds intersection, then detailed test\n  const bounds = item.bounds;\n  return box.encloses(bounds) || (box.intersects(bounds) && test(item, box));\n}\n\n","import Bounds from '../Bounds';\nimport boundContext from './boundContext';\nimport {isFunction} from 'vega-util';\n\nconst clipBounds = new Bounds();\n\nexport default function(mark) {\n  const clip = mark.clip;\n\n  if (isFunction(clip)) {\n    clip(boundContext(clipBounds.clear()));\n  } else if (clip) {\n    clipBounds.set(0, 0, mark.group.width, mark.group.height);\n  } else return;\n\n  mark.bounds.intersect(clipBounds);\n}\n","import pathParse from '../path/parse';\nimport {isNumber, isObject} from 'vega-util';\n\nconst TOLERANCE = 1e-9;\n\nexport function sceneEqual(a, b, key) {\n  return (a === b) ? true\n    : (key === 'path') ? pathEqual(a, b)\n    : (a instanceof Date && b instanceof Date) ? +a === +b\n    : (isNumber(a) && isNumber(b)) ? Math.abs(a - b) <= TOLERANCE\n    : (!a || !b || !isObject(a) && !isObject(b)) ? a == b\n    : objectEqual(a, b);\n}\n\nexport function pathEqual(a, b) {\n  return sceneEqual(pathParse(a), pathParse(b));\n}\n\nfunction objectEqual(a, b) {\n  var ka = Object.keys(a),\n      kb = Object.keys(b),\n      key, i;\n\n  if (ka.length !== kb.length) return false;\n\n  ka.sort();\n  kb.sort();\n\n  for (i = ka.length - 1; i >= 0; i--) {\n    if (ka[i] != kb[i]) return false;\n  }\n\n  for (i = ka.length - 1; i >= 0; i--) {\n    key = ka[i];\n    if (!sceneEqual(a[key], b[key], key)) return false;\n  }\n\n  return typeof a === typeof b;\n}\n","import {resetSVGGradientId} from './src/Gradient';\nimport {resetSVGClipId} from './src/util/svg/clip';\n\nexport {default as Bounds} from './src/Bounds';\nexport {default as Gradient} from './src/Gradient';\nexport {default as GroupItem} from './src/GroupItem';\nexport {default as ResourceLoader} from './src/ResourceLoader';\nexport {default as Item} from './src/Item';\nexport {default as Scenegraph} from './src/Scenegraph';\n\nexport {default as Handler} from './src/Handler';\nexport {default as Renderer} from './src/Renderer';\nexport {default as CanvasHandler} from './src/CanvasHandler';\nexport {default as CanvasRenderer} from './src/CanvasRenderer';\nexport {default as SVGHandler} from './src/SVGHandler';\nexport {default as SVGRenderer} from './src/SVGRenderer';\nexport {default as SVGStringRenderer} from './src/SVGStringRenderer';\nexport {default as HybridRenderer, setHybridRendererOptions} from './src/HybridRenderer';\nexport {default as HybridHandler} from './src/HybridHandler';\nexport {RenderType, renderModule} from './src/modules';\nexport {intersect} from './src/intersect';\n\nexport {default as Marks} from './src/marks/index';\n\nexport {default as boundClip} from './src/bound/boundClip';\nexport {default as boundContext} from './src/bound/boundContext';\nexport {default as boundStroke} from './src/bound/boundStroke';\nexport {default as boundItem} from './src/bound/boundItem';\nexport {default as boundMark} from './src/bound/boundMark';\n\nexport {default as pathCurves} from './src/path/curves';\nexport {default as pathSymbols} from './src/path/symbols';\nexport {default as pathRectangle} from './src/path/rectangle';\nexport {default as pathTrail} from './src/path/trail';\nexport {default as pathParse} from './src/path/parse';\nexport {default as pathRender} from './src/path/render';\n\nexport {default as point} from './src/util/point';\nexport {domCreate, domFind, domChild, domClear} from './src/util/dom';\nexport {markup, serializeXML} from './src/util/markup';\nexport {\n  font,\n  fontFamily,\n  fontSize,\n  lineHeight,\n  multiLineOffset,\n  textMetrics\n} from './src/util/text';\n\nexport {sceneEqual, pathEqual} from './src/util/equal';\nexport {sceneToJSON, sceneFromJSON} from './src/util/serialize';\nexport {\n  intersectPath,\n  intersectPoint,\n  intersectRule,\n  intersectBoxLine\n} from './src/util/intersect';\nexport {\n  zorder as sceneZOrder,\n  visit as sceneVisit,\n  pickVisit as scenePickVisit\n} from './src/util/visit';\n\n// for testing purposes\nexport {path} from 'd3-path';\n\n// deprecated, remove in next major version\nexport {resetSVGClipId} from './src/util/svg/clip';\n\nexport function resetSVGDefIds() {\n  resetSVGClipId();\n  resetSVGGradientId();\n}\n"],"names":["gradient_id","patternPrefix","isGradient","value","gradient","gradientRef","g","defs","base","type","id","prefix","x1","get","y1","r1","x2","y2","r2","val","def","constant","x","abs","Math","atan2","cos","max","min","sin","sqrt","epsilon","pi","PI","halfPi","tau","asin","tauEpsilon","append","strings","this","_","i","n","length","arguments","Path","constructor","digits","_x0","_y0","_x1","_y1","_append","d","floor","Error","k","round","appendRound","moveTo","y","closePath","lineTo","quadraticCurveTo","bezierCurveTo","arcTo","r","x0","y0","x21","y21","x01","y01","l01_2","x20","y20","l21_2","l20_2","l21","l01","l","tan","acos","t01","t21","arc","a0","a1","ccw","dx","dy","cw","da","rect","w","h","toString","path","withPath","shape","RangeError","arcInnerRadius","innerRadius","arcOuterRadius","outerRadius","arcStartAngle","startAngle","arcEndAngle","endAngle","arcPadAngle","padAngle","cornerTangents","rc","lo","ox","oy","x11","y11","x10","y10","x00","y00","d2","D","cx0","cy0","cx1","cy1","dx0","dy0","dx1","dy1","cx","cy","array","Array","from","Linear","context","_context","curveLinear","p","d3_line","defined","curve","output","line","data","buffer","defined0","lineStart","lineEnd","point","undefined","pointX","pointY","d3_area","area","j","x0z","y0z","areaStart","areaEnd","arealine","lineX0","lineY0","lineY1","lineX1","prototype","_line","NaN","_point","circle","draw","size","noop","that","Basis","BasisClosed","BasisOpen","Bundle","beta","_basis","_beta","_x2","_x3","_x4","_y2","_y3","_y4","_x","_y","t","push","curveBundle","custom","bundle","_k","Cardinal","tension","curveCardinal","cardinal","CardinalClosed","_x5","_y5","curveCardinalClosed","CardinalOpen","curveCardinalOpen","_l01_a","a","_l01_2a","_l12_a","_l12_2a","_l23_a","b","_l23_2a","m","CatmullRom","alpha","_alpha","x23","y23","pow","curveCatmullRom","catmullRom","CatmullRomClosed","curveCatmullRomClosed","CatmullRomOpen","curveCatmullRomOpen","LinearClosed","sign","slope3","h0","h1","s0","s1","slope2","t0","t1","MonotoneX","MonotoneY","ReflectContext","Natural","controlPoints","Step","_t","_t0","Object","create","call","px","py","i0","i1","lookup","basis","linear","monotone","horizontal","vertical","natural","step","curves","orientation","entry","hasOwnProperty","paramCounts","v","z","c","s","q","commandPattern","numberPattern","spacePattern","flagPattern","parse","commands","match","forEach","str","cmd","toLowerCase","paramCount","params","segment","index","pattern","slice","ws","parseParams","trim","count","DegToRad","HalfPi","Tau","HalfSqrt3","segmentCache","bezierCache","join","bezier","key","th0","th1","rx","ry","sin_th","cos_th","a00","a01","a10","a11","cos_th0","sin_th0","cos_th1","sin_th1","th_half","sin_th_h2","x3","y3","temp","scale","current","sX","sY","pathRender","tempX","tempY","tempControlX","tempControlY","previous","controlX","controlY","anchorX","anchorY","beginPath","len","drawArc","coords","seg","large","sweep","rotateX","th","pl","sfactor_sq","sfactor","xc","yc","th_arc","segs","ceil","result","th2","th3","segments","bez","Tan30","builtins","cross","diamond","square","arrow","wedge","o","triangle","stroke","symbols","parsed","pathParse","customSymbol","C","rectangleX","rectangleY","rectangleWidth","width","rectangleHeight","height","number","clamp","vg_rect","crTL","crTR","crBL","crBR","rectangle","tl","tr","bl","br","cornerRadius","vg_trail","ready","w2","ux","uy","ud","hypot","trail","item","arcShape","padRadius","r0","apply","da0","da1","ap","rp","rc0","rc1","p0","p1","oc","x32","y32","intersect","ax","ay","bx","by","kc","lc","centroid","d3_arc","areavShape","areahShape","lineShape","rectShape","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomRight","cornerRadiusBottomLeft","symbolShape","symbol","d3_symbol","trailShape","hasCornerRadius","clip_id","resetSVGClipId","clip$1","renderer","clip","_defs","clipping","isFunction","Bounds","clear","union","Item","mark","bounds","GroupItem","items","clone","Number","MAX_VALUE","empty","equals","set","add","expand","translate","rotate","angle","rotatedPoints","encloses","alignsWith","intersects","contains","inherits","ResourceLoader","customLoader","_pending","_loader","loader","pending","sanitizeURL","uri","increment","sanitize","then","opt","decrement","catch","loadImage","Image","image","url","href","img","cors","crossOrigin","onload","onerror","src","e","complete","Promise","accept","poll","setTimeout","boundStroke","miter","opacity","strokeOpacity","sw","strokeWidth","strokeJoin","miterAdjustment","circleThreshold","lx","ly","rot","ma","mb","mc","md","addL","addX","addY","addp","addpL","boundContext","deg","px1","py1","px2","py2","quadExtrema","px3","py3","cubicExtrema","sa","ea","update","cb","cubic","s2","t2","canvas","getContext","intersectPath","brush","isPointInPath","intersectPoint","box","intersectRect","intersectRule","intersectBoxLine","u","blend","globalCompositeOperation","dflt","addStops","stops","addColorStop","offset","color","spec","createRadialGradient","ictx","fillStyle","createLinearGradient","fillRect","createPattern","fill","fillOpacity","globalAlpha","Empty","lw","strokeStyle","lineWidth","lineCap","strokeCap","lineJoin","miterLimit","strokeMiterLimit","setLineDash","strokeDash","lineDashOffset","strokeDashOffset","compare","zindex","zorder","scene","zdirty","zitems","sort","visit","visitor","pickVisit","hit","drawAll","drawPath","drawOne","pick","test","truthy","gx","gy","hitPath","filled","isArray","isPointInStroke","origin","scaleFactor","xCanvas","yCanvas","pickPath","translateItem","markItemPath","isect","tag","nested","attr","emit","rotateItem","bound","markMultiItemPath","tip","console","log","interp","interpolate","orient","Infinity","clipGroup","group","strokeOffset","emitRectangle","off","rectanglePath","hitBackground","hitForeground","hitCorner","noBound","markTypes","fore","strokeForeground","save","marktype","includes","restore","dw","dh","ix","interactive","pickMark","content","background","foreground","metadata","xmlns","version","getImage","imageWidth","aspect","imageHeight","imageXOffset","align","imageYOffset","baseline","toDataURL","ar0","ar1","imageSmoothingEnabled","smooth","drawImage","xOffset","yOffset","sx","scaleX","sy","scaleY","cache","pathCache","path$2","transformItem","rule","widthCache","lruCache","textMetrics","fontSize","measureWidth","estimateWidth","useCanvas","use","text","_estimateWidth","textValue","currentFontHeight","_measureWidth","font","currentFont","measureText","lineHeight","textLines","lineBreak","split","limit","widthGetter","mid","ellipsis","rtl","dir","hi","truncate","fontFamily","quote","String","replace","fontStyle","fontVariant","fontWeight","textAlign","left","center","right","tempBounds","anchorPoint","radius","theta","mode","reduce","lh","fillText","strokeText","Marks","boundItem","func","marks","DUMMY","boundMark","hasItems","keys","sceneToJSON","indent","JSON","stringify","sceneFromJSON","json","initialize","parent","createMark","name","role","aria","description","domCreate","doc","ns","document","createElement","createElementNS","domFind","el","nodes","childNodes","tagName","domChild","ownerDocument","insertBefore","domClear","curr","removeChild","cssClass","event","getBoundingClientRect","clientX","clientLeft","clientY","top","clientTop","Handler","customTooltip","_active","_handlers","_tooltip","defaultTooltip","obj","_el","_obj","element","firstChild","_origin","_scene","on","_handlerIndex","handler","handlers","eventName","indexOf","handleHref","MouseEvent","setAttribute","dispatchEvent","handleTooltip","show","tooltip","mdef","resolveItem","getItemBoundingClientRect","bottom","Renderer","_bgcolor","resize","bgcolor","_width","_height","_scale","dirty","render","_call","_render","renderAsync","_ready","resolve","_load","method","redraw","DragEnterEvent","DragLeaveEvent","DragOverEvent","PointerDownEvent","PointerMoveEvent","PointerOutEvent","PointerOverEvent","MouseDownEvent","MouseMoveEvent","MouseOutEvent","MouseOverEvent","ClickEvent","MouseWheelEvent","TouchStartEvent","TouchMoveEvent","TouchEndEvent","Events","TooltipShowEvent","TooltipHideEvent","HrefEvent","CanvasHandler","super","_down","_touch","_first","_events","events","pointermove","move","dragover","pointerout","inactive","dragleave","_canvas","eventListenerCheck","DOMMouseScroll","evt","fire","pointerdown","mousedown","click","touchstart","pickEvent","changedTouches","touchmove","touchend","touch","vegaType","splice","ctx","transform","getTransform","pixelRatio","f","eventBundle","addEventListener","fireAll","types","moveEvents","overEvents","outEvents","exit","CanvasRenderer","_options","_redraw","_dirty","_tempb","options","externalContext","appendChild","inDOM","HTMLElement","parentNode","style","setTransform","error","db","vb","viewBounds","clipToBounds","clearRect","SVGHandler","_hrefHandler","listener","_tooltipHandler","svg","_svg","removeEventListener","target","__data__","ARIA_HIDDEN","ARIA_LABEL","ARIA_ROLE","ARIA_ROLEDESCRIPTION","GRAPHICS_OBJECT","GRAPHICS_SYMBOL","roledesc","label","AriaIgnore","toSet","AriaGuides","axis","desc","caption","datum","title","extractTitle","scales","locale","dataflow","isDiscrete","domainCaption","legend","props","toUpperCase","map","peek","channelCaption","titleCaption","AriaEncode","ariaRole","ariaRoleDescription","ariaItemAttributes","hide","prop","ariaMarkAttributes","err","ariaGuide","recurse","some","ariaMark","innerText","markup","buf","outer","inner","stack","open","_len","attrs","_key","close","pop","serializeXML","node","_serialize","hasAttributes","attributes","hasChildNodes","children","child","nodeType","nodeValue","stylesAttr","stylesCss","rootAttributes","svgns","SVGRenderer","_dirtyID","_root","_clearDefs","setAttributeNS","setAttributes","RootIndex","setProperty","viewBox","bg","removeAttribute","_dirtyCheck","_dirtyAll","isDirty","ownerSVGElement","dirtyParents","_update","prev","markType","isGroup","bind","sibling","process","lastChild","previousSibling","idx","values","__values__","extra","mark_extras","setStyle","updateGradient","updateClipping","grad","stop","pt","preserveAspectRatio","fx","fy","fr","mask","cg","fg","siblingCheck","nextSibling","ts","textContent","removeAttributeNS","removeProperty","loc","window","location","hash","SVGStringRenderer","_text","extend","class","attrList","_hrefs","object","prefixed","fn","styleList","display","OPTS","svgMarkTypes","svgOnTop","debug","HybridRenderer","_svgRenderer","_canvasRenderer","_root_el","bottomEl","topEl","position","_svgEl","_canvasEl","pointerEvents","canvasMarkTypes","filter","HybridHandler","Canvas","Hybrid","None","RenderType","PNG","SVG","modules","intersectMark","hits","visitMark","intersectGroup","intersectItem","headless","clipBounds","TOLERANCE","sceneEqual","pathEqual","Date","isNumber","isObject","ka","kb","objectEqual","root","toJSON","markdef"],"mappings":"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","x_google_ignoreList":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,36]}